const _0x3e4cfd=_0x1f18;function _0x1f18(_0x4937f1,_0x37c757){const _0x51e7ac=_0x51e7();return _0x1f18=function(_0x1f1852,_0x1f50ea){_0x1f1852=_0x1f1852-0x18b;let _0x932a28=_0x51e7ac[_0x1f1852];return _0x932a28;},_0x1f18(_0x4937f1,_0x37c757);}function _0x51e7(){const _0x3b36e2=['load','2782048SmgBek','3rcsAVw','getPixelRatio','1TAtPLN','6133780dZAnhD','handleFontsChanged','assign','addEventListener','21516517oPZeUN','3258786VKlsHE','slice','587430StwYFl','disposeInternal','viewState','layerStatesArray','forEachFeatureAtCoordinate','preRender','viewHints','renderFrame','getLayer','declutter','801980oTQbZz','useContainer','vectorRenderer_','getFeatures','center','renderedResolution','12NgIwaz','layerImageRatio_','renderDeferred','renderDeclutter','replayGroupChanged','getState','pixelRatio','renderedPixelToCoordinateTransform_','9UCfFSG','INTERACTING','getDeclutter','coordinateToVectorPixelTransform_','3198776CrWrRJ','14JqlKvJ','prepareFrame','getResolution','dispose','image','resolution','LOADED','extent','ANIMATING','resolve'];_0x51e7=function(){return _0x3b36e2;};return _0x51e7();}(function(_0x3271da,_0x355b0d){const _0x10757a=_0x1f18,_0xf5d3eb=_0x3271da();while(!![]){try{const _0x48a770=parseInt(_0x10757a(0x1a3))/0x1*(-parseInt(_0x10757a(0x1b5))/0x2)+parseInt(_0x10757a(0x1a1))/0x3*(parseInt(_0x10757a(0x194))/0x4)+parseInt(_0x10757a(0x1ab))/0x5+parseInt(_0x10757a(0x1a9))/0x6+-parseInt(_0x10757a(0x195))/0x7*(-parseInt(_0x10757a(0x1a0))/0x8)+parseInt(_0x10757a(0x190))/0x9*(parseInt(_0x10757a(0x1a4))/0xa)+parseInt(_0x10757a(0x1a8))/0xb*(-parseInt(_0x10757a(0x1bb))/0xc);if(_0x48a770===_0x355b0d)break;else _0xf5d3eb['push'](_0xf5d3eb['shift']());}catch(_0xecbebd){_0xf5d3eb['push'](_0xf5d3eb['shift']());}}}(_0x51e7,0x64a04));import _0x18d74f from'./ImageLayer.js';import _0x147364 from'./VectorLayer.js';import _0x2fa7d4 from'../../events/EventType.js';import _0x1f13c5 from'../../ImageCanvas.js';import _0x28c87a from'../../ImageState.js';import _0x536ac2 from'rbush';import _0xdbf5b0 from'../../ViewHint.js';import{apply,compose,create}from'../../transform.js';import{fromResolutionLike}from'../../resolution.js';import{getHeight,getWidth,isEmpty,scaleFromCenter}from'../../extent.js';class CanvasVectorImageLayerRenderer extends _0x18d74f{constructor(_0x44b902){const _0x11e93c=_0x1f18;super(_0x44b902),this[_0x11e93c(0x1b7)]=new _0x147364(_0x44b902),this['layerImageRatio_']=_0x44b902['getImageRatio'](),this['coordinateToVectorPixelTransform_']=create(),this[_0x11e93c(0x18f)]=null;}[_0x3e4cfd(0x1ac)](){const _0x1acdee=_0x3e4cfd;this['vectorRenderer_'][_0x1acdee(0x198)](),super[_0x1acdee(0x1ac)]();}[_0x3e4cfd(0x1b8)](_0x41bf83){const _0x5e2df8=_0x3e4cfd;if(!this[_0x5e2df8(0x1b7)])return Promise[_0x5e2df8(0x19e)]([]);const _0x1a1fd3=apply(this[_0x5e2df8(0x193)],apply(this[_0x5e2df8(0x18f)],_0x41bf83['slice']()));return this['vectorRenderer_'][_0x5e2df8(0x1b8)](_0x1a1fd3);}[_0x3e4cfd(0x1a5)](){this['vectorRenderer_']['handleFontsChanged']();}[_0x3e4cfd(0x196)](_0x22be5e){const _0x22ec37=_0x3e4cfd,_0x23ad19=_0x22be5e[_0x22ec37(0x18e)],_0x22fc69=_0x22be5e[_0x22ec37(0x1ad)],_0x3dfbd6=_0x22fc69[_0x22ec37(0x19a)],_0x370122=_0x22be5e[_0x22ec37(0x1b1)],_0x452f4c=this[_0x22ec37(0x1b7)];let _0x230282=_0x22be5e[_0x22ec37(0x19c)];this[_0x22ec37(0x1bc)]!==0x1&&(_0x230282=_0x230282[_0x22ec37(0x1aa)](0x0),scaleFromCenter(_0x230282,this[_0x22ec37(0x1bc)]));const _0x4bf851=getWidth(_0x230282)/_0x3dfbd6,_0x2377a3=getHeight(_0x230282)/_0x3dfbd6;if(!_0x370122[_0xdbf5b0[_0x22ec37(0x19d)]]&&!_0x370122[_0xdbf5b0[_0x22ec37(0x191)]]&&!isEmpty(_0x230282)){_0x452f4c[_0x22ec37(0x1b6)](null,null);const _0x31c5f0=_0x452f4c['context'],_0x3ad2e9=_0x22be5e[_0x22ec37(0x1ae)][_0x22be5e['layerIndex']],_0x4995c7=Object[_0x22ec37(0x1a6)]({},_0x3ad2e9,{'opacity':0x1}),_0x44cb36=Object[_0x22ec37(0x1a6)]({},_0x22be5e,{'extent':_0x230282,'size':[_0x4bf851,_0x2377a3],'viewState':Object[_0x22ec37(0x1a6)]({},_0x22be5e[_0x22ec37(0x1ad)],{'rotation':0x0}),'layerStatesArray':[_0x4995c7],'layerIndex':0x0,'declutter':null}),_0x52cadd=this[_0x22ec37(0x1b3)]()[_0x22ec37(0x192)]();_0x52cadd&&(_0x44cb36[_0x22ec37(0x1b4)]={[_0x52cadd]:new _0x536ac2(0x9)});let _0x3deab7=!![];const _0x388f3f=new _0x1f13c5(_0x230282,_0x3dfbd6,_0x23ad19,_0x31c5f0['canvas'],function(_0x1377c6){const _0x136b6f=_0x22ec37;_0x452f4c[_0x136b6f(0x196)](_0x44cb36)&&_0x452f4c[_0x136b6f(0x18c)]&&(_0x452f4c['clipping']=![],_0x452f4c[_0x136b6f(0x1b2)](_0x44cb36,null)&&(_0x452f4c['renderDeclutter'](_0x44cb36),_0x452f4c[_0x136b6f(0x1bd)](_0x44cb36),_0x3deab7=![]),_0x1377c6());});_0x388f3f[_0x22ec37(0x1a7)](_0x2fa7d4['CHANGE'],()=>{const _0x1e6ee0=_0x22ec37;if(_0x388f3f[_0x1e6ee0(0x18d)]()!==_0x28c87a[_0x1e6ee0(0x19b)])return;this[_0x1e6ee0(0x199)]=_0x3deab7?null:_0x388f3f;const _0x19891b=_0x388f3f[_0x1e6ee0(0x1a2)](),_0x3e6f6e=fromResolutionLike(_0x388f3f[_0x1e6ee0(0x197)]())*_0x23ad19/_0x19891b;this[_0x1e6ee0(0x1ba)]=_0x3e6f6e,this[_0x1e6ee0(0x193)]=compose(this[_0x1e6ee0(0x193)],_0x4bf851/0x2,_0x2377a3/0x2,0x1/_0x3e6f6e,-0x1/_0x3e6f6e,0x0,-_0x22fc69[_0x1e6ee0(0x1b9)][0x0],-_0x22fc69[_0x1e6ee0(0x1b9)][0x1]);}),_0x388f3f[_0x22ec37(0x19f)]();}return this[_0x22ec37(0x199)]&&(this[_0x22ec37(0x18f)]=_0x22be5e['pixelToCoordinateTransform']['slice']()),!!this['image'];}[_0x3e4cfd(0x1b0)](){}['postRender'](){}[_0x3e4cfd(0x18b)](){}[_0x3e4cfd(0x1af)](_0x2fe822,_0x5addb5,_0x65e008,_0x576334,_0x3f493e){const _0x1a2ad6=_0x3e4cfd;if(this['vectorRenderer_'])return this[_0x1a2ad6(0x1b7)][_0x1a2ad6(0x1af)](_0x2fe822,_0x5addb5,_0x65e008,_0x576334,_0x3f493e);return super[_0x1a2ad6(0x1af)](_0x2fe822,_0x5addb5,_0x65e008,_0x576334,_0x3f493e);}}export default CanvasVectorImageLayerRenderer;