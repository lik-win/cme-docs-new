const _0x10c301=_0xa05b;(function(_0x5aed19,_0x4ab81d){const _0xb5b700=_0xa05b,_0x22ddfc=_0x5aed19();while(!![]){try{const _0x558dad=parseInt(_0xb5b700(0x110))/0x1*(-parseInt(_0xb5b700(0x132))/0x2)+parseInt(_0xb5b700(0x12f))/0x3*(parseInt(_0xb5b700(0x12b))/0x4)+-parseInt(_0xb5b700(0x10b))/0x5+-parseInt(_0xb5b700(0x12a))/0x6+parseInt(_0xb5b700(0x10e))/0x7*(-parseInt(_0xb5b700(0x128))/0x8)+parseInt(_0xb5b700(0x150))/0x9+parseInt(_0xb5b700(0x12d))/0xa;if(_0x558dad===_0x4ab81d)break;else _0x22ddfc['push'](_0x22ddfc['shift']());}catch(_0x21832b){_0x22ddfc['push'](_0x22ddfc['shift']());}}}(_0x1f68,0x9bdfd));import _0x2baa9c from'../../events/EventType.js';import _0x5ba28f from'../../webgl/TileGeometry.js';import _0x3f0eb2 from'../../render/webgl/VectorStyleRenderer.js';import _0x572439 from'../../webgl/Buffer.js';import _0x2efecf,{Uniforms as _0x19f73f}from'./TileLayerBase.js';import _0x42e9dc from'../../webgl/RenderTarget.js';import{AttributeType}from'../../webgl/Helper.js';import{ELEMENT_ARRAY_BUFFER,STATIC_DRAW}from'../../webgl.js';import{ShaderBuilder}from'../../webgl/ShaderBuilder.js';import{create as _0x146b05,fromTransform as _0x591b99}from'../../vec/mat4.js';import{create as _0x6ad8a9,makeInverse as _0x423ecd,multiply as _0x2f48fa,setFromArray as _0x2d8ff3}from'../../transform.js';import{getIntersection}from'../../extent.js';import{parseLiteralStyle}from'../../webgl/styleparser.js';export const Uniforms={..._0x19f73f,'TILE_MASK_TEXTURE':_0x10c301(0x13e),'TILE_ZOOM_LEVEL':_0x10c301(0x142)};export const Attributes={'POSITION':_0x10c301(0x112)};class WebGLVectorTileLayerRenderer extends _0x2efecf{constructor(_0x201a2b,_0x41fae1){const _0x2f41b9=_0x10c301;super(_0x201a2b,{'cacheSize':_0x41fae1[_0x2f41b9(0x11f)],'uniforms':{[Uniforms[_0x2f41b9(0x159)]]:[0x0,0x0],[Uniforms[_0x2f41b9(0x10f)]]:()=>this['tileMaskTarget_'][_0x2f41b9(0x131)]()}}),this[_0x2f41b9(0x139)]=!_0x41fae1[_0x2f41b9(0x146)],this[_0x2f41b9(0x138)]=[],this[_0x2f41b9(0x134)]=[],this[_0x2f41b9(0x10a)]=_0x6ad8a9(),this['tmpTransform_']=_0x6ad8a9(),this[_0x2f41b9(0x12c)]=_0x146b05(),this[_0x2f41b9(0x14a)]=null,this[_0x2f41b9(0x118)]=new _0x572439(ELEMENT_ARRAY_BUFFER,STATIC_DRAW),this['tileMaskIndices_'][_0x2f41b9(0x148)]([0x0,0x1,0x3,0x1,0x2,0x3]),this[_0x2f41b9(0x113)]=[{'name':Attributes['POSITION'],'size':0x2,'type':AttributeType[_0x2f41b9(0x130)]}],this['tileMaskProgram_'],this[_0x2f41b9(0x116)](_0x41fae1);}['reset'](_0x2fdf5c){const _0x842bb=_0x10c301;super[_0x842bb(0x126)](_0x2fdf5c),this['applyOptions_'](_0x2fdf5c),this[_0x842bb(0x129)]&&(this[_0x842bb(0x14d)](),this['initTileMask_']());}['applyOptions_'](_0x18032b){const _0x43e8e3=_0x10c301;this[_0x43e8e3(0x138)]=Array[_0x43e8e3(0x11c)](_0x18032b[_0x43e8e3(0x14c)])?_0x18032b[_0x43e8e3(0x14c)]:[_0x18032b[_0x43e8e3(0x14c)]];}[_0x10c301(0x14d)](){const _0xb568bb=_0x10c301;function _0x37c055(_0x31307a){const _0xb98c47=_0xa05b,_0x3a8f87=_0x31307a[_0xb98c47(0x151)](),_0x32e7d0=_0xb98c47(0x133)+Uniforms[_0xb98c47(0x10f)]+_0xb98c47(0x106)+Uniforms[_0xb98c47(0x11d)]+'\x20+\x200.5';_0x31307a['setFragmentDiscardExpression'](_0x3a8f87!==_0xb98c47(0x140)?'('+_0x3a8f87+_0xb98c47(0x149)+_0x32e7d0+')':_0x32e7d0),_0x31307a[_0xb98c47(0x14b)](_0xb98c47(0x114)+Uniforms[_0xb98c47(0x10f)]),_0x31307a[_0xb98c47(0x14b)](_0xb98c47(0x13d)+Uniforms[_0xb98c47(0x11d)]);}this['styleRenderers_']=this[_0xb568bb(0x138)][_0xb568bb(0x153)](_0x3dc6a1=>{const _0xdbb27=_0xb568bb,_0x31ee05=_0xdbb27(0x111)in _0x3dc6a1;let _0x2c41b8;if(!_0x31ee05){const _0x3e8d0d=parseLiteralStyle(_0x3dc6a1);_0x37c055(_0x3e8d0d[_0xdbb27(0x111)]),_0x2c41b8={'builder':_0x3e8d0d[_0xdbb27(0x111)],'attributes':_0x3e8d0d[_0xdbb27(0x157)],'uniforms':_0x3e8d0d[_0xdbb27(0x152)]};}else _0x37c055(_0x3dc6a1[_0xdbb27(0x111)]),_0x2c41b8=_0x3dc6a1;return new _0x3f0eb2(_0x2c41b8,this['helper'],this['hitDetectionEnabled_']);});}[_0x10c301(0x109)](){const _0x27d7f5=_0x10c301;this[_0x27d7f5(0x14a)]=new _0x42e9dc(this[_0x27d7f5(0x129)]);const _0x1b145b=new ShaderBuilder()[_0x27d7f5(0x147)]('vec4('+Uniforms[_0x27d7f5(0x11d)]+_0x27d7f5(0x127))[_0x27d7f5(0x14b)]('float\x20'+Uniforms['TILE_ZOOM_LEVEL']);this[_0x27d7f5(0x154)]=this['helper'][_0x27d7f5(0x119)](_0x1b145b['getFillFragmentShader'](),_0x1b145b[_0x27d7f5(0x143)]()),this[_0x27d7f5(0x129)][_0x27d7f5(0x158)](this['tileMaskIndices_']);}[_0x10c301(0x10d)](){const _0x577f30=_0x10c301;this[_0x577f30(0x14d)](),this[_0x577f30(0x109)]();}[_0x10c301(0x137)](_0x2e6c5d){const _0xfbd41d=_0x10c301,_0x553b31=new _0x5ba28f(_0x2e6c5d,this[_0xfbd41d(0x134)]),_0x47ef5b=()=>{const _0x16f2d=_0xfbd41d;_0x553b31[_0x16f2d(0x14e)]&&(this[_0x16f2d(0x107)]()[_0x16f2d(0x11a)](),_0x553b31[_0x16f2d(0x13f)](_0x2baa9c[_0x16f2d(0x135)],_0x47ef5b));};return _0x553b31[_0xfbd41d(0x136)](_0x2baa9c[_0xfbd41d(0x135)],_0x47ef5b),_0x553b31;}['beforeTilesRender'](_0x4f3275,_0x2b6691){const _0x477290=_0x10c301;super['beforeTilesRender'](_0x4f3275,!![]),this[_0x477290(0x129)][_0x477290(0x125)](_0x4f3275,this['currentFrameStateTransform_']);}[_0x10c301(0x124)](_0x5efed3){const _0x387130=_0x10c301;this['helper'][_0x387130(0x125)](_0x5efed3,this['currentFrameStateTransform_']);const _0x3c374a=_0x5efed3[_0x387130(0x105)],_0x18b722=_0x5efed3[_0x387130(0x108)];return this[_0x387130(0x14a)][_0x387130(0x115)]([_0x18b722[0x0]*_0x3c374a,_0x18b722[0x1]*_0x3c374a]),this[_0x387130(0x129)]['prepareDrawToRenderTarget'](_0x5efed3,this[_0x387130(0x14a)],!![],!![]),this['helper'][_0x387130(0x12e)](this[_0x387130(0x154)],_0x5efed3),_0x2d8ff3(this[_0x387130(0x13b)],this[_0x387130(0x10a)]),this[_0x387130(0x129)][_0x387130(0x11e)](Uniforms['PROJECTION_MATRIX'],_0x591b99(this[_0x387130(0x12c)],this[_0x387130(0x13b)])),_0x423ecd(this[_0x387130(0x13b)],this[_0x387130(0x10a)]),this[_0x387130(0x129)]['setUniformMatrixValue'](Uniforms[_0x387130(0x156)],_0x591b99(this[_0x387130(0x12c)],this['tmpTransform_'])),!![];}[_0x10c301(0x15a)](_0x3ce2c1,_0x4d94f8,_0x91f524,_0x1368cb){const _0x23fdc2=_0x10c301;if(!_0x3ce2c1['ready'])return;this['helper']['setUniformFloatValue'](Uniforms[_0x23fdc2(0x141)],_0x1368cb),this['helper'][_0x23fdc2(0x10c)](Uniforms[_0x23fdc2(0x11d)],_0x4d94f8),this['helper'][_0x23fdc2(0x120)](Uniforms[_0x23fdc2(0x122)],_0x91f524),this[_0x23fdc2(0x129)][_0x23fdc2(0x10c)](Uniforms['GLOBAL_ALPHA'],0x1),this['helper'][_0x23fdc2(0x11b)](_0x3ce2c1['maskVertices']),this[_0x23fdc2(0x129)][_0x23fdc2(0x11b)](this[_0x23fdc2(0x118)]),this[_0x23fdc2(0x129)]['enableAttributes'](this[_0x23fdc2(0x113)]);const _0x22c53c=this['tileMaskIndices_'][_0x23fdc2(0x13c)]();this['helper']['drawElements'](0x0,_0x22c53c);}[_0x10c301(0x121)](_0x4761a8,_0x5d24f4,_0x60fbb0,_0x2abdda,_0x5e0bd0){const _0x36f9e6=_0x10c301;_0x2d8ff3(this[_0x36f9e6(0x13b)],this[_0x36f9e6(0x10a)]),_0x2f48fa(this[_0x36f9e6(0x13b)],_0x60fbb0),this[_0x36f9e6(0x129)][_0x36f9e6(0x11e)](Uniforms[_0x36f9e6(0x145)],_0x591b99(this[_0x36f9e6(0x12c)],this['tmpTransform_'])),_0x423ecd(this['tmpTransform_'],this[_0x36f9e6(0x10a)]),this['helper']['setUniformMatrixValue'](Uniforms[_0x36f9e6(0x156)],_0x591b99(this[_0x36f9e6(0x12c)],this[_0x36f9e6(0x13b)])),this[_0x36f9e6(0x129)][_0x36f9e6(0x10c)](Uniforms['GLOBAL_ALPHA'],_0x4761a8),this[_0x36f9e6(0x129)]['setUniformFloatValue'](Uniforms[_0x36f9e6(0x141)],_0x5e0bd0),this[_0x36f9e6(0x129)]['setUniformFloatValue'](Uniforms[_0x36f9e6(0x11d)],_0x2abdda),this[_0x36f9e6(0x129)][_0x36f9e6(0x120)](Uniforms[_0x36f9e6(0x122)],_0x5d24f4);}['renderTile'](_0x232ef2,_0x222865,_0x361901,_0x1922eb,_0x39fc1d,_0x2f807b,_0x162af8,_0xec53a3,_0x169377,_0x31ce5f,_0x25b6ad){const _0x2c6deb=_0x10c301,_0x129942=getIntersection(_0xec53a3,_0x1922eb,_0xec53a3),_0x40ddaa=_0x232ef2[_0x2c6deb(0x144)]['getTileCoord']()[0x0];for(let _0x5f0ad1=0x0,_0x505957=this[_0x2c6deb(0x134)]['length'];_0x5f0ad1<_0x505957;_0x5f0ad1++){const _0x149db2=this[_0x2c6deb(0x134)][_0x5f0ad1],_0x20be1f=_0x232ef2[_0x2c6deb(0x14f)][_0x5f0ad1];_0x149db2[_0x2c6deb(0x13a)](_0x20be1f,_0x361901,()=>{const _0x2dd36e=_0x2c6deb;this[_0x2dd36e(0x121)](_0x25b6ad,_0x129942,_0x20be1f[_0x2dd36e(0x155)],_0x40ddaa,_0x169377);});}}[_0x10c301(0x123)](_0x442d4f){}[_0x10c301(0x117)](){const _0x285072=_0x10c301;super[_0x285072(0x117)]();}}function _0xa05b(_0x306b46,_0x167615){const _0x1f682a=_0x1f68();return _0xa05b=function(_0xa05b51,_0x426b4c){_0xa05b51=_0xa05b51-0x105;let _0xb3b67c=_0x1f682a[_0xa05b51];return _0xb3b67c;},_0xa05b(_0x306b46,_0x167615);}function _0x1f68(){const _0x57021a=['float\x20','u_depthMask','removeEventListener','false','DEPTH','u_tileZoomLevel','getFillVertexShader','tile','PROJECTION_MATRIX','disableHitDetection','setFillColorExpression','fromArray',')\x20||\x20(','tileMaskTarget_','addUniform','style','createRenderers_','ready','buffers','4364856olxgud','getFragmentDiscardExpression','uniforms','map','tileMaskProgram_','invertVerticesTransform','SCREEN_TO_WORLD_MATRIX','attributes','flushBufferData','PATTERN_ORIGIN','renderTileMask','pixelRatio',',\x20gl_FragCoord.xy\x20/\x20u_pixelRatio\x20/\x20u_viewportSizePx).r\x20*\x2050.\x20>\x20','getLayer','size','initTileMask_','currentFrameStateTransform_','4048655JbaCVX','setUniformFloatValue','afterHelperCreated','305165TlvLlT','TILE_MASK_TEXTURE','8774QIMkhy','builder','a_position','tileMaskAttributes_','sampler2D\x20','setSize','applyOptions_','disposeInternal','tileMaskIndices_','getProgram','changed','bindBuffer','isArray','TILE_ZOOM_LEVEL','setUniformMatrixValue','cacheSize','setUniformFloatVec4','applyUniforms_','RENDER_EXTENT','renderDeclutter','beforeTilesMaskRender','makeProjectionTransform','reset','\x20/\x2050.,\x200.,\x200.,\x201.)','64pJrKHd','helper','5174550WqLBnt','636LRHlSa','tmpMat4_','33359580KHLeiM','useProgram','267YHgtqC','FLOAT','getTexture','268tBLRZd','texture2D(','styleRenderers_','CHANGE','addEventListener','createTileRepresentation','styles_','hitDetectionEnabled_','render','tmpTransform_','getSize'];_0x1f68=function(){return _0x57021a;};return _0x1f68();}export default WebGLVectorTileLayerRenderer;