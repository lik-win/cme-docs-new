const _0x11bdf1=_0x210c;(function(_0xa030c9,_0x3a386a){const _0x2f4d38=_0x210c,_0x31a8cc=_0xa030c9();while(!![]){try{const _0x9ae9d9=parseInt(_0x2f4d38(0x138))/0x1*(-parseInt(_0x2f4d38(0x107))/0x2)+-parseInt(_0x2f4d38(0x10e))/0x3+parseInt(_0x2f4d38(0x132))/0x4+-parseInt(_0x2f4d38(0x128))/0x5*(-parseInt(_0x2f4d38(0x10d))/0x6)+-parseInt(_0x2f4d38(0x136))/0x7*(-parseInt(_0x2f4d38(0x12d))/0x8)+-parseInt(_0x2f4d38(0x123))/0x9*(parseInt(_0x2f4d38(0x108))/0xa)+-parseInt(_0x2f4d38(0x13f))/0xb*(-parseInt(_0x2f4d38(0x13a))/0xc);if(_0x9ae9d9===_0x3a386a)break;else _0x31a8cc['push'](_0x31a8cc['shift']());}catch(_0x217d44){_0x31a8cc['push'](_0x31a8cc['shift']());}}}(_0x385a,0x81e04));import _0x4ebbe5 from'../../layer/BaseVector.js';function _0x385a(){const _0x57245d=['1029892OAwctX','tmpMat4_','disposeInternal','tmpCoords_','309246VYrxmG','helper','2UGBtQa','getFeatureFromRef','12jNDmRm','clear','size','SCREEN_TO_WORLD_MATRIX','styleRenderers_','8091006NqBcZY','bind','GLOBAL_ALPHA','ADDFEATURE','feature','readPixel','previousExtent_','sourceListenKeys_','layerIndex','makeProjectionTransform','handleSourceFeatureChanged_','currentFrameStateTransform_','style','getSource','applyOptions_','forEach','renderWorlds','prepareFrameInternal','slice','addFeatures','handleSourceFeatureClear_','renderFrame','RENDER_EXTENT','getRevision','setSize','afterHelperCreated','lineStringBuffers','`forEachFeatureAtCoordinate`\x20cannot\x20be\x20used\x20on\x20a\x20WebGL\x20layer\x20if\x20the\x20hit\x20detection\x20logic\x20has\x20been\x20disabled\x20using\x20the\x20`disableHitDetection:\x20true`\x20option.','getCanvas','hitRenderTarget_','length','addInitialFeatures_','applyHitDetectionUniform','map','loadFeatures','tmpTransform_','resolution','applyUniforms_','viewHints','postProcesses','sourceRevision_','buffers_','deleteBuffer','ANIMATING','postRender','setUniformMatrixValue','filter','PATTERN_ORIGIN','all','pointBuffers','648554ljPVxK','191030xXlDAq','prepareDrawToRenderTarget','initialFeaturesAdded_','hitDetectionEnabled_','projection','1086kogUKD','294894rsAclU','clearCachedData','viewState','disposeBuffers','render','polygonBuffers','then','REMOVEFEATURE','opacity','finalizeDraw','generateBuffers','changeFeature','layerStatesArray','floor','getFeatures','invertVerticesTransform','handleSourceFeatureAdded_','setUniformFloatVec2','INTERACTING','styles_','getLayer','378QPpTtt','handleSourceFeatureDelete_','reset','batch_','getRenderBuffer','17855dmrJeO','u_patternOrigin','isArray','createRenderers_','extent','80vHpJQZ','removeFeature','CHANGEFEATURE','ready','forEachFeatureAtCoordinate'];_0x385a=function(){return _0x57245d;};return _0x385a();}import _0x452719 from'../../render/webgl/MixedGeometryBatch.js';import _0x20574c from'../../source/VectorEventType.js';import _0x47a0c3 from'../../render/webgl/VectorStyleRenderer.js';import _0x4674f2 from'../../ViewHint.js';import _0x41ceb6 from'./Layer.js';import _0x463157 from'../../webgl/RenderTarget.js';import{DefaultUniform}from'../../webgl/Helper.js';import{apply as _0x234869,create as _0x21a56e,makeInverse as _0xe9ccb5,multiply as _0x234d78,setFromArray as _0x1ada51,translate as _0x377d84}from'../../transform.js';function _0x210c(_0x39cfae,_0x49afc1){const _0x385a62=_0x385a();return _0x210c=function(_0x210c06,_0xfdf633){_0x210c06=_0x210c06-0xfb;let _0x40c01f=_0x385a62[_0x210c06];return _0x40c01f;},_0x210c(_0x39cfae,_0x49afc1);}import{assert}from'../../asserts.js';import{buffer,createEmpty,equals}from'../../extent.js';import{colorDecodeId}from'../../render/webgl/utils.js';import{create as _0x5929fe,fromTransform as _0xb1441e}from'../../vec/mat4.js';import{getTransformFromProjections,getUserProjection,toUserExtent,toUserResolution}from'../../proj.js';import{getWorldParameters}from'./worldUtil.js';import{listen,unlistenByKey}from'../../events.js';export const Uniforms={...DefaultUniform,'RENDER_EXTENT':'u_renderExtent','PATTERN_ORIGIN':_0x11bdf1(0x129),'GLOBAL_ALPHA':'u_globalAlpha'};class WebGLVectorLayerRenderer extends _0x41ceb6{constructor(_0xc1de78,_0x2753c1){const _0x312dc1=_0x11bdf1,_0x22d65f={[Uniforms[_0x312dc1(0x155)]]:[0x0,0x0,0x0,0x0],[Uniforms['PATTERN_ORIGIN']]:[0x0,0x0],[Uniforms[_0x312dc1(0x141)]]:0x1};super(_0xc1de78,{'uniforms':_0x22d65f,'postProcesses':_0x2753c1[_0x312dc1(0xfc)]}),this['hitDetectionEnabled_']=!_0x2753c1['disableHitDetection'],this[_0x312dc1(0x15c)],this[_0x312dc1(0xfd)]=-0x1,this[_0x312dc1(0x145)]=createEmpty(),this['currentTransform_']=_0x21a56e(),this[_0x312dc1(0x135)]=[0x0,0x0],this[_0x312dc1(0x162)]=_0x21a56e(),this[_0x312dc1(0x133)]=_0x5929fe(),this[_0x312dc1(0x14a)]=_0x21a56e(),this['styles_']=[],this[_0x312dc1(0x13e)]=[],this[_0x312dc1(0xfe)]=[],this[_0x312dc1(0x14d)](_0x2753c1),this[_0x312dc1(0x126)]=new _0x452719(),this['initialFeaturesAdded_']=![],this[_0x312dc1(0x146)]=null;}[_0x11bdf1(0x15e)](_0x41b56c){const _0x2d8ee8=_0x11bdf1,_0x215152=this[_0x2d8ee8(0x122)]()[_0x2d8ee8(0x14c)](),_0x5923d5=getUserProjection();let _0x1c8006;_0x5923d5&&(_0x1c8006=getTransformFromProjections(_0x5923d5,_0x41b56c[_0x2d8ee8(0x110)][_0x2d8ee8(0x10c)])),this['batch_'][_0x2d8ee8(0x152)](_0x215152[_0x2d8ee8(0x11c)](),_0x1c8006),this[_0x2d8ee8(0x146)]=[listen(_0x215152,_0x20574c[_0x2d8ee8(0x142)],this['handleSourceFeatureAdded_'][_0x2d8ee8(0x140)](this,_0x1c8006),this),listen(_0x215152,_0x20574c[_0x2d8ee8(0x12f)],this['handleSourceFeatureChanged_'],this),listen(_0x215152,_0x20574c[_0x2d8ee8(0x115)],this[_0x2d8ee8(0x124)],this),listen(_0x215152,_0x20574c['CLEAR'],this[_0x2d8ee8(0x153)],this)];}['applyOptions_'](_0x5ecb3d){const _0x5130a4=_0x11bdf1;this[_0x5130a4(0x121)]=Array[_0x5130a4(0x12a)](_0x5ecb3d[_0x5130a4(0x14b)])?_0x5ecb3d['style']:[_0x5ecb3d['style']];}[_0x11bdf1(0x12b)](){const _0x140f0c=_0x11bdf1;this[_0x140f0c(0xfe)]=[],this['styleRenderers_']=this[_0x140f0c(0x121)][_0x140f0c(0x160)](_0x47913c=>new _0x47a0c3(_0x47913c,this[_0x140f0c(0x137)],this[_0x140f0c(0x10b)]));}[_0x11bdf1(0x125)](_0x48c42d){const _0x2a5fb4=_0x11bdf1;this[_0x2a5fb4(0x14d)](_0x48c42d),this[_0x2a5fb4(0x137)]&&this[_0x2a5fb4(0x12b)](),super[_0x2a5fb4(0x125)](_0x48c42d);}[_0x11bdf1(0x158)](){const _0x457c91=_0x11bdf1;this[_0x457c91(0x13e)][_0x457c91(0x15d)]?this[_0x457c91(0x13e)]['forEach']((_0x3396e4,_0x50bb35)=>_0x3396e4['setHelper'](this[_0x457c91(0x137)],this[_0x457c91(0xfe)][_0x50bb35])):this[_0x457c91(0x12b)](),this[_0x457c91(0x10b)]&&(this[_0x457c91(0x15c)]=new _0x463157(this[_0x457c91(0x137)]));}[_0x11bdf1(0x11e)](_0x528d95,_0x1ee680){const _0x1b9274=_0x11bdf1,_0x51f5ea=_0x1ee680[_0x1b9274(0x143)];this[_0x1b9274(0x126)]['addFeature'](_0x51f5ea,_0x528d95);}[_0x11bdf1(0x149)](_0x31f490){const _0x1aa0c5=_0x11bdf1,_0x56958f=_0x31f490['feature'];this[_0x1aa0c5(0x126)][_0x1aa0c5(0x119)](_0x56958f);}[_0x11bdf1(0x124)](_0x4ca1a2){const _0x14b480=_0x11bdf1,_0x195e9c=_0x4ca1a2[_0x14b480(0x143)];this[_0x14b480(0x126)][_0x14b480(0x12e)](_0x195e9c);}['handleSourceFeatureClear_'](){const _0x812aea=_0x11bdf1;this[_0x812aea(0x126)][_0x812aea(0x13b)]();}[_0x11bdf1(0x164)](_0x2b4110){const _0x50786a=_0x11bdf1;_0x1ada51(this[_0x50786a(0x162)],this[_0x50786a(0x14a)]),_0x234d78(this['tmpTransform_'],_0x2b4110),this[_0x50786a(0x137)]['setUniformMatrixValue'](Uniforms['PROJECTION_MATRIX'],_0xb1441e(this['tmpMat4_'],this[_0x50786a(0x162)])),_0xe9ccb5(this['tmpTransform_'],this[_0x50786a(0x162)]),this['helper'][_0x50786a(0x102)](Uniforms[_0x50786a(0x13d)],_0xb1441e(this[_0x50786a(0x133)],this[_0x50786a(0x162)])),this[_0x50786a(0x135)][0x0]=0x0,this['tmpCoords_'][0x1]=0x0,_0xe9ccb5(this['tmpTransform_'],_0x2b4110),_0x234869(this[_0x50786a(0x162)],this[_0x50786a(0x135)]),this[_0x50786a(0x137)][_0x50786a(0x11f)](Uniforms[_0x50786a(0x104)],this[_0x50786a(0x135)]);}[_0x11bdf1(0x154)](_0x4ba69e){const _0x9709da=_0x11bdf1,_0x538c5c=this[_0x9709da(0x137)]['getGL']();this['preRender'](_0x538c5c,_0x4ba69e);const [_0x487c3e,_0x237cdb,_0x19e1f9]=getWorldParameters(_0x4ba69e,this[_0x9709da(0x122)]());this['helper']['prepareDraw'](_0x4ba69e),this[_0x9709da(0x14f)](_0x4ba69e,![],_0x487c3e,_0x237cdb,_0x19e1f9),this['helper'][_0x9709da(0x117)](_0x4ba69e);const _0x56f739=this['helper'][_0x9709da(0x15b)](),_0x1891bf=_0x4ba69e[_0x9709da(0x11a)][_0x4ba69e[_0x9709da(0x147)]],_0x44ed3f=_0x1891bf[_0x9709da(0x116)];return _0x44ed3f!==parseFloat(_0x56f739['style'][_0x9709da(0x116)])&&(_0x56f739['style'][_0x9709da(0x116)]=String(_0x44ed3f)),this[_0x9709da(0x10b)]&&(this[_0x9709da(0x14f)](_0x4ba69e,!![],_0x487c3e,_0x237cdb,_0x19e1f9),this['hitRenderTarget_'][_0x9709da(0x10f)]()),this[_0x9709da(0x101)](_0x538c5c,_0x4ba69e),_0x56f739;}[_0x11bdf1(0x150)](_0x421889){const _0x577835=_0x11bdf1;!this['initialFeaturesAdded_']&&(this[_0x577835(0x15e)](_0x421889),this[_0x577835(0x10a)]=!![]);const _0x3d5375=this[_0x577835(0x122)](),_0x198c7e=_0x3d5375[_0x577835(0x14c)](),_0x3dd51a=_0x421889[_0x577835(0x110)],_0x23a031=!_0x421889[_0x577835(0xfb)][_0x4674f2[_0x577835(0x100)]]&&!_0x421889['viewHints'][_0x4674f2[_0x577835(0x120)]],_0x11babb=!equals(this['previousExtent_'],_0x421889['extent']),_0x36a937=this[_0x577835(0xfd)]<_0x198c7e['getRevision']();_0x36a937&&(this[_0x577835(0xfd)]=_0x198c7e[_0x577835(0x156)]());if(_0x23a031&&(_0x11babb||_0x36a937)){const _0x1ea7d0=_0x3dd51a[_0x577835(0x10c)],_0x3da639=_0x3dd51a[_0x577835(0x163)],_0x5e2195=_0x3d5375 instanceof _0x4ebbe5?_0x3d5375[_0x577835(0x127)]():0x0,_0x38cce6=buffer(_0x421889[_0x577835(0x12c)],_0x5e2195*_0x3da639),_0x221264=getUserProjection();_0x221264?_0x198c7e[_0x577835(0x161)](toUserExtent(_0x38cce6,_0x221264),toUserResolution(_0x3da639,_0x1ea7d0),_0x221264):_0x198c7e[_0x577835(0x161)](_0x38cce6,_0x3da639,_0x1ea7d0);this[_0x577835(0x130)]=![];const _0x3797da=this[_0x577835(0x137)][_0x577835(0x148)](_0x421889,_0x21a56e()),_0xb4c89a=this[_0x577835(0x13e)][_0x577835(0x160)]((_0x2081a0,_0x21863d)=>_0x2081a0[_0x577835(0x118)](this[_0x577835(0x126)],_0x3797da)[_0x577835(0x114)](_0x24de30=>{const _0x395c88=_0x577835;this[_0x395c88(0xfe)][_0x21863d]&&this[_0x395c88(0x111)](this['buffers_'][_0x21863d]),this[_0x395c88(0xfe)][_0x21863d]=_0x24de30;}));Promise[_0x577835(0x105)](_0xb4c89a)[_0x577835(0x114)](()=>{const _0x2b008a=_0x577835;this[_0x2b008a(0x130)]=!![],this[_0x2b008a(0x122)]()['changed']();}),this[_0x577835(0x145)]=_0x421889[_0x577835(0x12c)][_0x577835(0x151)]();}return!![];}[_0x11bdf1(0x14f)](_0x464cb3,_0x3781a5,_0x4d6fdd,_0x392115,_0x30454e){const _0x48213d=_0x11bdf1;let _0x2ebf1b=_0x4d6fdd;_0x3781a5&&(this[_0x48213d(0x15c)][_0x48213d(0x157)]([Math[_0x48213d(0x11b)](_0x464cb3[_0x48213d(0x13c)][0x0]/0x2),Math[_0x48213d(0x11b)](_0x464cb3[_0x48213d(0x13c)][0x1]/0x2)]),this['helper'][_0x48213d(0x109)](_0x464cb3,this['hitRenderTarget_'],!![]));do{this[_0x48213d(0x137)][_0x48213d(0x148)](_0x464cb3,this[_0x48213d(0x14a)]),_0x377d84(this[_0x48213d(0x14a)],_0x2ebf1b*_0x30454e,0x0);for(let _0x11e393=0x0,_0xcb21bf=this[_0x48213d(0x13e)]['length'];_0x11e393<_0xcb21bf;_0x11e393++){const _0x328404=this[_0x48213d(0x13e)][_0x11e393],_0x2b7a56=this['buffers_'][_0x11e393];if(!_0x2b7a56)continue;_0x328404[_0x48213d(0x112)](_0x2b7a56,_0x464cb3,()=>{const _0x4ee3b3=_0x48213d;this[_0x4ee3b3(0x164)](_0x2b7a56[_0x4ee3b3(0x11d)]),this[_0x4ee3b3(0x137)][_0x4ee3b3(0x15f)](_0x3781a5);});}}while(++_0x2ebf1b<_0x392115);}[_0x11bdf1(0x131)](_0x4bd5a4,_0x3534a2,_0x42d402,_0x3b8638,_0x355cc4){const _0x323a44=_0x11bdf1;assert(this[_0x323a44(0x10b)],_0x323a44(0x15a));if(!this[_0x323a44(0x13e)][_0x323a44(0x15d)]||!this[_0x323a44(0x10b)])return undefined;const _0x3581c2=_0x234869(_0x3534a2['coordinateToPixelTransform'],_0x4bd5a4[_0x323a44(0x151)]()),_0x276edc=this[_0x323a44(0x15c)][_0x323a44(0x144)](_0x3581c2[0x0]/0x2,_0x3581c2[0x1]/0x2),_0x11cbd0=[_0x276edc[0x0]/0xff,_0x276edc[0x1]/0xff,_0x276edc[0x2]/0xff,_0x276edc[0x3]/0xff],_0x1309c7=colorDecodeId(_0x11cbd0),_0x141848=this[_0x323a44(0x126)][_0x323a44(0x139)](_0x1309c7);if(_0x141848)return _0x3b8638(_0x141848,this[_0x323a44(0x122)](),null);return undefined;}[_0x11bdf1(0x111)](_0x584812){const _0x11d0dd=_0x11bdf1;_0x584812[_0x11d0dd(0x106)]&&_0x584812[_0x11d0dd(0x106)][_0x11d0dd(0x103)](Boolean)[_0x11d0dd(0x14e)](_0x12000d=>this[_0x11d0dd(0x137)]['deleteBuffer'](_0x12000d)),_0x584812[_0x11d0dd(0x159)]&&_0x584812[_0x11d0dd(0x159)]['filter'](Boolean)[_0x11d0dd(0x14e)](_0x3d1821=>this['helper'][_0x11d0dd(0xff)](_0x3d1821)),_0x584812[_0x11d0dd(0x113)]&&_0x584812[_0x11d0dd(0x113)][_0x11d0dd(0x103)](Boolean)['forEach'](_0x207222=>this['helper']['deleteBuffer'](_0x207222));}[_0x11bdf1(0x134)](){const _0x3de8c3=_0x11bdf1;this[_0x3de8c3(0xfe)][_0x3de8c3(0x14e)](_0xe72ad0=>{const _0x44fd9a=_0x3de8c3;this[_0x44fd9a(0x111)](_0xe72ad0);}),this[_0x3de8c3(0x146)]&&(this[_0x3de8c3(0x146)][_0x3de8c3(0x14e)](function(_0x3d6805){unlistenByKey(_0x3d6805);}),this['sourceListenKeys_']=null),super[_0x3de8c3(0x134)]();}}export default WebGLVectorLayerRenderer;