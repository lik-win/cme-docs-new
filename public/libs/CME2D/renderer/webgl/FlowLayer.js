const _0x3414d3=_0x35af;(function(_0x411d70,_0x3ba7ae){const _0x3dfe19=_0x35af,_0x4220ed=_0x411d70();while(!![]){try{const _0x297fbd=parseInt(_0x3dfe19(0x23d))/0x1+-parseInt(_0x3dfe19(0x211))/0x2*(parseInt(_0x3dfe19(0x206))/0x3)+parseInt(_0x3dfe19(0x1f9))/0x4*(parseInt(_0x3dfe19(0x222))/0x5)+-parseInt(_0x3dfe19(0x1e7))/0x6*(parseInt(_0x3dfe19(0x24a))/0x7)+parseInt(_0x3dfe19(0x237))/0x8+-parseInt(_0x3dfe19(0x234))/0x9+parseInt(_0x3dfe19(0x22b))/0xa*(-parseInt(_0x3dfe19(0x1e5))/0xb);if(_0x297fbd===_0x3ba7ae)break;else _0x4220ed['push'](_0x4220ed['shift']());}catch(_0xc7d571){_0x4220ed['push'](_0x4220ed['shift']());}}}(_0x2088,0x5554c));import _0x55c275 from'../../webgl/Buffer.js';import _0x4c5c94 from'./TileLayer.js';import{ARRAY_BUFFER,STATIC_DRAW}from'../../webgl.js';function _0x35af(_0x397fdd,_0x17700c){const _0x20889d=_0x2088();return _0x35af=function(_0x35af28,_0x57ca9f){_0x35af28=_0x35af28-0x1e1;let _0x44a3a3=_0x20889d[_0x35af28];return _0x44a3a3;},_0x35af(_0x397fdd,_0x17700c);}import{DefaultUniform}from'../../webgl/Helper.js';function _0x2088(){const _0x3dc517=['24GdcMFZ','previousPositionTexture_','u_particleCountSqrt','useProgram','renderedHeight_','u_opacity','bindInitialFrameBuffer','DROP_RATE_BUMP','ROTATION','bindAttribute','enable','122960lbxDzT','textureFragmentShader','PARTICLE_COUNT_SQRT','dropRate_','particleColorVertexShader_','particleColorFragmentShader_','fadeOpacity_','dropRateBump_','floor','sin','speedFactor','setUniformFloatVec2','drawParticleColor_','a_index','deleteTexture','viewState','particleCountSqrt_','85NQVIYn','velocityTexture_','getProgram','viewport','POSITION_TEXTURE','particleIndexBuffer_','POINTS','u_isFloat','textureFragmentShader_','4312930SYVweU','framebuffer_','animate','renderedWidth_','cacheSize','POSITION','getCanvas','particleColorFragmentShader','u_speedFactor','411156QdpHhq','u_offset','TEXTURE','3957232nBcuQJ','u_velocityTexture','MAX_SPEED','flushBufferData','SRC_ALPHA','particleColorProgram_','633265LoVvUB','rotation','u_dropRate','previousTrailsTexture_','BLEND','particlePositionFragmentShader_','updateParticlePositions_','particlePositionProgram_','getGL','setUniformFloatValue','TRIANGLES','afterHelperCreated','speedFactor_','296198dATurd','beforeFinalize','drawTexture_','u_maxSpeed','ONE_MINUS_SRC_ALPHA','tempVec2_','maxSpeed_','maxSpeed','createSizeDependentTextures_','length','disable','textureVertexShader_','u_dropRateBump','v_position','a_position','bindTexture','size','tileVertexShader','ceil','quadBuffer_','particleColorVertexShader','11GbzZEa','VELOCITY_TEXTURE','18hmaavH','clear','cos','drawParticleTrails_','OPACITY','particlePositionFragmentShader','VIEWPORT_SIZE_PX','nextTrailsTexture_','drawArrays','height','tileFragmentShader','createFramebuffer','RANDOM_SEED','INDEX','helper','particlePositionVertexShader_','blendFunc','COLOR_BUFFER_BIT','74672dyTwcq','TEXTURE_2D','u_randomSeed','createTexture','RGBA','SPEED_FACTOR','setArray','textureProgram_','textureVertexShader','particlePositionVertexShader','nextPositionTexture_','width','sqrt'];_0x2088=function(){return _0x3dc517;};return _0x2088();}export const U={'TEXTURE':'u_texture','VELOCITY_TEXTURE':_0x3414d3(0x238),'POSITION_TEXTURE':'u_positionTexture','PARTICLE_COUNT_SQRT':_0x3414d3(0x208),'MAX_SPEED':_0x3414d3(0x24d),'GAIN':'u_gain','OFFSET':_0x3414d3(0x235),'IS_FLOAT':_0x3414d3(0x229),'RANDOM_SEED':_0x3414d3(0x1fb),'SPEED_FACTOR':_0x3414d3(0x233),'DROP_RATE':_0x3414d3(0x23f),'DROP_RATE_BUMP':_0x3414d3(0x256),'OPACITY':_0x3414d3(0x20b),'ROTATION':DefaultUniform[_0x3414d3(0x20e)],'VIEWPORT_SIZE_PX':DefaultUniform[_0x3414d3(0x1ed)]};export const A={'POSITION':_0x3414d3(0x258),'INDEX':_0x3414d3(0x21e)};export const V={'POSITION':_0x3414d3(0x257)};class FlowLayerRenderer extends _0x4c5c94{constructor(_0x1de392,_0x3ac466){const _0x375183=_0x3414d3;super(_0x1de392,{'vertexShader':_0x3ac466[_0x375183(0x1e1)],'fragmentShader':_0x3ac466[_0x375183(0x1f1)],'cacheSize':_0x3ac466[_0x375183(0x22f)],'postProcesses':[{}],'uniforms':{[U['MAX_SPEED']]:_0x3ac466[_0x375183(0x251)]}}),this[_0x375183(0x216)]=_0x3ac466[_0x375183(0x232)],this[_0x375183(0x223)]=null,this['particleCountSqrt_']=_0x3ac466['particles']?Math[_0x375183(0x1e2)](Math[_0x375183(0x205)](_0x3ac466['particles'])):0x100,this[_0x375183(0x227)],this[_0x375183(0x1e3)],this[_0x375183(0x244)],this[_0x375183(0x1f6)]=_0x3ac466[_0x375183(0x202)],this[_0x375183(0x242)]=_0x3ac466[_0x375183(0x1ec)],this['previousPositionTexture_'],this[_0x375183(0x203)],this[_0x375183(0x23c)],this[_0x375183(0x215)]=_0x3ac466[_0x375183(0x1e4)],this[_0x375183(0x216)]=_0x3ac466[_0x375183(0x232)],this[_0x375183(0x200)],this['textureVertexShader_']=_0x3ac466[_0x375183(0x201)],this[_0x375183(0x22a)]=_0x3ac466[_0x375183(0x212)],this['previousTrailsTexture_'],this[_0x375183(0x1ee)],this[_0x375183(0x217)]=0.996,this[_0x375183(0x250)]=_0x3ac466[_0x375183(0x251)],this[_0x375183(0x249)]=_0x3ac466[_0x375183(0x21b)]||0.001,this[_0x375183(0x214)]=0.003,this[_0x375183(0x218)]=0.01,this['tempVec2_']=[0x0,0x0],this[_0x375183(0x22e)]=0x0,this['renderedHeight_']=0x0;}['afterHelperCreated'](){const _0x30f93f=_0x3414d3;super[_0x30f93f(0x248)]();const _0x551018=this[_0x30f93f(0x1f5)],_0x8d9de1=_0x551018[_0x30f93f(0x245)]();this['framebuffer_']=_0x8d9de1[_0x30f93f(0x1f2)]();const _0x3b7a8e=this[_0x30f93f(0x221)]*this[_0x30f93f(0x221)],_0x436d6d=new Float32Array(_0x3b7a8e);for(let _0x55eca1=0x0;_0x55eca1<_0x3b7a8e;++_0x55eca1){_0x436d6d[_0x55eca1]=_0x55eca1;}const _0x523d8=new _0x55c275(ARRAY_BUFFER,STATIC_DRAW);_0x523d8['setArray'](_0x436d6d),_0x551018[_0x30f93f(0x23a)](_0x523d8),this[_0x30f93f(0x227)]=_0x523d8;const _0x31c058=new Float32Array([0x0,0x0,0x1,0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1,0x1]),_0x344c2c=new _0x55c275(ARRAY_BUFFER,STATIC_DRAW);_0x344c2c[_0x30f93f(0x1ff)](_0x31c058),_0x551018[_0x30f93f(0x23a)](_0x344c2c),this[_0x30f93f(0x1e3)]=_0x344c2c;const _0x3a1144=new Uint8Array(_0x3b7a8e*0x4);for(let _0x32523c=0x0;_0x32523c<_0x3a1144[_0x30f93f(0x253)];++_0x32523c){_0x3a1144[_0x32523c]=Math[_0x30f93f(0x219)](Math['random']()*0x100);}this[_0x30f93f(0x207)]=_0x551018[_0x30f93f(0x1fc)]([this[_0x30f93f(0x221)],this[_0x30f93f(0x221)]],_0x3a1144,null,!![]),this[_0x30f93f(0x203)]=_0x551018['createTexture']([this[_0x30f93f(0x221)],this['particleCountSqrt_']],_0x3a1144,null,!![]),this[_0x30f93f(0x244)]=_0x551018['getProgram'](this['particlePositionFragmentShader_'],this['particlePositionVertexShader_']),this[_0x30f93f(0x23c)]=_0x551018[_0x30f93f(0x224)](this[_0x30f93f(0x216)],this[_0x30f93f(0x215)]),this['textureProgram_']=_0x551018['getProgram'](this['textureFragmentShader_'],this[_0x30f93f(0x255)]);}['createSizeDependentTextures_'](){const _0x457853=_0x3414d3,_0x41c1ac=this[_0x457853(0x1f5)],_0x31210e=_0x41c1ac[_0x457853(0x245)](),_0x11322c=_0x41c1ac[_0x457853(0x231)](),_0x3f9494=_0x11322c[_0x457853(0x204)],_0x5df128=_0x11322c[_0x457853(0x1f0)],_0x7b6bdf=new Uint8Array(_0x3f9494*_0x5df128*0x4);this[_0x457853(0x1ee)]&&_0x31210e[_0x457853(0x21f)](this[_0x457853(0x1ee)]),this[_0x457853(0x1ee)]=_0x41c1ac[_0x457853(0x1fc)]([_0x3f9494,_0x5df128],_0x7b6bdf,null,!![]),this[_0x457853(0x240)]&&_0x31210e['deleteTexture'](this['previousTrailsTexture_']),this['previousTrailsTexture_']=_0x41c1ac['createTexture']([_0x3f9494,_0x5df128],_0x7b6bdf,null,!![]);}[_0x3414d3(0x24b)](_0x3ca08d){const _0x27b197=_0x3414d3,_0x443df7=this[_0x27b197(0x1f5)],_0x1d5638=_0x443df7[_0x27b197(0x245)](),_0x9506e3=_0x443df7[_0x27b197(0x231)](),_0x40f218=_0x9506e3[_0x27b197(0x204)],_0x483880=_0x9506e3[_0x27b197(0x1f0)];(this[_0x27b197(0x22e)]!=_0x40f218||this[_0x27b197(0x20a)]!=_0x483880)&&this[_0x27b197(0x252)]();const _0xd078a4=[_0x40f218,_0x483880];this['velocityTexture_']=_0x443df7[_0x27b197(0x1fc)](_0xd078a4,null,this[_0x27b197(0x223)]),_0x1d5638['copyTexImage2D'](_0x1d5638[_0x27b197(0x1fa)],0x0,_0x1d5638[_0x27b197(0x1fd)],0x0,0x0,_0x40f218,_0x483880,0x0),this[_0x27b197(0x1ea)](_0x3ca08d),this[_0x27b197(0x243)](_0x3ca08d),_0x3ca08d[_0x27b197(0x22d)]=!![],this['renderedWidth_']=_0x40f218,this[_0x27b197(0x20a)]=_0x483880;}[_0x3414d3(0x1ea)](_0x483838){const _0x5c411f=_0x3414d3,_0x5c98e1=this['helper'],_0x3bf578=_0x5c98e1[_0x5c411f(0x245)]();_0x5c98e1['bindFrameBuffer'](this[_0x5c411f(0x22c)],this[_0x5c411f(0x1ee)]),this[_0x5c411f(0x24c)](this[_0x5c411f(0x240)],this[_0x5c411f(0x217)]),this[_0x5c411f(0x21d)](_0x483838),_0x5c98e1[_0x5c411f(0x20c)](),_0x3bf578['clearColor'](0x0,0x0,0x0,0x0),_0x3bf578[_0x5c411f(0x1e8)](_0x3bf578[_0x5c411f(0x1f8)]),_0x3bf578[_0x5c411f(0x210)](_0x3bf578[_0x5c411f(0x241)]),_0x3bf578[_0x5c411f(0x1f7)](_0x3bf578[_0x5c411f(0x23b)],_0x3bf578[_0x5c411f(0x24e)]),this[_0x5c411f(0x24c)](this[_0x5c411f(0x1ee)],0x1),_0x3bf578[_0x5c411f(0x254)](_0x3bf578['BLEND']);const _0x7d540=this[_0x5c411f(0x1ee)];this['nextTrailsTexture_']=this[_0x5c411f(0x240)],this[_0x5c411f(0x240)]=_0x7d540;}[_0x3414d3(0x24c)](_0x590057,_0x1e44c1){const _0x2c1ed6=_0x3414d3,_0x5c2c48=this[_0x2c1ed6(0x1f5)],_0x3c7cda=_0x5c2c48[_0x2c1ed6(0x245)]();_0x5c2c48['useProgram'](this[_0x2c1ed6(0x200)]),_0x5c2c48[_0x2c1ed6(0x259)](_0x590057,0x0,U[_0x2c1ed6(0x236)]),_0x5c2c48[_0x2c1ed6(0x20f)](this[_0x2c1ed6(0x1e3)],A[_0x2c1ed6(0x230)],0x2),this[_0x2c1ed6(0x1f5)][_0x2c1ed6(0x246)](U[_0x2c1ed6(0x1eb)],_0x1e44c1),_0x3c7cda['drawArrays'](_0x3c7cda[_0x2c1ed6(0x247)],0x0,0x6);}[_0x3414d3(0x21d)](_0x3af7df){const _0xa70705=_0x3414d3,_0x22fd8e=this['helper'],_0x440e4b=_0x22fd8e['getGL']();_0x22fd8e[_0xa70705(0x209)](this[_0xa70705(0x23c)]);const _0x1cf74d=this[_0xa70705(0x221)]*this['particleCountSqrt_'];_0x22fd8e['bindAttribute'](this['particleIndexBuffer_'],A[_0xa70705(0x1f4)],0x1),_0x22fd8e[_0xa70705(0x259)](this[_0xa70705(0x207)],0x0,U[_0xa70705(0x226)]),_0x22fd8e['bindTexture'](this[_0xa70705(0x223)],0x1,U[_0xa70705(0x1e6)]),this['helper'][_0xa70705(0x246)](U[_0xa70705(0x213)],this['particleCountSqrt_']);const _0x59e487=this[_0xa70705(0x24f)];_0x59e487[0x0]=Math[_0xa70705(0x1e9)](_0x3af7df[_0xa70705(0x220)]['rotation']),_0x59e487[0x1]=Math[_0xa70705(0x21a)](_0x3af7df[_0xa70705(0x220)][_0xa70705(0x23e)]),this['helper']['setUniformFloatVec2'](U[_0xa70705(0x20e)],_0x59e487),this[_0xa70705(0x1f5)][_0xa70705(0x246)](U[_0xa70705(0x239)],this['maxSpeed_']),_0x440e4b[_0xa70705(0x1ef)](_0x440e4b[_0xa70705(0x228)],0x0,_0x1cf74d);}[_0x3414d3(0x243)](_0x14bc81){const _0x234e2b=_0x3414d3,_0x4cd0d2=this[_0x234e2b(0x1f5)],_0x54acbb=_0x4cd0d2['getGL']();_0x4cd0d2[_0x234e2b(0x209)](this[_0x234e2b(0x244)]),_0x54acbb[_0x234e2b(0x225)](0x0,0x0,this[_0x234e2b(0x221)],this[_0x234e2b(0x221)]),_0x4cd0d2['bindFrameBuffer'](this[_0x234e2b(0x22c)],this[_0x234e2b(0x203)]),_0x4cd0d2['bindTexture'](this[_0x234e2b(0x207)],0x0,U[_0x234e2b(0x226)]),_0x4cd0d2['bindTexture'](this['velocityTexture_'],0x1,U[_0x234e2b(0x1e6)]),_0x4cd0d2[_0x234e2b(0x20f)](this[_0x234e2b(0x1e3)],A[_0x234e2b(0x230)],0x2),_0x4cd0d2[_0x234e2b(0x246)](U[_0x234e2b(0x1f3)],Math['random']()),_0x4cd0d2[_0x234e2b(0x246)](U[_0x234e2b(0x1fe)],this[_0x234e2b(0x249)]),_0x4cd0d2['setUniformFloatValue'](U['DROP_RATE'],this[_0x234e2b(0x214)]),_0x4cd0d2[_0x234e2b(0x246)](U[_0x234e2b(0x20d)],this[_0x234e2b(0x218)]);const _0x195c51=this[_0x234e2b(0x24f)];_0x195c51[0x0]=Math[_0x234e2b(0x1e9)](_0x14bc81[_0x234e2b(0x220)][_0x234e2b(0x23e)]),_0x195c51[0x1]=Math[_0x234e2b(0x21a)](_0x14bc81[_0x234e2b(0x220)][_0x234e2b(0x23e)]),this[_0x234e2b(0x1f5)][_0x234e2b(0x21c)](U[_0x234e2b(0x20e)],_0x195c51);const _0x4c48a1=_0x14bc81[_0x234e2b(0x25a)];this[_0x234e2b(0x1f5)][_0x234e2b(0x21c)](U['VIEWPORT_SIZE_PX'],[_0x4c48a1[0x0],_0x4c48a1[0x1]]),_0x54acbb['drawArrays'](_0x54acbb[_0x234e2b(0x247)],0x0,0x6);const _0x11ba60=this[_0x234e2b(0x203)];this[_0x234e2b(0x203)]=this[_0x234e2b(0x207)],this[_0x234e2b(0x207)]=_0x11ba60;}}export default FlowLayerRenderer;