const _0x3cd027=_0x3586;(function(_0x501f47,_0x15468a){const _0x37c8a9=_0x3586,_0x433240=_0x501f47();while(!![]){try{const _0xc8cb5a=parseInt(_0x37c8a9(0x1ee))/0x1+-parseInt(_0x37c8a9(0x1a2))/0x2*(parseInt(_0x37c8a9(0x1b9))/0x3)+parseInt(_0x37c8a9(0x1ac))/0x4+parseInt(_0x37c8a9(0x1d8))/0x5*(parseInt(_0x37c8a9(0x1e4))/0x6)+-parseInt(_0x37c8a9(0x1cb))/0x7*(parseInt(_0x37c8a9(0x1a9))/0x8)+-parseInt(_0x37c8a9(0x1c8))/0x9*(parseInt(_0x37c8a9(0x19b))/0xa)+parseInt(_0x37c8a9(0x1e6))/0xb;if(_0xc8cb5a===_0x15468a)break;else _0x433240['push'](_0x433240['shift']());}catch(_0x2270f3){_0x433240['push'](_0x433240['shift']());}}}(_0x2054,0x52eec));import _0x20076f from'../../webgl/Buffer.js';import{ARRAY_BUFFER,DYNAMIC_DRAW,ELEMENT_ARRAY_BUFFER}from'../../webgl.js';import{AttributeType}from'../../webgl/Helper.js';import{WebGLWorkerMessageType}from'./constants.js';function _0x2054(){const _0x4fefc5=['fillVertexShader_','475392QdfoTI','hasStroke_','bindBuffer','postMessage','symbolVertexShader_','indexBuffer','a_position','fillFragmentShader_','getFillVertexShader','SEGMENT_START','strokeProgram_','assign','GENERATE_POLYGON_BUFFERS','103491FNQrPr','useProgram','pointBuffers','getSize','MEASURE_END','builder','a_segmentStart','hasFill_','entries','polygonAttributesDesc_','setHelper','uniforms','a_measureStart','fromArrayBuffer','render','9eRPsak','all','fillProgram_','340235Urgjvu','pointInstructions','GENERATE_LINE_STRING_BUFFERS','lineStringBuffers','vertexBuffer','uniforms_','attributes','JOIN_ANGLES','helper_','hitDetectionEnabled_','LineString','addEventListener','a_parameters','1088970JfHusZ','GENERATE_POINT_BUFFERS','polygonBuffers','POSITION','polygonInstructions','Polygon','customAttributes_','polygonBatch','MEASURE_START','addUniforms','SEGMENT_END','symbolFragmentShader_','12AYBlYK','generateRenderInstructions_','7718986aFcIsm','pointAttributesDesc_','getStrokeFragmentShader','renderInternal_','a_joinAngles','buffer','getFillFragmentShader','getGL','62837PZgKlB','flushBufferData','enableAttributes','message','getProgram','FLOAT','getSymbolFragmentShader','lineStringInstructions','generateBuffersForType_','Point','1216170LgjAIp','strokeVertexShader_','generateBuffers','data','getSymbolVertexShader','lineStringBatch','removeEventListener','30HhwrFC','symbolProgram_','strokeFragmentShader_','hasSymbol_','a_index','map','a_measureEnd','56BOTFIC','DISTANCE'];_0x2054=function(){return _0x4fefc5;};return _0x2054();}import{colorEncodeId}from'./utils.js';import{create as _0x4dc1f0,makeInverse as _0x41e02f}from'../../transform.js';import{create as _0x58d7c7}from'../../worker/webgl.js';import{generateLineStringRenderInstructions,generatePointRenderInstructions,generatePolygonRenderInstructions,getCustomAttributesSize}from'./renderinstructions.js';import{parseLiteralStyle}from'../../webgl/styleparser.js';const tmpColor=[],WEBGL_WORKER=_0x58d7c7();let workerMessageCounter=0x0;export const Attributes={'POSITION':_0x3cd027(0x1b2),'INDEX':_0x3cd027(0x1a6),'SEGMENT_START':_0x3cd027(0x1bf),'SEGMENT_END':'a_segmentEnd','MEASURE_START':_0x3cd027(0x1c5),'MEASURE_END':_0x3cd027(0x1a8),'PARAMETERS':_0x3cd027(0x1d7),'JOIN_ANGLES':_0x3cd027(0x1ea),'DISTANCE':'a_distance'};class VectorStyleRenderer{constructor(_0x458442,_0x46303c,_0x22da74){const _0x3aeb3d=_0x3cd027;this[_0x3aeb3d(0x1d3)],this[_0x3aeb3d(0x1d4)]=_0x22da74;let _0x311c32=_0x458442;const _0x2281e2=_0x3aeb3d(0x1be)in _0x458442;if(!_0x2281e2){const _0x2ef367=parseLiteralStyle(_0x458442);_0x311c32={'builder':_0x2ef367['builder'],'attributes':_0x2ef367['attributes'],'uniforms':_0x2ef367[_0x3aeb3d(0x1c4)]};}this[_0x3aeb3d(0x1ca)],this[_0x3aeb3d(0x1b6)],this[_0x3aeb3d(0x1a3)],this['hasFill_']=!!_0x311c32[_0x3aeb3d(0x1be)][_0x3aeb3d(0x1b4)]();this['hasFill_']&&(this['fillVertexShader_']=_0x311c32[_0x3aeb3d(0x1be)]['getFillVertexShader'](),this[_0x3aeb3d(0x1b3)]=_0x311c32[_0x3aeb3d(0x1be)][_0x3aeb3d(0x1ec)]());this[_0x3aeb3d(0x1ad)]=!!_0x311c32[_0x3aeb3d(0x1be)]['getStrokeVertexShader']();this['hasStroke_']&&(this[_0x3aeb3d(0x19c)]=_0x311c32[_0x3aeb3d(0x1be)]['getStrokeVertexShader'](),this['strokeFragmentShader_']=_0x311c32[_0x3aeb3d(0x1be)][_0x3aeb3d(0x1e8)]());this['hasSymbol_']=!!_0x311c32[_0x3aeb3d(0x1be)][_0x3aeb3d(0x19f)]();this[_0x3aeb3d(0x1a5)]&&(this[_0x3aeb3d(0x1b0)]=_0x311c32[_0x3aeb3d(0x1be)][_0x3aeb3d(0x19f)](),this[_0x3aeb3d(0x1e3)]=_0x311c32[_0x3aeb3d(0x1be)][_0x3aeb3d(0x197)]());const _0x560676=this['hitDetectionEnabled_']?{'hitColor':{'callback'(){return colorEncodeId(this['ref'],tmpColor);},'size':0x4}}:{};this[_0x3aeb3d(0x1de)]=Object[_0x3aeb3d(0x1b7)]({},_0x560676,_0x311c32[_0x3aeb3d(0x1d1)]),this[_0x3aeb3d(0x1d0)]=_0x311c32[_0x3aeb3d(0x1c4)];const _0xbaeb35=Object[_0x3aeb3d(0x1c1)](this[_0x3aeb3d(0x1de)])[_0x3aeb3d(0x1a7)](([_0x5bf0a4,_0x59b281])=>({'name':'a_prop_'+_0x5bf0a4,'size':_0x59b281['size']||0x1,'type':AttributeType[_0x3aeb3d(0x196)]}));this[_0x3aeb3d(0x1c2)]=[{'name':Attributes['POSITION'],'size':0x2,'type':AttributeType[_0x3aeb3d(0x196)]},..._0xbaeb35],this['lineStringAttributesDesc_']=[{'name':Attributes[_0x3aeb3d(0x1b5)],'size':0x2,'type':AttributeType['FLOAT']},{'name':Attributes[_0x3aeb3d(0x1e0)],'size':0x1,'type':AttributeType[_0x3aeb3d(0x196)]},{'name':Attributes[_0x3aeb3d(0x1e2)],'size':0x2,'type':AttributeType[_0x3aeb3d(0x196)]},{'name':Attributes[_0x3aeb3d(0x1bd)],'size':0x1,'type':AttributeType[_0x3aeb3d(0x196)]},{'name':Attributes[_0x3aeb3d(0x1d2)],'size':0x2,'type':AttributeType['FLOAT']},{'name':Attributes[_0x3aeb3d(0x1aa)],'size':0x1,'type':AttributeType[_0x3aeb3d(0x196)]},{'name':Attributes['PARAMETERS'],'size':0x1,'type':AttributeType[_0x3aeb3d(0x196)]},..._0xbaeb35],this['pointAttributesDesc_']=[{'name':Attributes[_0x3aeb3d(0x1db)],'size':0x2,'type':AttributeType[_0x3aeb3d(0x196)]},{'name':Attributes['INDEX'],'size':0x1,'type':AttributeType['FLOAT']},..._0xbaeb35],this['setHelper'](_0x46303c);}async[_0x3cd027(0x19d)](_0x18c926,_0x1e6dba){const _0xa42c97=_0x3cd027,_0xb18b36=this[_0xa42c97(0x1e5)](_0x18c926,_0x1e6dba),[_0x36566d,_0x16d7a2,_0x3e07bb]=await Promise[_0xa42c97(0x1c9)]([this[_0xa42c97(0x199)](_0xb18b36[_0xa42c97(0x1dc)],_0xa42c97(0x1dd),_0x1e6dba),this[_0xa42c97(0x199)](_0xb18b36[_0xa42c97(0x198)],_0xa42c97(0x1d5),_0x1e6dba),this[_0xa42c97(0x199)](_0xb18b36[_0xa42c97(0x1cc)],_0xa42c97(0x19a),_0x1e6dba)]),_0x2ff949=_0x41e02f(_0x4dc1f0(),_0x1e6dba);return{'polygonBuffers':_0x36566d,'lineStringBuffers':_0x16d7a2,'pointBuffers':_0x3e07bb,'invertVerticesTransform':_0x2ff949};}['generateRenderInstructions_'](_0x2cfd56,_0x286537){const _0x128ecb=_0x3cd027,_0x33508d=this['hasFill_']?generatePolygonRenderInstructions(_0x2cfd56[_0x128ecb(0x1df)],new Float32Array(0x0),this[_0x128ecb(0x1de)],_0x286537):null,_0xbce973=this['hasStroke_']?generateLineStringRenderInstructions(_0x2cfd56[_0x128ecb(0x1a0)],new Float32Array(0x0),this[_0x128ecb(0x1de)],_0x286537):null,_0x897384=this[_0x128ecb(0x1a5)]?generatePointRenderInstructions(_0x2cfd56['pointBatch'],new Float32Array(0x0),this['customAttributes_'],_0x286537):null;return{'polygonInstructions':_0x33508d,'lineStringInstructions':_0xbce973,'pointInstructions':_0x897384};}[_0x3cd027(0x199)](_0x444f6d,_0x1f6052,_0xab7a33){const _0x4d1ee2=_0x3cd027;if(_0x444f6d===null)return null;const _0x417e6d=workerMessageCounter++;let _0x142cb3;switch(_0x1f6052){case _0x4d1ee2(0x1dd):_0x142cb3=WebGLWorkerMessageType[_0x4d1ee2(0x1b8)];break;case _0x4d1ee2(0x1d5):_0x142cb3=WebGLWorkerMessageType[_0x4d1ee2(0x1cd)];break;case _0x4d1ee2(0x19a):_0x142cb3=WebGLWorkerMessageType[_0x4d1ee2(0x1d9)];break;default:}const _0x3677b6={'id':_0x417e6d,'type':_0x142cb3,'renderInstructions':_0x444f6d[_0x4d1ee2(0x1eb)],'renderInstructionsTransform':_0xab7a33,'customAttributesSize':getCustomAttributesSize(this['customAttributes_'])};return WEBGL_WORKER[_0x4d1ee2(0x1af)](_0x3677b6,[_0x444f6d[_0x4d1ee2(0x1eb)]]),_0x444f6d=null,new Promise(_0x23cefa=>{const _0x5e50cd=_0x4d1ee2,_0x814c0c=_0x5d15e0=>{const _0x3d1f6c=_0x3586,_0x4d7404=_0x5d15e0[_0x3d1f6c(0x19e)];if(_0x4d7404['id']!==_0x417e6d)return;WEBGL_WORKER[_0x3d1f6c(0x1a1)](_0x3d1f6c(0x194),_0x814c0c);if(!this[_0x3d1f6c(0x1d3)][_0x3d1f6c(0x1ed)]())return;const _0x31294a=new _0x20076f(ARRAY_BUFFER,DYNAMIC_DRAW)[_0x3d1f6c(0x1c6)](_0x4d7404[_0x3d1f6c(0x1cf)]),_0x484f40=new _0x20076f(ELEMENT_ARRAY_BUFFER,DYNAMIC_DRAW)[_0x3d1f6c(0x1c6)](_0x4d7404[_0x3d1f6c(0x1b1)]);this[_0x3d1f6c(0x1d3)]['flushBufferData'](_0x31294a),this['helper_']['flushBufferData'](_0x484f40),_0x23cefa([_0x484f40,_0x31294a]);};WEBGL_WORKER[_0x5e50cd(0x1d6)](_0x5e50cd(0x194),_0x814c0c);});}[_0x3cd027(0x1c7)](_0x150691,_0x5d7c53,_0xd34bf9){const _0x359969=_0x3cd027;this[_0x359969(0x1c0)]&&this[_0x359969(0x1e9)](_0x150691[_0x359969(0x1da)][0x0],_0x150691[_0x359969(0x1da)][0x1],this[_0x359969(0x1ca)],this[_0x359969(0x1c2)],_0x5d7c53,_0xd34bf9),this[_0x359969(0x1ad)]&&this[_0x359969(0x1e9)](_0x150691[_0x359969(0x1ce)][0x0],_0x150691[_0x359969(0x1ce)][0x1],this[_0x359969(0x1b6)],this['lineStringAttributesDesc_'],_0x5d7c53,_0xd34bf9),this[_0x359969(0x1a5)]&&this[_0x359969(0x1e9)](_0x150691[_0x359969(0x1bb)][0x0],_0x150691[_0x359969(0x1bb)][0x1],this[_0x359969(0x1a3)],this[_0x359969(0x1e7)],_0x5d7c53,_0xd34bf9);}['renderInternal_'](_0x493176,_0x3f3f82,_0x36d7b0,_0x4a7bfb,_0x37da9a,_0x1016a1){const _0x476652=_0x3cd027,_0xf4d27a=_0x493176[_0x476652(0x1bc)]();if(_0xf4d27a===0x0)return;this[_0x476652(0x1d3)][_0x476652(0x1ba)](_0x36d7b0,_0x37da9a),this[_0x476652(0x1d3)][_0x476652(0x1ae)](_0x3f3f82),this['helper_'][_0x476652(0x1ae)](_0x493176),this['helper_'][_0x476652(0x193)](_0x4a7bfb),_0x1016a1(),this['helper_']['drawElements'](0x0,_0xf4d27a);}[_0x3cd027(0x1c3)](_0x2af949,_0x563c80=null){const _0x393ccb=_0x3cd027;this['helper_']=_0x2af949,this[_0x393ccb(0x1c0)]&&(this[_0x393ccb(0x1ca)]=this[_0x393ccb(0x1d3)][_0x393ccb(0x195)](this[_0x393ccb(0x1b3)],this[_0x393ccb(0x1ab)])),this['hasStroke_']&&(this['strokeProgram_']=this['helper_'][_0x393ccb(0x195)](this[_0x393ccb(0x1a4)],this[_0x393ccb(0x19c)])),this['hasSymbol_']&&(this[_0x393ccb(0x1a3)]=this['helper_']['getProgram'](this[_0x393ccb(0x1e3)],this[_0x393ccb(0x1b0)])),this[_0x393ccb(0x1d3)][_0x393ccb(0x1e1)](this[_0x393ccb(0x1d0)]),_0x563c80&&(_0x563c80[_0x393ccb(0x1da)]&&(this[_0x393ccb(0x1d3)][_0x393ccb(0x1ef)](_0x563c80[_0x393ccb(0x1da)][0x0]),this[_0x393ccb(0x1d3)]['flushBufferData'](_0x563c80[_0x393ccb(0x1da)][0x1])),_0x563c80[_0x393ccb(0x1ce)]&&(this[_0x393ccb(0x1d3)]['flushBufferData'](_0x563c80['lineStringBuffers'][0x0]),this[_0x393ccb(0x1d3)][_0x393ccb(0x1ef)](_0x563c80[_0x393ccb(0x1ce)][0x1])),_0x563c80['pointBuffers']&&(this[_0x393ccb(0x1d3)][_0x393ccb(0x1ef)](_0x563c80[_0x393ccb(0x1bb)][0x0]),this[_0x393ccb(0x1d3)][_0x393ccb(0x1ef)](_0x563c80[_0x393ccb(0x1bb)][0x1])));}}function _0x3586(_0x20f211,_0xe7a734){const _0x20541c=_0x2054();return _0x3586=function(_0x3586b7,_0x49139c){_0x3586b7=_0x3586b7-0x193;let _0x4e5f68=_0x20541c[_0x3586b7];return _0x4e5f68;},_0x3586(_0x20f211,_0xe7a734);}export default VectorStyleRenderer;