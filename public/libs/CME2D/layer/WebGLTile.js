const _0x1e67a4=_0x5cb4;(function(_0x2e4202,_0x2867e1){const _0x5809b0=_0x5cb4,_0x14bf6f=_0x2e4202();while(!![]){try{const _0x76951e=-parseInt(_0x5809b0(0x22e))/0x1*(-parseInt(_0x5809b0(0x228))/0x2)+-parseInt(_0x5809b0(0x1d3))/0x3+parseInt(_0x5809b0(0x210))/0x4+parseInt(_0x5809b0(0x214))/0x5+parseInt(_0x5809b0(0x221))/0x6*(-parseInt(_0x5809b0(0x22a))/0x7)+-parseInt(_0x5809b0(0x1f9))/0x8+parseInt(_0x5809b0(0x21b))/0x9;if(_0x76951e===_0x2867e1)break;else _0x14bf6f['push'](_0x14bf6f['shift']());}catch(_0x41ea1c){_0x14bf6f['push'](_0x14bf6f['shift']());}}}(_0x8acd,0x8e53f));import _0xc1220c from'./BaseTile.js';import _0x1c5d54 from'../layer/Property.js';import _0x397e05,{Attributes,Uniforms}from'../renderer/webgl/TileLayer.js';import{ColorType,NumberType}from'../expr/expression.js';import{PALETTE_TEXTURE_ARRAY,getStringNumberEquivalent,newCompilationContext,uniformNameForVariable}from'../expr/gpu.js';function _0x8acd(){const _0x3b8b37=['8135728OYdvVn','renderComplete','dispose','\x0a\x0a\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20color;\x0a\x20\x20\x20\x20\x20\x20gl_FragColor.rgb\x20*=\x20gl_FragColor.a;\x0a\x20\x20\x20\x20\x20\x20gl_FragColor\x20*=\x20','functions','styleVariables_','map','assign','getRenderer','[0],\x20\x20v_textureCoord);\x0a\x0a\x20\x20\x20\x20\x20\x20','));','style_','paletteTextures','updateStyleVariables','getCacheSize','ZOOM','getRenderSource','\x20*\x20',';\x0a\x0a\x20\x20\x20\x20varying\x20vec2\x20v_textureCoord;\x0a\x20\x20\x20\x20varying\x20vec2\x20v_mapCoord;\x0a\x0a\x20\x20\x20\x20void\x20main()\x20{\x0a\x20\x20\x20\x20\x20\x20v_textureCoord\x20=\x20','TILE_TRANSFORM','uniforms','\x20+\x201.0)\x20*\x20color.rgb\x20-\x20(','vertexShader','3377744nFBOCe','contrast','\x0a\x20\x20\x20\x20attribute\x20vec2\x20','renderedResolution_','1280825kTFrHZ',';\x0a\x0a\x20\x20\x20\x20','Missing\x20variables\x20in\x20style\x20(expected\x20','keys','exposure','viewState','sources_','12664926yroTWd','[2]\x20||\x0a\x20\x20\x20\x20\x20\x20\x20\x20v_mapCoord[1]\x20>\x20','TEXTURE_ORIGIN_Y','getSource','[3]\x0a\x20\x20\x20\x20\x20\x20)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20discard;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20vec4\x20color\x20=\x20texture2D(','RENDER_EXTENT','2876646wMcETQ','MAX_SAFE_INTEGER','setStyle','\x0a\x20\x20\x20\x20\x20\x20float\x20saturation\x20=\x20','string','\x27\x20in\x20style\x20variables','TEXTURE_ORIGIN_X','270aMHcZk','handleSourceUpdate_','7qKbQZE','TEXTURE_COORD','color','reset','5410crrPcg','getSourceState','RESOLUTION','extent','function','style','changed','removeEventListener','prepareFrame','DEPTH','color\x20=\x20','addEventListener','addChangeListener','[0]\x20||\x0a\x20\x20\x20\x20\x20\x20\x20\x20v_mapCoord[1]\x20<\x20','getState','[1]\x20||\x0a\x20\x20\x20\x20\x20\x20\x20\x20v_mapCoord[0]\x20>\x20','gamma',';\x0a\x20\x20\x20\x20\x20\x20v_mapCoord\x20=\x20vec2(\x0a\x20\x20\x20\x20\x20\x20\x20\x20','TEXTURE_RESOLUTION','length','hasRenderer','loading','TEXTURE_PIXEL_WIDTH','ceil','3476349AxLack','rendered','getSourceBandCount_','renderSources',';\x0a\x20\x20\x20\x20}',';\x0a\x20\x20\x20\x20uniform\x20float\x20','includes','color.rgb\x20=\x20clamp(color.rgb\x20+\x20','join','bandCount','Missing\x20\x27','saturation','change',',\x201.0);\x0a\x20\x20\x20\x20}\x0a\x20\x20','render','TRANSITION_ALPHA','name','fragmentShader','resolution','renderedSource_','\x0a\x0a\x20\x20\x20\x20void\x20main()\x20{\x0a\x20\x20\x20\x20\x20\x20if\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20v_mapCoord[0]\x20<\x20',',\x20vec3(0.0,\x200.0,\x200.0),\x20vec3(1.0,\x201.0,\x201.0));','push','\x20+\x201.0)\x20*\x20color.rgb,\x20vec3(0.0,\x200.0,\x200.0),\x20vec3(1.0,\x201.0,\x201.0));','uniform\x20sampler2D\x20','color.rgb\x20=\x20pow(color.rgb,\x20vec3(1.0\x20/\x20','\x0a\x0a\x20\x20\x20\x20','TILE_TEXTURE_ARRAY','clearCache','variables','brightness','filter','color.rgb\x20=\x20clamp((','ready','renderFrame','prototype','getSources','TEXTURE_PIXEL_HEIGHT'];_0x8acd=function(){return _0x3b8b37;};return _0x8acd();}import{expressionToGlsl}from'../webgl/styleparser.js';function parseStyle(_0x196300,_0xd50830){const _0x211fbf=_0x5cb4,_0x5dc679=_0x211fbf(0x212)+Attributes['TEXTURE_COORD']+';\x0a\x20\x20\x20\x20uniform\x20mat4\x20'+Uniforms[_0x211fbf(0x20c)]+_0x211fbf(0x1d8)+Uniforms[_0x211fbf(0x1d1)]+_0x211fbf(0x1d8)+Uniforms[_0x211fbf(0x1f8)]+_0x211fbf(0x1d8)+Uniforms[_0x211fbf(0x1cd)]+_0x211fbf(0x1d8)+Uniforms['TEXTURE_ORIGIN_X']+_0x211fbf(0x1d8)+Uniforms['TEXTURE_ORIGIN_Y']+_0x211fbf(0x1d8)+Uniforms[_0x211fbf(0x1c4)]+_0x211fbf(0x20b)+Attributes[_0x211fbf(0x22b)]+_0x211fbf(0x1cc)+Uniforms[_0x211fbf(0x227)]+'\x20+\x20'+Uniforms[_0x211fbf(0x1cd)]+_0x211fbf(0x20a)+Uniforms[_0x211fbf(0x1d1)]+'\x20*\x20v_textureCoord[0],\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+Uniforms[_0x211fbf(0x21d)]+'\x20-\x20'+Uniforms[_0x211fbf(0x1cd)]+_0x211fbf(0x20a)+Uniforms[_0x211fbf(0x1f8)]+'\x20*\x20v_textureCoord[1]\x0a\x20\x20\x20\x20\x20\x20);\x0a\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20'+Uniforms['TILE_TRANSFORM']+'\x20*\x20vec4('+Attributes['TEXTURE_COORD']+',\x20'+Uniforms[_0x211fbf(0x1c4)]+_0x211fbf(0x1e0),_0x45b0c1={...newCompilationContext(),'inFragmentShader':!![],'bandCount':_0xd50830,'style':_0x196300},_0x1fb219=[];if(_0x196300['color']!==undefined){const _0x256a96=expressionToGlsl(_0x45b0c1,_0x196300[_0x211fbf(0x22c)],ColorType);_0x1fb219[_0x211fbf(0x1e9)](_0x211fbf(0x1c5)+_0x256a96+';');}if(_0x196300[_0x211fbf(0x211)]!==undefined){const _0x23a321=expressionToGlsl(_0x45b0c1,_0x196300[_0x211fbf(0x211)],NumberType);_0x1fb219[_0x211fbf(0x1e9)]('color.rgb\x20=\x20clamp(('+_0x23a321+_0x211fbf(0x20e)+_0x23a321+'\x20/\x202.0),\x20vec3(0.0,\x200.0,\x200.0),\x20vec3(1.0,\x201.0,\x201.0));');}if(_0x196300['exposure']!==undefined){const _0x212cdb=expressionToGlsl(_0x45b0c1,_0x196300[_0x211fbf(0x218)],NumberType);_0x1fb219[_0x211fbf(0x1e9)](_0x211fbf(0x1f3)+_0x212cdb+_0x211fbf(0x1ea));}if(_0x196300[_0x211fbf(0x1de)]!==undefined){const _0x5a59b6=expressionToGlsl(_0x45b0c1,_0x196300[_0x211fbf(0x1de)],NumberType);_0x1fb219[_0x211fbf(0x1e9)](_0x211fbf(0x224)+_0x5a59b6+'\x20+\x201.0;\x0a\x20\x20\x20\x20\x20\x20float\x20sr\x20=\x20(1.0\x20-\x20saturation)\x20*\x200.2126;\x0a\x20\x20\x20\x20\x20\x20float\x20sg\x20=\x20(1.0\x20-\x20saturation)\x20*\x200.7152;\x0a\x20\x20\x20\x20\x20\x20float\x20sb\x20=\x20(1.0\x20-\x20saturation)\x20*\x200.0722;\x0a\x20\x20\x20\x20\x20\x20mat3\x20saturationMatrix\x20=\x20mat3(\x0a\x20\x20\x20\x20\x20\x20\x20\x20sr\x20+\x20saturation,\x20sr,\x20sr,\x0a\x20\x20\x20\x20\x20\x20\x20\x20sg,\x20sg\x20+\x20saturation,\x20sg,\x0a\x20\x20\x20\x20\x20\x20\x20\x20sb,\x20sb,\x20sb\x20+\x20saturation\x0a\x20\x20\x20\x20\x20\x20);\x0a\x20\x20\x20\x20\x20\x20color.rgb\x20=\x20clamp(saturationMatrix\x20*\x20color.rgb,\x20vec3(0.0,\x200.0,\x200.0),\x20vec3(1.0,\x201.0,\x201.0));\x0a\x20\x20\x20\x20');}if(_0x196300[_0x211fbf(0x1cb)]!==undefined){const _0x3eb573=expressionToGlsl(_0x45b0c1,_0x196300[_0x211fbf(0x1cb)],NumberType);_0x1fb219['push'](_0x211fbf(0x1ec)+_0x3eb573+_0x211fbf(0x203));}if(_0x196300[_0x211fbf(0x1f1)]!==undefined){const _0x4944aa=expressionToGlsl(_0x45b0c1,_0x196300['brightness'],NumberType);_0x1fb219[_0x211fbf(0x1e9)](_0x211fbf(0x1da)+_0x4944aa+_0x211fbf(0x1e8));}const _0x56dac3={},_0x4d015d=Object[_0x211fbf(0x217)](_0x45b0c1['variables'])[_0x211fbf(0x1ce)];if(_0x4d015d>0x1&&!_0x196300[_0x211fbf(0x1f0)])throw new Error(_0x211fbf(0x216)+_0x45b0c1[_0x211fbf(0x1f0)]+')');for(let _0x1ed8c9=0x0;_0x1ed8c9<_0x4d015d;++_0x1ed8c9){const _0x348b1c=_0x45b0c1[_0x211fbf(0x1f0)][Object['keys'](_0x45b0c1[_0x211fbf(0x1f0)])[_0x1ed8c9]];if(!(_0x348b1c[_0x211fbf(0x1e3)]in _0x196300[_0x211fbf(0x1f0)]))throw new Error(_0x211fbf(0x1dd)+_0x348b1c['name']+_0x211fbf(0x226));const _0x3601ef=uniformNameForVariable(_0x348b1c['name']);_0x56dac3[_0x3601ef]=function(){const _0x3e32e7=_0x211fbf;let _0x6efafa=_0x196300[_0x3e32e7(0x1f0)][_0x348b1c[_0x3e32e7(0x1e3)]];return typeof _0x6efafa===_0x3e32e7(0x225)&&(_0x6efafa=getStringNumberEquivalent(_0x6efafa)),_0x6efafa!==undefined?_0x6efafa:-0x98967f;};}const _0x56b722=Object['keys'](_0x56dac3)[_0x211fbf(0x1ff)](function(_0x2326ff){return'uniform\x20float\x20'+_0x2326ff+';';}),_0x34dad6=Math[_0x211fbf(0x1d2)](_0xd50830/0x4);_0x56b722[_0x211fbf(0x1e9)](_0x211fbf(0x1eb)+Uniforms[_0x211fbf(0x1ee)]+'['+_0x34dad6+'];');_0x45b0c1['paletteTextures']&&_0x56b722[_0x211fbf(0x1e9)]('uniform\x20sampler2D\x20'+PALETTE_TEXTURE_ARRAY+'['+_0x45b0c1['paletteTextures'][_0x211fbf(0x1ce)]+'];');const _0x438bbf=Object['keys'](_0x45b0c1[_0x211fbf(0x1fd)])[_0x211fbf(0x1ff)](function(_0x1bd5c9){const _0x17d3bd=_0x211fbf;return _0x45b0c1[_0x17d3bd(0x1fd)][_0x1bd5c9];}),_0x197157='\x0a\x20\x20\x20\x20#ifdef\x20GL_FRAGMENT_PRECISION_HIGH\x0a\x20\x20\x20\x20precision\x20highp\x20float;\x0a\x20\x20\x20\x20#else\x0a\x20\x20\x20\x20precision\x20mediump\x20float;\x0a\x20\x20\x20\x20#endif\x0a\x0a\x20\x20\x20\x20varying\x20vec2\x20v_textureCoord;\x0a\x20\x20\x20\x20varying\x20vec2\x20v_mapCoord;\x0a\x20\x20\x20\x20uniform\x20vec4\x20'+Uniforms[_0x211fbf(0x220)]+_0x211fbf(0x1d8)+Uniforms[_0x211fbf(0x1e2)]+_0x211fbf(0x1d8)+Uniforms[_0x211fbf(0x1d1)]+_0x211fbf(0x1d8)+Uniforms[_0x211fbf(0x1f8)]+_0x211fbf(0x1d8)+Uniforms[_0x211fbf(0x1bd)]+';\x0a\x20\x20\x20\x20uniform\x20float\x20'+Uniforms[_0x211fbf(0x208)]+_0x211fbf(0x215)+_0x56b722[_0x211fbf(0x1db)]('\x0a')+_0x211fbf(0x1ed)+_0x438bbf['join']('\x0a')+_0x211fbf(0x1e7)+Uniforms[_0x211fbf(0x220)]+_0x211fbf(0x1c8)+Uniforms['RENDER_EXTENT']+_0x211fbf(0x1ca)+Uniforms['RENDER_EXTENT']+_0x211fbf(0x21c)+Uniforms[_0x211fbf(0x220)]+_0x211fbf(0x21f)+Uniforms[_0x211fbf(0x1ee)]+_0x211fbf(0x202)+_0x1fb219[_0x211fbf(0x1db)]('\x0a')+_0x211fbf(0x1fc)+Uniforms[_0x211fbf(0x1e2)]+_0x211fbf(0x1d7);return{'vertexShader':_0x5dc679,'fragmentShader':_0x197157,'uniforms':_0x56dac3,'paletteTextures':_0x45b0c1[_0x211fbf(0x205)]};}function _0x5cb4(_0x145550,_0x51c0bc){const _0x8acdad=_0x8acd();return _0x5cb4=function(_0x5cb4f1,_0x26cdde){_0x5cb4f1=_0x5cb4f1-0x1bc;let _0x545ced=_0x8acdad[_0x5cb4f1];return _0x545ced;},_0x5cb4(_0x145550,_0x51c0bc);}class WebGLTileLayer extends _0xc1220c{constructor(_0x30327b){const _0x9bb802=_0x5cb4;_0x30327b=_0x30327b?Object[_0x9bb802(0x200)]({},_0x30327b):{};const _0x468504=_0x30327b[_0x9bb802(0x1c0)]||{};delete _0x30327b[_0x9bb802(0x1c0)],super(_0x30327b),this[_0x9bb802(0x21a)]=_0x30327b['sources'],this['renderedSource_']=null,this[_0x9bb802(0x213)]=NaN,this['style_']=_0x468504,this[_0x9bb802(0x1fe)]=this[_0x9bb802(0x204)][_0x9bb802(0x1f0)]||{},this[_0x9bb802(0x1c7)](_0x1c5d54['SOURCE'],this[_0x9bb802(0x229)]);}['getSources'](_0x4702a,_0x52ab00){const _0x26c2a4=_0x5cb4,_0x295c87=this[_0x26c2a4(0x21e)]();return this[_0x26c2a4(0x21a)]?typeof this[_0x26c2a4(0x21a)]===_0x26c2a4(0x1bf)?this[_0x26c2a4(0x21a)](_0x4702a,_0x52ab00):this[_0x26c2a4(0x21a)]:_0x295c87?[_0x295c87]:[];}[_0x1e67a4(0x209)](){const _0x386abc=_0x1e67a4;return this['renderedSource_']||this[_0x386abc(0x21e)]();}[_0x1e67a4(0x1bc)](){const _0x5e756a=_0x1e67a4,_0x54e353=this[_0x5e756a(0x209)]();return _0x54e353?_0x54e353[_0x5e756a(0x1c9)]():'undefined';}[_0x1e67a4(0x229)](){const _0x4da578=_0x1e67a4;this['hasRenderer']()&&this[_0x4da578(0x201)]()[_0x4da578(0x1ef)](),this[_0x4da578(0x21e)]()&&this[_0x4da578(0x223)](this[_0x4da578(0x204)]);}[_0x1e67a4(0x1d5)](){const _0x4480f5=_0x1e67a4,_0x2f6407=Number[_0x4480f5(0x222)],_0x2bea83=this['getSources']([-_0x2f6407,-_0x2f6407,_0x2f6407,_0x2f6407],_0x2f6407);return _0x2bea83&&_0x2bea83[_0x4480f5(0x1ce)]&&'bandCount'in _0x2bea83[0x0]?_0x2bea83[0x0][_0x4480f5(0x1dc)]:0x4;}['createRenderer'](){const _0x1884f9=_0x1e67a4,_0x16bbc4=parseStyle(this[_0x1884f9(0x204)],this['getSourceBandCount_']());return new _0x397e05(this,{'vertexShader':_0x16bbc4[_0x1884f9(0x20f)],'fragmentShader':_0x16bbc4['fragmentShader'],'uniforms':_0x16bbc4['uniforms'],'cacheSize':this[_0x1884f9(0x207)](),'paletteTextures':_0x16bbc4[_0x1884f9(0x205)]});}['renderSources'](_0x30b50d,_0x563176){const _0x10310a=_0x1e67a4,_0x36c6f7=this[_0x10310a(0x201)]();let _0x33769e;for(let _0x20a61f=0x0,_0x55c9df=_0x563176[_0x10310a(0x1ce)];_0x20a61f<_0x55c9df;++_0x20a61f){this[_0x10310a(0x1e6)]=_0x563176[_0x20a61f],_0x36c6f7[_0x10310a(0x1c3)](_0x30b50d)&&(_0x33769e=_0x36c6f7[_0x10310a(0x1f5)](_0x30b50d));}return _0x33769e;}[_0x1e67a4(0x1e1)](_0x3cd039,_0x3c1bda){const _0x1ca821=_0x1e67a4;this[_0x1ca821(0x1d4)]=!![];const _0x1fb305=_0x3cd039[_0x1ca821(0x219)],_0x5aa3de=this['getSources'](_0x3cd039['extent'],_0x1fb305['resolution']);let _0x264449=!![];for(let _0x214f30=0x0,_0x3624bc=_0x5aa3de['length'];_0x214f30<_0x3624bc;++_0x214f30){const _0x3fd247=_0x5aa3de[_0x214f30],_0x57a04d=_0x3fd247[_0x1ca821(0x1c9)]();if(_0x57a04d==_0x1ca821(0x1d0)){const _0x163798=()=>{const _0x40d7c7=_0x1ca821;_0x3fd247['getState']()==_0x40d7c7(0x1f4)&&(_0x3fd247[_0x40d7c7(0x1c2)]('change',_0x163798),this[_0x40d7c7(0x1c1)]());};_0x3fd247[_0x1ca821(0x1c6)](_0x1ca821(0x1df),_0x163798);}_0x264449=_0x264449&&_0x57a04d==_0x1ca821(0x1f4);}const _0x41cee6=this[_0x1ca821(0x1d6)](_0x3cd039,_0x5aa3de);if(this[_0x1ca821(0x201)]()[_0x1ca821(0x1fa)]&&_0x264449)return this[_0x1ca821(0x213)]=_0x1fb305[_0x1ca821(0x1e5)],_0x41cee6;if(this[_0x1ca821(0x213)]>0.5*_0x1fb305[_0x1ca821(0x1e5)]){const _0x199e58=this[_0x1ca821(0x1f7)](_0x3cd039[_0x1ca821(0x1be)],this[_0x1ca821(0x213)])[_0x1ca821(0x1f2)](_0x370e84=>!_0x5aa3de[_0x1ca821(0x1d9)](_0x370e84));if(_0x199e58['length']>0x0)return this[_0x1ca821(0x1d6)](_0x3cd039,_0x199e58);}return _0x41cee6;}[_0x1e67a4(0x223)](_0x3718a2){const _0x30e4cd=_0x1e67a4;this[_0x30e4cd(0x1fe)]=_0x3718a2[_0x30e4cd(0x1f0)]||{},this[_0x30e4cd(0x204)]=_0x3718a2;if(this[_0x30e4cd(0x1cf)]()){const _0x26c3ef=parseStyle(this[_0x30e4cd(0x204)],this[_0x30e4cd(0x1d5)]()),_0x3b437f=this['getRenderer']();_0x3b437f[_0x30e4cd(0x22d)]({'vertexShader':_0x26c3ef[_0x30e4cd(0x20f)],'fragmentShader':_0x26c3ef[_0x30e4cd(0x1e4)],'uniforms':_0x26c3ef[_0x30e4cd(0x20d)],'paletteTextures':_0x26c3ef['paletteTextures']}),this[_0x30e4cd(0x1c1)]();}}[_0x1e67a4(0x206)](_0x5f2e9d){const _0x3b6a1b=_0x1e67a4;Object['assign'](this[_0x3b6a1b(0x1fe)],_0x5f2e9d),this[_0x3b6a1b(0x1c1)]();}}WebGLTileLayer[_0x1e67a4(0x1f6)][_0x1e67a4(0x1fb)];export default WebGLTileLayer;