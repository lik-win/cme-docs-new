var _0x388f87=_0xd927;(function(_0x5703a9,_0x9d9f){var _0x5c1215=_0xd927,_0x48f0e0=_0x5703a9();while(!![]){try{var _0x31ee1d=-parseInt(_0x5c1215(0x170))/0x1+parseInt(_0x5c1215(0x128))/0x2*(-parseInt(_0x5c1215(0x147))/0x3)+-parseInt(_0x5c1215(0x164))/0x4+-parseInt(_0x5c1215(0x11c))/0x5*(parseInt(_0x5c1215(0x11b))/0x6)+parseInt(_0x5c1215(0x154))/0x7+parseInt(_0x5c1215(0x171))/0x8*(parseInt(_0x5c1215(0x14e))/0x9)+-parseInt(_0x5c1215(0x129))/0xa*(-parseInt(_0x5c1215(0x158))/0xb);if(_0x31ee1d===_0x9d9f)break;else _0x48f0e0['push'](_0x48f0e0['shift']());}catch(_0x19866e){_0x48f0e0['push'](_0x48f0e0['shift']());}}}(_0x47fd,0x71700));import{unByKey as _0x1830f7}from'../../Observable.js';function _0xd927(_0x187d92,_0x125db4){var _0x47fd4e=_0x47fd();return _0xd927=function(_0xd927e8,_0x2f1bfa){_0xd927e8=_0xd927e8-0x111;var _0x2afd6e=_0x47fd4e[_0xd927e8];return _0x2afd6e;},_0xd927(_0x187d92,_0x125db4);}import _0xbdee77 from'../../layer/Image.js';import _0x247f42 from'../../source/ImageCanvas.js';import _0x849976 from'../../style/Style.js';import _0x5da388 from'../../style/Fill.js';import{asString as _0x34c6fe}from'../../color.js';function _0x47fd(){var _0x128e3b=['fillStyle','231900ffHSXJ','100YWbkRG','clientY','offsetRect','getStroke','replace','setVisible','stopPropagation','ol-fixPopup','rotate(','getSize','clientX','_listener','58dvrOJP','35240dpCWPQ','inversePixelTransform','get','changed','setLinkStyle','maxScale','_pixel','pointerdown','strokeStyle','keys','getColor','rotation','\x20rotate(','center-center','_overlay','preventDefault','setMap','\x20scale(','getBoundingClientRect','transform','getFill','setRotation','abs','updateRenderedPosition','setScale','top','addPopupClass','updatePixelPosition','canvas','className','63792yTqQMn','change:size','_style','style','pointercancel','scale(','pixelRatio','477sLGJKq','test','getWidth','moveTo','pointerup','set','1733823xbTfjz','stroke','\x20ol-fixPopup','positioning','6391JjFtil','pointermove','context','width','getPixelFromCoordinate','frameState','deg)','getPixelPosition','getPosition','minScale','setPositioning','setPixelPosition','1665708dDOueE','getMap','setPopupClass','getVisible','acos','left','bind','sqrt','save','height','max','pointerId','393025QoxSWO','55640VAOFxC','length','getTargetElement','scale','show','addEventListener','restore','element','number','createElement','lineTo'];_0x47fd=function(){return _0x128e3b;};return _0x47fd();}import _0x3ee4fc from'../util/element.js';import _0x35860f from'./Popup.js';import{cme_coordinate_dist2d}from'../geom/GeomUtils.js';var cme_Overlay_FixedPopup=class olOverlayFixedPopup extends _0x35860f{constructor(_0x5c2e47){var _0x4f90de=_0xd927;_0x5c2e47['anchor']=![],_0x5c2e47[_0x4f90de(0x157)]=_0x5c2e47[_0x4f90de(0x157)]||_0x4f90de(0x136),_0x5c2e47[_0x4f90de(0x146)]=(_0x5c2e47[_0x4f90de(0x146)]||'')+_0x4f90de(0x156),super(_0x5c2e47),this[_0x4f90de(0x153)](_0x4f90de(0x161),_0x5c2e47[_0x4f90de(0x161)]||0.5),this['set']('maxScale',_0x5c2e47[_0x4f90de(0x12e)]||0x2);var _0x25012e=document[_0x4f90de(0x118)](_0x4f90de(0x145));this[_0x4f90de(0x137)]=new _0xbdee77({'source':new _0x247f42({'canvasFunction':function(_0x23b063,_0x4c8884,_0x13a8eb,_0x9d3aa7){var _0xd6fd0e=_0x4f90de;return _0x25012e[_0xd6fd0e(0x15b)]=_0x9d3aa7[0x0],_0x25012e[_0xd6fd0e(0x16d)]=_0x9d3aa7[0x1],_0x25012e;}})}),this['_style']=_0x5c2e47[_0x4f90de(0x14a)]||new _0x849976({'fill':new _0x5da388({'color':[0x66,0x99,0xff]})}),this[_0x4f90de(0x137)]['on'](['postcompose','postrender'],function(_0x5a6a28){var _0x12ddf1=_0x4f90de;if(this[_0x12ddf1(0x167)]()&&this[_0x12ddf1(0x12f)]){var _0x1761c0=this[_0x12ddf1(0x165)](),_0x5386c2=this[_0x12ddf1(0x160)](),_0xc3d444=_0x1761c0[_0x12ddf1(0x15c)](_0x5386c2),_0x8fac06=this[_0x12ddf1(0x116)]['getBoundingClientRect'](),_0x5a9e7f=this[_0x12ddf1(0x165)]()[_0x12ddf1(0x111)]()[_0x12ddf1(0x13b)](),_0x53fb92=[_0x8fac06[_0x12ddf1(0x169)]-_0x5a9e7f[_0x12ddf1(0x169)]+_0x8fac06['width']/0x2,_0x8fac06[_0x12ddf1(0x142)]-_0x5a9e7f[_0x12ddf1(0x142)]+_0x8fac06[_0x12ddf1(0x16d)]/0x2];_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x16c)]();var _0x5e8ec7=_0x5a6a28[_0x12ddf1(0x12a)];_0x5e8ec7?_0x5a6a28['context'][_0x12ddf1(0x13c)](_0x5e8ec7[0x0],_0x5e8ec7[0x1],_0x5e8ec7[0x2],_0x5e8ec7[0x3],_0x5e8ec7[0x4],_0x5e8ec7[0x5]):_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x112)](_0x5a6a28['frameState'][_0x12ddf1(0x14d)],_0x5a6a28[_0x12ddf1(0x15d)][_0x12ddf1(0x14d)]),_0x5a6a28[_0x12ddf1(0x15a)]['beginPath'](),_0x5a6a28['context'][_0x12ddf1(0x151)](_0xc3d444[0x0],_0xc3d444[0x1]),Math[_0x12ddf1(0x13f)](_0x53fb92[0x0]-_0xc3d444[0x0])>Math[_0x12ddf1(0x13f)](_0x53fb92[0x1]-_0xc3d444[0x1])?(_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x119)](_0x53fb92[0x0],_0x53fb92[0x1]-0x8),_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x119)](_0x53fb92[0x0],_0x53fb92[0x1]+0x8)):(_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x119)](_0x53fb92[0x0]-0x8,_0x53fb92[0x1]),_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x119)](_0x53fb92[0x0]+0x8,_0x53fb92[0x1])),_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x151)](_0xc3d444[0x0],_0xc3d444[0x1]),this[_0x12ddf1(0x149)][_0x12ddf1(0x13d)]()&&(_0x5a6a28['context'][_0x12ddf1(0x11a)]=_0x34c6fe(this['_style']['getFill']()[_0x12ddf1(0x133)]()),_0x5a6a28[_0x12ddf1(0x15a)]['fill']()),this[_0x12ddf1(0x149)][_0x12ddf1(0x11f)]()&&(_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x131)]=_0x34c6fe(this[_0x12ddf1(0x149)]['getStroke']()['getColor']()),_0x5a6a28[_0x12ddf1(0x15a)]['lineWidth']=this[_0x12ddf1(0x149)][_0x12ddf1(0x11f)]()[_0x12ddf1(0x150)](),_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x155)]()),_0x5a6a28[_0x12ddf1(0x15a)][_0x12ddf1(0x115)]();}}['bind'](this));var _0x12873e=function(){var _0x548d29=_0x4f90de;this[_0x548d29(0x163)]();}['bind'](this);this['on'](['hide',_0x4f90de(0x113)],function(){setTimeout(_0x12873e);}['bind'](this));function _0x3d445a(_0x5d57af){var _0x4f49d3=_0x4f90de,_0x2117c3=0x0,_0xa22cd7=0x0,_0x24b822=0x0;for(var _0x3e3933 in _0x5d57af){_0x2117c3+=_0x5d57af[_0x3e3933][_0x4f49d3(0x126)],_0xa22cd7+=_0x5d57af[_0x3e3933][_0x4f49d3(0x11d)],_0x24b822++;}return[_0x2117c3/_0x24b822,_0xa22cd7/_0x24b822];}function _0xb154e7(){var _0x47da9f=_0x4f90de,_0x4b1b13,_0x13128d,_0x4ab264=Object[_0x47da9f(0x132)](_0x175aeb);if(_0x4ab264[_0x47da9f(0x172)]<0x2)return![];_0x4b1b13=_0x175aeb[_0x4ab264[0x0]],_0x13128d=_0x175aeb[_0x4ab264[0x1]];var _0x5c8c59=[_0x13128d[_0x47da9f(0x126)]-_0x4b1b13[_0x47da9f(0x126)],_0x13128d['clientY']-_0x4b1b13[_0x47da9f(0x11d)]];_0x4b1b13=_0x55314a[_0x4ab264[0x0]],_0x13128d=_0x55314a[_0x4ab264[0x1]];var _0x375261=[_0x13128d['clientX']-_0x4b1b13['clientX'],_0x13128d[_0x47da9f(0x11d)]-_0x4b1b13[_0x47da9f(0x11d)]],_0x206b8c=Math['sqrt'](_0x5c8c59[0x0]*_0x5c8c59[0x0]+_0x5c8c59[0x1]*_0x5c8c59[0x1]),_0x123320=Math[_0x47da9f(0x16b)](_0x375261[0x0]*_0x375261[0x0]+_0x375261[0x1]*_0x375261[0x1]),_0x4c852d=Math[_0x47da9f(0x168)]((_0x5c8c59[0x0]*_0x375261[0x0]+_0x5c8c59[0x1]*_0x375261[0x1])/(_0x206b8c*_0x123320))*0x168/Math['PI'];if(_0x5c8c59[0x0]*_0x375261[0x1]-_0x5c8c59[0x1]*_0x375261[0x0]<0x0)return-_0x4c852d;else return _0x4c852d;}function _0x535661(_0x236685){var _0x1c1346=_0x4f90de,_0x5c7a17=Object[_0x1c1346(0x132)](_0x236685);if(_0x5c7a17[_0x1c1346(0x172)]<0x2)return![];return cme_coordinate_dist2d([_0x236685[_0x5c7a17[0x0]][_0x1c1346(0x126)],_0x236685[_0x5c7a17[0x0]][_0x1c1346(0x11d)]],[_0x236685[_0x5c7a17[0x1]]['clientX'],_0x236685[_0x5c7a17[0x1]][_0x1c1346(0x11d)]]);}var _0x175aeb={},_0x55314a={},_0x2a84fd=[],_0x148319,_0x3edb24,_0x392c8,_0x2daee2;this[_0x4f90de(0x116)][_0x4f90de(0x114)](_0x4f90de(0x130),function(_0x302a9a){var _0x3c48ce=_0x4f90de;_0x302a9a[_0x3c48ce(0x138)](),_0x302a9a['stopPropagation']();for(let _0x52f587 in _0x175aeb){_0x55314a[_0x52f587]&&(_0x175aeb[_0x52f587]=_0x55314a[_0x52f587]);}_0x175aeb[_0x302a9a[_0x3c48ce(0x16f)]]=_0x302a9a,_0x2a84fd=this['_pixel'],_0x3edb24=this[_0x3c48ce(0x12b)](_0x3c48ce(0x134))||0x0,_0x392c8=this[_0x3c48ce(0x12b)](_0x3c48ce(0x112))||0x1,_0x148319=_0x535661(_0x175aeb),_0x2daee2=![];}[_0x4f90de(0x16a)](this)),this[_0x4f90de(0x116)]['addEventListener']('click',function(_0x5abf64){var _0x325b3e=_0x4f90de;_0x2daee2&&(_0x5abf64[_0x325b3e(0x138)](),_0x5abf64[_0x325b3e(0x122)]());},!![]);var _0xc0ff1c=function(_0x401aec){var _0x166164=_0x4f90de;_0x175aeb[_0x401aec['pointerId']]&&(delete _0x175aeb[_0x401aec[_0x166164(0x16f)]],_0x401aec['preventDefault']()),_0x55314a[_0x401aec['pointerId']]&&delete _0x55314a[_0x401aec['pointerId']];}['bind'](this);document[_0x4f90de(0x114)](_0x4f90de(0x152),_0xc0ff1c),document[_0x4f90de(0x114)](_0x4f90de(0x14b),_0xc0ff1c),document[_0x4f90de(0x114)](_0x4f90de(0x159),function(_0x5f2075){var _0x2be53b=_0x4f90de;if(_0x175aeb[_0x5f2075['pointerId']]){_0x5f2075[_0x2be53b(0x138)](),_0x55314a[_0x5f2075['pointerId']]=_0x5f2075;var _0x453fa7=_0x3d445a(_0x175aeb),_0x3f6317=_0x3d445a(_0x55314a),_0x5db522=_0x3f6317[0x0]-_0x453fa7[0x0],_0x597e60=_0x3f6317[0x1]-_0x453fa7[0x1];_0x2daee2=_0x2daee2||Math['abs'](_0x5db522)>0x3||Math[_0x2be53b(0x13f)](_0x597e60)>0x3;var _0xf3421f=_0xb154e7();_0xf3421f&&this[_0x2be53b(0x13e)](_0x3edb24+_0xf3421f*1.5,![]);var _0x23cdbe=_0x535661(_0x55314a);_0x23cdbe!==![]&&_0x148319&&(this[_0x2be53b(0x141)](_0x392c8*_0x23cdbe/_0x148319,![]),_0x148319=_0x392c8*_0x23cdbe/this[_0x2be53b(0x12b)](_0x2be53b(0x112))),this[_0x2be53b(0x163)]([_0x2a84fd[0x0]+_0x5db522,_0x2a84fd[0x1]+_0x597e60]);}}[_0x4f90de(0x16a)](this));}[_0x388f87(0x139)](_0x240c70){var _0x56dc80=_0x388f87;super[_0x56dc80(0x139)](_0x240c70),this[_0x56dc80(0x137)][_0x56dc80(0x139)](this[_0x56dc80(0x165)]()),this[_0x56dc80(0x127)]&&_0x1830f7(this['_listener']),_0x240c70&&(this[_0x56dc80(0x127)]=_0x240c70['on'](_0x56dc80(0x148),function(){var _0x37f403=_0x56dc80;this[_0x37f403(0x163)]();}[_0x56dc80(0x16a)](this)));}[_0x388f87(0x144)](){var _0x78bd54=_0x388f87,_0x42c539=this[_0x78bd54(0x165)](),_0x1dd701=this[_0x78bd54(0x160)]();if(!_0x42c539||!_0x42c539['isRendered']()||!_0x1dd701){this[_0x78bd54(0x121)](![]);return;}if(!this[_0x78bd54(0x12f)]){this['_pixel']=_0x42c539['getPixelFromCoordinate'](_0x1dd701);var _0x3290cc=_0x42c539[_0x78bd54(0x125)]();this[_0x78bd54(0x140)](this[_0x78bd54(0x12f)],_0x3290cc);}else this[_0x78bd54(0x121)](!![]);}[_0x388f87(0x140)](_0x28bc7b,_0x11007c){var _0x55f9a2=_0x388f87;super[_0x55f9a2(0x140)](_0x28bc7b,_0x11007c),this[_0x55f9a2(0x13e)](),this[_0x55f9a2(0x141)]();}[_0x388f87(0x163)](_0x5382da,_0x35bd52){var _0x70904b=_0x388f87,_0x230d42,_0x56d8ba=this[_0x70904b(0x165)](),_0x23c27d=_0x56d8ba?_0x56d8ba[_0x70904b(0x125)]():[0x0,0x0];if(_0x35bd52){this[_0x70904b(0x162)](_0x35bd52),_0x230d42=_0x3ee4fc[_0x70904b(0x11e)](this[_0x70904b(0x116)]),_0x230d42[_0x70904b(0x15b)]=_0x230d42[_0x70904b(0x16d)]=0x0;if(/top/[_0x70904b(0x14f)](_0x35bd52))_0x5382da[0x1]+=_0x230d42[_0x70904b(0x16d)]/0x2;else{if(/bottom/[_0x70904b(0x14f)](_0x35bd52))_0x5382da[0x1]=_0x23c27d[0x1]-_0x230d42[_0x70904b(0x16d)]/0x2-_0x5382da[0x1];else _0x5382da[0x1]=_0x23c27d[0x1]/0x2+_0x5382da[0x1];}if(/left/[_0x70904b(0x14f)](_0x35bd52))_0x5382da[0x0]+=_0x230d42[_0x70904b(0x15b)]/0x2;else{if(/right/[_0x70904b(0x14f)](_0x35bd52))_0x5382da[0x0]=_0x23c27d[0x0]-_0x230d42[_0x70904b(0x15b)]/0x2-_0x5382da[0x0];else _0x5382da[0x0]=_0x23c27d[0x0]/0x2+_0x5382da[0x0];}}if(_0x5382da)this[_0x70904b(0x12f)]=_0x5382da;if(_0x56d8ba&&_0x56d8ba[_0x70904b(0x111)]()&&this['_pixel']){this['updateRenderedPosition'](this['_pixel'],_0x23c27d);var _0x585e89=![];_0x230d42=_0x3ee4fc[_0x70904b(0x11e)](this[_0x70904b(0x116)]);var _0x38e775=_0x3ee4fc[_0x70904b(0x11e)](_0x56d8ba['getTargetElement']());if(_0x230d42[_0x70904b(0x169)]<_0x38e775['left'])this[_0x70904b(0x12f)][0x0]=this[_0x70904b(0x12f)][0x0]+_0x38e775[_0x70904b(0x169)]-_0x230d42['left'],_0x585e89=!![];else _0x230d42[_0x70904b(0x169)]+_0x230d42[_0x70904b(0x15b)]>_0x38e775[_0x70904b(0x169)]+_0x38e775[_0x70904b(0x15b)]&&(this[_0x70904b(0x12f)][0x0]=this['_pixel'][0x0]+_0x38e775[_0x70904b(0x169)]-_0x230d42[_0x70904b(0x169)]+_0x38e775['width']-_0x230d42[_0x70904b(0x15b)],_0x585e89=!![]);if(_0x230d42[_0x70904b(0x142)]<_0x38e775[_0x70904b(0x142)])this[_0x70904b(0x12f)][0x1]=this[_0x70904b(0x12f)][0x1]+_0x38e775[_0x70904b(0x142)]-_0x230d42[_0x70904b(0x142)],_0x585e89=!![];else _0x230d42[_0x70904b(0x142)]+_0x230d42[_0x70904b(0x16d)]>_0x38e775['top']+_0x38e775[_0x70904b(0x16d)]&&(this[_0x70904b(0x12f)][0x1]=this[_0x70904b(0x12f)][0x1]+_0x38e775['top']-_0x230d42[_0x70904b(0x142)]+_0x38e775[_0x70904b(0x16d)]-_0x230d42['height'],_0x585e89=!![]);if(_0x585e89)this[_0x70904b(0x140)](this[_0x70904b(0x12f)],_0x23c27d);this[_0x70904b(0x137)][_0x70904b(0x12c)]();}}[_0x388f87(0x15f)](){var _0x276fc3=_0x388f87;return this[_0x276fc3(0x12f)];}[_0x388f87(0x166)](_0x47b6ab){var _0x151b98=_0x388f87;super[_0x151b98(0x166)](_0x47b6ab),this[_0x151b98(0x143)](_0x151b98(0x123));}[_0x388f87(0x13e)](_0x3ce0fd,_0x32c7e0){var _0x5ac79a=_0x388f87;if(typeof _0x3ce0fd==='number')this[_0x5ac79a(0x153)](_0x5ac79a(0x134),_0x3ce0fd);_0x32c7e0!==![]&&(/rotate/['test'](this[_0x5ac79a(0x116)][_0x5ac79a(0x14a)]['transform'])?this[_0x5ac79a(0x116)][_0x5ac79a(0x14a)][_0x5ac79a(0x13c)]=this['element']['style'][_0x5ac79a(0x13c)][_0x5ac79a(0x120)](/rotate\((-?[\d,.]+)deg\)/,_0x5ac79a(0x124)+(this['get']('rotation')||0x0)+_0x5ac79a(0x15e)):this[_0x5ac79a(0x116)][_0x5ac79a(0x14a)][_0x5ac79a(0x13c)]=this[_0x5ac79a(0x116)]['style'][_0x5ac79a(0x13c)]+_0x5ac79a(0x135)+(this[_0x5ac79a(0x12b)](_0x5ac79a(0x134))||0x0)+_0x5ac79a(0x15e));}['setScale'](_0x424e35,_0x39b2a6){var _0x2bca95=_0x388f87;if(typeof _0x424e35===_0x2bca95(0x117))this[_0x2bca95(0x153)]('scale',_0x424e35);_0x424e35=Math['min'](Math[_0x2bca95(0x16e)](this[_0x2bca95(0x12b)](_0x2bca95(0x161))||0x0,this[_0x2bca95(0x12b)](_0x2bca95(0x112))||0x1),this[_0x2bca95(0x12b)](_0x2bca95(0x12e))||0x2),this['set'](_0x2bca95(0x112),_0x424e35),_0x39b2a6!==![]&&(/scale/['test'](this[_0x2bca95(0x116)]['style'][_0x2bca95(0x13c)])?this['element'][_0x2bca95(0x14a)][_0x2bca95(0x13c)]=this[_0x2bca95(0x116)][_0x2bca95(0x14a)][_0x2bca95(0x13c)][_0x2bca95(0x120)](/scale\(([\d,.]+)\)/,_0x2bca95(0x14c)+_0x424e35+')'):this[_0x2bca95(0x116)][_0x2bca95(0x14a)]['transform']=this[_0x2bca95(0x116)][_0x2bca95(0x14a)][_0x2bca95(0x13c)]+_0x2bca95(0x13a)+_0x424e35+')');}[_0x388f87(0x12d)](_0x588fed){var _0xc90052=_0x388f87;this[_0xc90052(0x149)]=_0x588fed,this['_overlay']['changed']();}['getLinkStyle'](){var _0x4751cc=_0x388f87;return this[_0x4751cc(0x149)];}};export default cme_Overlay_FixedPopup;