const _0x1d2967=_0x36dd;(function(_0xbfabb0,_0x34c700){const _0x547cc0=_0x36dd,_0x1137bd=_0xbfabb0();while(!![]){try{const _0x498c86=parseInt(_0x547cc0(0x1a7))/0x1*(-parseInt(_0x547cc0(0x17a))/0x2)+-parseInt(_0x547cc0(0x161))/0x3+parseInt(_0x547cc0(0x1b4))/0x4*(parseInt(_0x547cc0(0x192))/0x5)+parseInt(_0x547cc0(0x1b9))/0x6*(parseInt(_0x547cc0(0x17c))/0x7)+-parseInt(_0x547cc0(0x19a))/0x8+parseInt(_0x547cc0(0x189))/0x9+parseInt(_0x547cc0(0x177))/0xa;if(_0x498c86===_0x34c700)break;else _0x1137bd['push'](_0x1137bd['shift']());}catch(_0x261321){_0x1137bd['push'](_0x1137bd['shift']());}}}(_0x5aaf,0x271b6));import*as _0x460c82 from'./util.js';function _0x36dd(_0x3be7ba,_0x93aa19){const _0x5aaf54=_0x5aaf();return _0x36dd=function(_0x36ddd3,_0x3e5d2c){_0x36ddd3=_0x36ddd3-0x15f;let _0x16626c=_0x5aaf54[_0x36ddd3];return _0x16626c;},_0x36dd(_0x3be7ba,_0x93aa19);}const drawFrag='precision\x20mediump\x20float;\x0auniform\x20sampler2D\x20u_wind;\x0avarying\x20vec2\x20v_particle_pos;\x0auniform\x20vec4\x20bounds;\x0auniform\x20int\x20projCode;\x0auniform\x20vec4\x20layerExtent;\x0avec2\x20posTouv(vec2\x20pos,\x20vec4\x20bounds)\x20{\x0a\x20\x20\x20\x20float\x20u\x20=\x20bounds.x\x20+\x20(bounds.y\x20-\x20bounds.x)\x20*\x20pos.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20bounds.z\x20+\x20(bounds.w\x20-\x20bounds.z)\x20*\x20pos.y;\x0a\x20\x20\x20\x20vec2\x20uv_pos\x20=\x20vec2(u,\x201.0\x20-\x20v);\x0a\x20\x20\x20\x20return\x20uv_pos;\x0a}\x0aconst\x20float\x20PI\x20=\x203.14159265359;\x0avec2\x20mercatorToWGS84(vec2\x20xy)\x20{\x0a\x0a\x20\x20\x20\x20if(projCode==4326){\x0a\x20\x20\x20\x20\x20\x20return\x20vec2(mod(xy.x,\x201.0),\x20xy.y);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20else\x20if(projCode==3857){\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20float\x20y\x20=\x20radians(180.0\x20-\x20xy.y\x20*\x20360.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20y\x20=\x20360.0\x20/\x20PI\x20*\x20atan(exp(y))\x20-\x2090.0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20y\x20=\x20y\x20/\x20-180.0\x20+\x200.5;\x0a\x20\x20\x20\x20//坐标转换\x20\x20\x204326就采用下面一行代码就行了\x0a\x20\x20\x20\x20\x20return\x20vec2(mod(xy.x,\x201.0),\x20y);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20uv_pos\x20=\x20posTouv(v_particle_pos,\x20bounds);\x0a\x20\x20\x20\x20\x20\x20vec2\x20pt=\x20mercatorToWGS84(uv_pos);\x0a\x20\x20\x20\x20vec4\x20pos\x20=\x20texture2D(u_wind,\x20mercatorToWGS84(uv_pos));\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(1.0,\x201.0,\x201.0,\x201.0)\x20*\x20pos.b;\x0a}',drawVert=_0x1d2967(0x19f),quadVert='precision\x20mediump\x20float;\x0a\x0aattribute\x20vec2\x20a_pos;\x0a\x0avarying\x20vec2\x20v_tex_pos;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20v_tex_pos\x20=\x20a_pos;\x0a\x20\x20\x20\x20gl_Position\x20=\x20vec4(1.0\x20-\x202.0\x20*\x20a_pos,\x200,\x201);\x0a}',screenFrag=_0x1d2967(0x16e),updateFrag=_0x1d2967(0x197);export default class WindGL{constructor(_0x31b980,_0x42d761){const _0x21a351=_0x1d2967;this['gl']=_0x31b980,this['dropRateBump']=_0x42d761[_0x21a351(0x1a9)]||0.01,this[_0x21a351(0x194)]=_0x42d761['fadeOpacity']||0.996,this[_0x21a351(0x167)]=_0x42d761[_0x21a351(0x167)]||0.45,this[_0x21a351(0x199)]=_0x42d761['dropRate']||0.001,this[_0x21a351(0x190)]=_0x460c82['createProgram'](_0x31b980,drawVert,drawFrag),this[_0x21a351(0x19c)]=_0x460c82[_0x21a351(0x1b0)](_0x31b980,quadVert,screenFrag),this[_0x21a351(0x1a3)]=_0x460c82[_0x21a351(0x1b0)](_0x31b980,quadVert,updateFrag),this[_0x21a351(0x16c)]=_0x460c82[_0x21a351(0x15f)](_0x31b980,new Float32Array([0x0,0x0,0x1,0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1,0x1])),this[_0x21a351(0x162)]=_0x31b980[_0x21a351(0x186)](),this[_0x21a351(0x1a8)]();}[_0x1d2967(0x1a8)](){const _0x20a47c=_0x1d2967,_0x12d27a=this['gl'],_0x2650cf=new Uint8Array(_0x12d27a['canvas'][_0x20a47c(0x175)]*_0x12d27a[_0x20a47c(0x196)][_0x20a47c(0x181)]*0x4);this[_0x20a47c(0x170)]=_0x460c82[_0x20a47c(0x168)](_0x12d27a,_0x12d27a[_0x20a47c(0x17e)],_0x2650cf,_0x12d27a[_0x20a47c(0x196)]['width'],_0x12d27a[_0x20a47c(0x196)][_0x20a47c(0x181)]),this['screenTexture']=_0x460c82[_0x20a47c(0x168)](_0x12d27a,_0x12d27a[_0x20a47c(0x17e)],_0x2650cf,_0x12d27a['canvas'][_0x20a47c(0x175)],_0x12d27a['canvas']['height']);}[_0x1d2967(0x183)](_0x3c74c7){const _0x1ec37b=_0x1d2967;this[_0x1ec37b(0x18f)]=_0x3c74c7,console['log'](_0x1ec37b(0x173),JSON[_0x1ec37b(0x1b6)](this[_0x1ec37b(0x18f)]));const _0x5d84d5=this['gl'];_0x5d84d5[_0x1ec37b(0x169)](this[_0x1ec37b(0x190)][_0x1ec37b(0x1a2)]),_0x5d84d5[_0x1ec37b(0x160)](this[_0x1ec37b(0x190)][_0x1ec37b(0x18f)],_0x3c74c7[0x0],_0x3c74c7[0x1],_0x3c74c7[0x2],_0x3c74c7[0x3]),_0x5d84d5[_0x1ec37b(0x169)](this['updateProgram'][_0x1ec37b(0x1a2)]),_0x5d84d5[_0x1ec37b(0x160)](this[_0x1ec37b(0x1a3)][_0x1ec37b(0x18f)],_0x3c74c7[0x0],_0x3c74c7[0x1],_0x3c74c7[0x2],_0x3c74c7[0x3]);}set[_0x1d2967(0x17f)](_0x28284c){const _0x255c97=_0x1d2967,_0x1844a8=this['gl'],_0x58ee76=this[_0x255c97(0x19e)]=Math[_0x255c97(0x180)](Math[_0x255c97(0x16d)](_0x28284c));this[_0x255c97(0x1ad)]=_0x58ee76*_0x58ee76;const _0x280d79=new Uint8Array(this[_0x255c97(0x1ad)]*0x4);for(let _0x1bdf98=0x0;_0x1bdf98<_0x280d79[_0x255c97(0x18e)];_0x1bdf98++){_0x280d79[_0x1bdf98]=Math[_0x255c97(0x19b)](Math['random']()*0x100);}this['particleStateTexture0']=_0x460c82[_0x255c97(0x168)](_0x1844a8,_0x1844a8[_0x255c97(0x17e)],_0x280d79,_0x58ee76,_0x58ee76),this['particleStateTexture1']=_0x460c82[_0x255c97(0x168)](_0x1844a8,_0x1844a8[_0x255c97(0x17e)],_0x280d79,_0x58ee76,_0x58ee76);const _0x2d122a=new Float32Array(this[_0x255c97(0x1ad)]);for(let _0x5aa7f3=0x0;_0x5aa7f3<this[_0x255c97(0x1ad)];_0x5aa7f3++)_0x2d122a[_0x5aa7f3]=_0x5aa7f3;this[_0x255c97(0x163)]=_0x460c82[_0x255c97(0x15f)](_0x1844a8,_0x2d122a);}get['numParticles'](){const _0x16487c=_0x1d2967;return this[_0x16487c(0x1ad)];}['setWind'](_0x1ce539){const _0x2226fa=_0x1d2967;this[_0x2226fa(0x178)]=_0x1ce539,this['windTexture']=_0x460c82[_0x2226fa(0x168)](this['gl'],this['gl']['LINEAR'],_0x1ce539[_0x2226fa(0x1b8)]);}[_0x1d2967(0x1a1)](){const _0x52fc10=_0x1d2967,_0x444aba=this['gl'];_0x444aba[_0x52fc10(0x1b2)](_0x444aba[_0x52fc10(0x1a0)]),_0x444aba[_0x52fc10(0x1b2)](_0x444aba[_0x52fc10(0x1aa)]),_0x460c82[_0x52fc10(0x187)](_0x444aba,this[_0x52fc10(0x176)],0x0),_0x460c82['bindTexture'](_0x444aba,this[_0x52fc10(0x1b7)],0x1),this[_0x52fc10(0x188)](),this[_0x52fc10(0x1ae)]();}[_0x1d2967(0x188)](){const _0x2651a3=_0x1d2967,_0x2d03ff=this['gl'];_0x460c82[_0x2651a3(0x1bb)](_0x2d03ff,this['framebuffer'],this[_0x2651a3(0x1a6)]),_0x2d03ff[_0x2651a3(0x172)](0x0,0x0,_0x2d03ff[_0x2651a3(0x196)][_0x2651a3(0x175)],_0x2d03ff[_0x2651a3(0x196)]['height']),this[_0x2651a3(0x1a5)](this[_0x2651a3(0x170)],this[_0x2651a3(0x194)]),this[_0x2651a3(0x1ac)](),_0x460c82['bindFramebuffer'](_0x2d03ff,null),_0x2d03ff['blendFunc'](_0x2d03ff[_0x2651a3(0x171)],_0x2d03ff[_0x2651a3(0x17b)]),this['drawTexture'](this['screenTexture'],0x1),_0x2d03ff[_0x2651a3(0x1b2)](_0x2d03ff[_0x2651a3(0x1b5)]);const _0x5b863b=this[_0x2651a3(0x170)];this['backgroundTexture']=this[_0x2651a3(0x1a6)],this['screenTexture']=_0x5b863b;}[_0x1d2967(0x1a5)](_0x318e88,_0x301c66){const _0x1fb40f=_0x1d2967,_0x21fd61=this['gl'],_0x64d53a=this[_0x1fb40f(0x19c)];_0x21fd61[_0x1fb40f(0x169)](_0x64d53a[_0x1fb40f(0x1a2)]),_0x460c82[_0x1fb40f(0x182)](_0x21fd61,this[_0x1fb40f(0x16c)],_0x64d53a['a_pos'],0x2),_0x460c82['bindTexture'](_0x21fd61,_0x318e88,0x2),_0x21fd61[_0x1fb40f(0x1af)](_0x64d53a[_0x1fb40f(0x184)],0x2),_0x21fd61[_0x1fb40f(0x185)](_0x64d53a[_0x1fb40f(0x166)],_0x301c66),_0x21fd61['drawArrays'](_0x21fd61[_0x1fb40f(0x195)],0x0,0x6);}['drawParticles'](){const _0x186b5f=_0x1d2967,_0x1ef8c3=this['gl'],_0x4b41e1=this[_0x186b5f(0x190)];_0x1ef8c3[_0x186b5f(0x169)](_0x4b41e1[_0x186b5f(0x1a2)]),_0x460c82[_0x186b5f(0x182)](_0x1ef8c3,this[_0x186b5f(0x163)],_0x4b41e1[_0x186b5f(0x16f)],0x1),_0x1ef8c3['uniform1i'](_0x4b41e1['u_particles'],0x1),_0x1ef8c3[_0x186b5f(0x185)](_0x4b41e1[_0x186b5f(0x1b1)],this[_0x186b5f(0x19e)]),_0x1ef8c3[_0x186b5f(0x1af)](_0x4b41e1[_0x186b5f(0x16b)],0x0),_0x1ef8c3[_0x186b5f(0x1a4)](_0x4b41e1[_0x186b5f(0x18d)],this['windData']['uMin'],this[_0x186b5f(0x178)][_0x186b5f(0x174)]),_0x1ef8c3[_0x186b5f(0x1a4)](_0x4b41e1[_0x186b5f(0x18b)],this['windData']['uMax'],this[_0x186b5f(0x178)][_0x186b5f(0x1b3)]),_0x1ef8c3[_0x186b5f(0x1af)](_0x4b41e1[_0x186b5f(0x1ab)],this[_0x186b5f(0x178)][_0x186b5f(0x1ab)]);let _0x1899fc=this['windData'][_0x186b5f(0x19d)];_0x1ef8c3[_0x186b5f(0x1af)](_0x4b41e1[_0x186b5f(0x19d)],_0x1899fc[0x0],_0x1899fc[0x1],_0x1899fc[0x2],_0x1899fc[0x3]),_0x460c82[_0x186b5f(0x187)](this['gl'],this[_0x186b5f(0x18c)],0x2),_0x1ef8c3['uniform1i'](_0x4b41e1[_0x186b5f(0x165)],0x2),_0x1ef8c3[_0x186b5f(0x193)](_0x1ef8c3[_0x186b5f(0x191)],0x0,this[_0x186b5f(0x1ad)]);}['updateParticles'](){const _0x396fd0=_0x1d2967;let _0x10b090=0x10e6;const _0x43a555=this['gl'];_0x460c82['bindFramebuffer'](_0x43a555,this[_0x396fd0(0x162)],this[_0x396fd0(0x179)]),_0x43a555['viewport'](0x0,0x0,this['particleStateResolution'],this[_0x396fd0(0x19e)]);const _0x1792d8=this[_0x396fd0(0x1a3)];_0x43a555[_0x396fd0(0x169)](_0x1792d8[_0x396fd0(0x1a2)]),_0x460c82[_0x396fd0(0x182)](_0x43a555,this['quadBuffer'],_0x1792d8[_0x396fd0(0x198)],0x2),_0x43a555[_0x396fd0(0x1af)](_0x1792d8[_0x396fd0(0x16b)],0x0),_0x43a555['uniform1i'](_0x1792d8['u_particles'],0x1),_0x43a555[_0x396fd0(0x185)](_0x1792d8[_0x396fd0(0x1ba)],Math[_0x396fd0(0x16a)]()),_0x43a555[_0x396fd0(0x1a4)](_0x1792d8['u_wind_res'],this[_0x396fd0(0x178)][_0x396fd0(0x175)],this['windData'][_0x396fd0(0x181)]),_0x43a555['uniform2f'](_0x1792d8[_0x396fd0(0x18d)],this['windData'][_0x396fd0(0x164)],this[_0x396fd0(0x178)][_0x396fd0(0x174)]),_0x43a555['uniform2f'](_0x1792d8[_0x396fd0(0x18b)],this[_0x396fd0(0x178)][_0x396fd0(0x18a)],this[_0x396fd0(0x178)]['vMax']),_0x43a555[_0x396fd0(0x185)](_0x1792d8['u_speed_factor'],this[_0x396fd0(0x167)]),_0x43a555[_0x396fd0(0x185)](_0x1792d8['u_drop_rate'],this[_0x396fd0(0x199)]),_0x43a555[_0x396fd0(0x185)](_0x1792d8[_0x396fd0(0x17d)],this[_0x396fd0(0x1a9)]),_0x43a555['uniform1i'](_0x1792d8[_0x396fd0(0x1ab)],this[_0x396fd0(0x178)][_0x396fd0(0x1ab)]);let _0x1ede1e=this[_0x396fd0(0x178)]['layerExtent'];_0x43a555['uniform1i'](_0x1792d8['layerExtent'],_0x1ede1e[0x0],_0x1ede1e[0x1],_0x1ede1e[0x2],_0x1ede1e[0x3]),_0x43a555[_0x396fd0(0x1af)](_0x1792d8['layerExtent'],this['windData']['layerExtent']),_0x43a555[_0x396fd0(0x193)](_0x43a555[_0x396fd0(0x195)],0x0,0x6);const _0x32ad95=this[_0x396fd0(0x1b7)];this[_0x396fd0(0x1b7)]=this[_0x396fd0(0x179)],this[_0x396fd0(0x179)]=_0x32ad95;}}function _0x5aaf(){const _0x49ce54=['quadBuffer','sqrt','precision\x20mediump\x20float;\x0a\x0auniform\x20sampler2D\x20u_screen;\x0auniform\x20float\x20u_opacity;\x0a\x0avarying\x20vec2\x20v_tex_pos;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture2D(u_screen,\x201.0\x20-\x20v_tex_pos);\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(floor(255.0\x20*\x20color\x20*\x20u_opacity)\x20/\x20255.0);\x0a}','a_index','backgroundTexture','SRC_ALPHA','viewport','\x20\x20this.bounds','vMin','width','windTexture','2218370CuWKuK','windData','particleStateTexture1','10uSWvdE','ONE_MINUS_SRC_ALPHA','7rQElBl','u_drop_rate_bump','NEAREST','numParticles','ceil','height','bindAttribute','updateBounds','u_screen','uniform1f','createFramebuffer','bindTexture','drawScreen','2232468EYsVOr','uMax','u_wind_max','icontexture','u_wind_min','length','bounds','drawProgram','POINTS','55065yxBLQI','drawArrays','fadeOpacity','TRIANGLES','canvas','precision\x20highp\x20float;\x0auniform\x20sampler2D\x20u_particles;\x0auniform\x20sampler2D\x20u_wind;\x0auniform\x20vec2\x20u_wind_res;\x0auniform\x20vec2\x20u_wind_min;\x0auniform\x20vec2\x20u_wind_max;\x0auniform\x20float\x20u_rand_seed;\x0auniform\x20float\x20u_speed_factor;\x0auniform\x20float\x20u_drop_rate;\x0auniform\x20float\x20u_drop_rate_bump;\x0avarying\x20vec2\x20v_tex_pos;\x0auniform\x20vec4\x20bounds;\x0auniform\x20int\x20projCode;\x0auniform\x20vec4\x20layerExtent;\x0a\x0aconst\x20vec3\x20rand_constants\x20=\x20vec3(12.9898,\x2078.233,\x204375.85453);\x0afloat\x20rand(const\x20vec2\x20co)\x20{\x0a\x20\x20\x20\x20float\x20t\x20=\x20dot(rand_constants.xy,\x20co);\x0a\x20\x20\x20\x20return\x20fract(sin(t)\x20*\x20(rand_constants.z\x20+\x20t));\x0a}\x0a\x0avec2\x20lookup_wind(const\x20vec2\x20uv)\x20{\x0a\x20\x20\x20\x20vec2\x20px\x20=\x201.0\x20/\x20u_wind_res;\x0a\x20\x20\x20\x20vec2\x20vc\x20=\x20(floor(uv\x20*\x20u_wind_res))\x20*\x20px;\x0a\x20\x20\x20\x20vec2\x20f\x20=\x20fract(uv\x20*\x20u_wind_res);\x0a\x20\x20\x20\x20vec2\x20tl\x20=\x20texture2D(u_wind,\x20vc).rg;\x0a\x20\x20\x20\x20vec2\x20tr\x20=\x20texture2D(u_wind,\x20vc\x20+\x20vec2(px.x,\x200)).rg;\x0a\x20\x20\x20\x20vec2\x20bl\x20=\x20texture2D(u_wind,\x20vc\x20+\x20vec2(0,\x20px.y)).rg;\x0a\x20\x20\x20\x20vec2\x20br\x20=\x20texture2D(u_wind,\x20vc\x20+\x20px).rg;\x0a\x20\x20\x20\x20return\x20mix(mix(tl,\x20tr,\x20f.x),\x20mix(bl,\x20br,\x20f.x),\x20f.y);\x0a}\x0a\x0avec2\x20posTouv(vec2\x20pos)\x20{\x0a\x20\x20\x20\x20float\x20u\x20=\x20bounds.x\x20+\x20(bounds.y\x20-\x20bounds.x)\x20*\x20pos.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20bounds.z\x20+\x20(bounds.w\x20-\x20bounds.z)\x20*\x20pos.y;\x0a\x20\x20\x20\x20vec2\x20uv_pos\x20=\x20vec2(u,\x201.0\x20-\x20v);\x0a\x20\x20\x20\x20return\x20uv_pos;\x0a}\x0a\x0avec2\x20uvTopos(vec2\x20uv)\x20{\x0a\x20\x20\x20\x20float\x20x\x20=\x20(uv.x\x20-\x20bounds.x)\x20/\x20(bounds.y\x20-\x20bounds.x);\x0a\x20\x20\x20\x20float\x20y\x20=\x20(uv.y\x20-\x20bounds.z)\x20/\x20(bounds.w\x20-\x20bounds.z);\x0a\x20\x20\x20\x20vec2\x20pos\x20=\x20vec2(x,\x20y);\x0a\x20\x20\x20\x20return\x20pos;\x0a}\x0aconst\x20float\x20PI\x20=\x203.14159265359;\x0avec2\x20mercatorToWGS84(vec2\x20xy)\x20{\x0a\x20\x20\x20\x20if(projCode==4326){\x0a\x20\x20\x20\x20\x20\x20return\x20vec2(mod(xy.x,\x201.0),\x20xy.y);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20else\x20if(projCode==3857){\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20float\x20y\x20=\x20radians(180.0\x20-\x20xy.y\x20*\x20360.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20y\x20=\x20360.0\x20/\x20PI\x20*\x20atan(exp(y))\x20-\x2090.0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20y\x20=\x20y\x20/\x20-180.0\x20+\x200.5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20//坐标转换\x20\x20\x204326就采用下面一行代码就行了\x0a\x20\x20\x20\x20\x20return\x20vec2(mod(xy.x,\x201.0),\x20y);\x0a\x20\x20\x20\x20}\x0a\x20\x0a}\x0avec2\x20wgs84ToMercator(vec2\x20xy)\x20{\x0a\x20\x20\x20\x20float\x20y\x20=\x20-180.0\x20*\x20xy.y\x20+\x2090.0;\x0a\x20\x20\x20\x20y\x20=\x20(180.0\x20-\x20(180.0\x20/\x20PI\x20*\x20log(tan(PI\x20/\x204.0\x20+\x20y\x20*\x20PI\x20/\x20360.0))))\x20/\x20360.0;\x0a\x20\x20\x20\x20return\x20vec2(xy.x,\x20y);\x0a}\x0a\x0a//\x20bool\x20isPointInRect(vec2\x20pt,\x20vec4\x20rect)\x20{\x0a//\x20\x20\x20\x20\x20return\x20pt.x\x20>=\x20rect.x\x20&&\x20pt.x\x20<=\x20rect.y\x20&&\x0a//\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pt.y\x20>=\x20rect.z\x20&&\x20pt.y\x20<=\x20rect.w;\x0a//\x20}\x0a\x0a\x20bool\x20isPointInRect(vec2\x20pt,\x20vec4\x20rect)\x20{\x0a\x20\x20\x20\x20return\x20all(greaterThanEqual(pt,\x20rect.xz))\x20&&\x20all(lessThanEqual(pt,\x20rect.yw));\x0a\x0a\x20\x20\x20\x20//\x20rect.xy:\x20代表矩形的左下角\x20(minX,\x20minY)，即\x20vec2(rect.x,\x20rect.y)。\x0a\x20\x20\x20\x20//\x20rect.zw:\x20代表矩形的右上角\x20(maxX,\x20maxY)，即\x20vec2(rect.z,\x20rect.w)。\x0a\x20\x20\x20\x20//\x20greaterThanEqual(pt,\x20rect.xy):\x20判断点的\x20x\x20和\x20y\x20是否大于或等于矩形的左下角。\x0a\x20\x20\x20\x20//\x20lessThanEqual(pt,\x20rect.zw):\x20判断点的\x20x\x20和\x20y\x20是否小于或等于矩形的右上角。\x0a\x20\x20\x20\x20//\x20all():\x20检查所有条件是否为\x20true。\x0a\x0a\x20}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture2D(u_particles,\x20v_tex_pos);\x0a\x20\x20\x20\x20vec2\x20pos\x20=\x20vec2(color.r\x20/\x20255.0\x20+\x20color.b,\x20color.g\x20/\x20255.0\x20+\x20color.a);\x0a\x20\x20\x20\x20vec2\x20uv_pos\x20=\x20posTouv(pos);\x0a\x20\x20\x20\x20vec2\x20velocity\x20=\x20mix(u_wind_min,\x20u_wind_max,\x20lookup_wind(mercatorToWGS84(uv_pos)));\x0a\x20\x20\x20\x20float\x20speed_t\x20=\x20length(velocity)\x20/\x20length(u_wind_max);\x0a\x0a\x20\x20\x20\x20float\x20distortion\x20=\x20cos(radians(pos.y\x20*\x20180.0\x20-\x2090.0));\x0a\x0a\x20\x20\x20\x20vec2\x20offset\x20=\x20vec2(velocity.x,\x20velocity.y)\x20*\x200.0001\x20*\x20u_speed_factor;\x0a\x0a\x20\x20\x20\x20pos\x20=\x20fract(1.0\x20+\x20pos\x20+\x20offset);\x0a\x20\x20\x20\x20vec2\x20seed\x20=\x20(pos\x20+\x20v_tex_pos)\x20*\x20u_rand_seed;\x0a\x0a\x20\x20\x20\x20float\x20drop_rate\x20=\x20u_drop_rate\x20+\x20speed_t\x20*\x20u_drop_rate_bump;\x0a\x20\x20\x20\x20float\x20drop\x20=\x20step(1.0\x20-\x20drop_rate,\x20rand(seed));\x0a\x20\x20\x20\x20vec2\x20random_pos\x20=\x20vec2(rand(seed\x20+\x201.3),\x20rand(seed\x20+\x202.1));\x0a\x20\x20\x20\x20pos\x20=\x20mix(pos,\x20random_pos,\x20drop);\x0a\x0a\x20\x20\x20\x20\x20\x20vec2\x20pt=\x20mercatorToWGS84(uv_pos);\x0a\x0a\x20\x20\x20\x20//\x20vec4\x20test=vec4(layerExtent.x,layerExtent.y,layerExtent.z,layerExtent.w);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20//\x20[0.3190576154920789,0.326553495619032,0.7173354983859591,0.7244422793918185]\x0a\x20\x20\x20\x20//\x20if(isPointInRect(pt,vec4(0.7,\x200.0,\x200.6,\x200.6))){\x0a\x20\x20\x20\x20//\x20\x20if(isPointInRect(pt,vec4(0.306,0.3612,0.612,0.723))){\x0a\x20\x20\x20\x20//\x20\x20if(isPointInRect(pt,vec4(0.306,0.612,0.3612,0.723))){\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20//中国区域\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20[0.6944027777777778,0.9028194444444444,0.554722222255489,0.8339722111077844]\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20\x20\x20\x20[0.6944027777777778,0.9028194444444444,0.5554722222255489,0.8339722111077844]\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20\x20\x20\x20[0.6944,0.90282,0.55547,0.83397]\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20if(isPointInRect(pt,vec4(0.6944,0.90282,0.55547,0.83397))){\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20\x20if(isPointInRect(pt,vec4(0.6944,0.90282,0.55547,0.83397))){\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20if(isPointInRect(pt,vec4(\x20layerExtent.x,layerExtent.z,layerExtent.y,layerExtent.w))){\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(fract(pos\x20*\x20255.0),\x20floor(pos\x20*\x20255.0)\x20/\x20255.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20gl_FragColor\x20=\x20vec4(fract(pos\x20*\x20255.0),\x20floor(pos\x20*\x20255.0)\x20/\x20255.0,0.0,1.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20\x20gl_FragColor\x20=\x20vec4(fract(pos\x20*\x20255.0),\x20floor(pos\x20*\x20255.0)\x20/\x20255.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x0a\x0a\x0a\x0a}','a_pos','dropRate','2134776UPtURl','floor','screenProgram','layerExtent','particleStateResolution','precision\x20mediump\x20float;\x0aattribute\x20float\x20a_index;\x0auniform\x20sampler2D\x20u_particles;\x0auniform\x20float\x20u_particles_res;\x0avarying\x20vec2\x20v_particle_pos;\x0avarying\x20vec2\x20v_webgl_pos;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture2D(u_particles,\x20vec2(fract(a_index\x20/\x20u_particles_res),\x20floor(a_index\x20/\x20u_particles_res)\x20/\x20u_particles_res));\x0a\x20\x20\x20\x20v_particle_pos\x20=\x20vec2(color.r\x20/\x20255.0\x20+\x20color.b,\x20color.g\x20/\x20255.0\x20+\x20color.a);\x0a\x20\x20\x20\x20v_webgl_pos\x20=\x20vec2(2.0\x20*\x20v_particle_pos\x20-\x201.0);\x0a\x20\x20\x20\x20gl_PointSize\x20=\x201.0;\x0a\x20\x20\x20\x20gl_Position\x20=\x20vec4(v_webgl_pos.x,\x20v_webgl_pos.y,\x200,\x201);\x0a}','DEPTH_TEST','draw','program','updateProgram','uniform2f','drawTexture','screenTexture','44797FsKDya','resize','dropRateBump','STENCIL_TEST','projCode','drawParticles','_numParticles','updateParticles','uniform1i','createProgram','u_particles_res','disable','vMax','92tauIjE','BLEND','stringify','particleStateTexture0','image','1449174UyPYtL','u_rand_seed','bindFramebuffer','createBuffer','uniform4f','941109ttZYxo','framebuffer','particleIndexBuffer','uMin','u_icon','u_opacity','speedFactor','createTexture','useProgram','random','u_wind'];_0x5aaf=function(){return _0x49ce54;};return _0x5aaf();}