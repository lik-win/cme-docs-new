const _0x1d043d=_0x4d3e;(function(_0x45d34a,_0x5c53b8){const _0x7a7e93=_0x4d3e,_0x3a1681=_0x45d34a();while(!![]){try{const _0x518808=parseInt(_0x7a7e93(0x13a))/0x1*(-parseInt(_0x7a7e93(0x139))/0x2)+-parseInt(_0x7a7e93(0x140))/0x3*(-parseInt(_0x7a7e93(0x13f))/0x4)+parseInt(_0x7a7e93(0x13c))/0x5+parseInt(_0x7a7e93(0x13d))/0x6+parseInt(_0x7a7e93(0x13b))/0x7+-parseInt(_0x7a7e93(0x138))/0x8+parseInt(_0x7a7e93(0x137))/0x9;if(_0x518808===_0x5c53b8)break;else _0x3a1681['push'](_0x3a1681['shift']());}catch(_0x241a6f){_0x3a1681['push'](_0x3a1681['shift']());}}}(_0x27b6,0x7a832));let updateFrag=_0x1d043d(0x13e);export default updateFrag;function _0x4d3e(_0x160071,_0x2a6ac0){const _0x27b683=_0x27b6();return _0x4d3e=function(_0x4d3e53,_0x40e9e9){_0x4d3e53=_0x4d3e53-0x137;let _0x2aef3b=_0x27b683[_0x4d3e53];return _0x2aef3b;},_0x4d3e(_0x160071,_0x2a6ac0);}function _0x27b6(){const _0xcb98bb=['34DgwqPw','50845SFfetJ','3255896HiOUbB','203490SnouLl','1447530AbrLJa','precision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20u_particles;\x0auniform\x20sampler2D\x20u_wind;\x0auniform\x20vec2\x20u_wind_res;\x0auniform\x20vec2\x20u_wind_min;\x0auniform\x20vec2\x20u_wind_max;\x0auniform\x20float\x20u_rand_seed;\x0auniform\x20float\x20u_speed_factor;\x0auniform\x20float\x20u_drop_rate;\x0auniform\x20float\x20u_drop_rate_bump;\x0a\x0avarying\x20vec2\x20v_tex_pos;\x0auniform\x20vec4\x20bounds;\x0a\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20rand_constants\x20=\x20vec3(12.9898,\x2078.233,\x204375.85453);\x0afloat\x20rand(const\x20vec2\x20co)\x20{\x0a\x20\x20\x20\x20float\x20t\x20=\x20dot(rand_constants.xy,\x20co);\x0a\x20\x20\x20\x20return\x20fract(sin(t)\x20*\x20(rand_constants.z\x20+\x20t));\x0a}\x0a\x0a//\x20wind\x20speed\x20lookup;\x20use\x20manual\x20bilinear\x20filtering\x20based\x20on\x204\x20adjacent\x20pixels\x20for\x20smooth\x20interpolation\x0avec2\x20lookup_wind(const\x20vec2\x20uv)\x20{\x0a\x20\x20\x20\x20//\x20return\x20texture2D(u_wind,\x20uv).rg;\x20//\x20lower-res\x20hardware\x20filtering\x0a\x20\x20\x20vec2\x20px\x20=\x201.0\x20/\x20u_wind_res;\x0a\x20\x20\x20vec2\x20vc\x20=\x20(floor(uv\x20*\x20u_wind_res))\x20*\x20px;\x0a\x20\x20\x20vec2\x20f\x20=\x20fract(uv\x20*\x20u_wind_res);\x0a\x20\x20\x20vec2\x20tl\x20=\x20texture2D(u_wind,\x20vc).rg;\x0a\x20\x20\x20vec2\x20tr\x20=\x20texture2D(u_wind,\x20vc\x20+\x20vec2(px.x,\x200)).rg;\x0a\x20\x20\x20vec2\x20bl\x20=\x20texture2D(u_wind,\x20vc\x20+\x20vec2(0,\x20px.y)).rg;\x0a\x20\x20\x20vec2\x20br\x20=\x20texture2D(u_wind,\x20vc\x20+\x20px).rg;\x0a\x20\x20\x20return\x20mix(mix(tl,\x20tr,\x20f.x),\x20mix(bl,\x20br,\x20f.x),\x20f.y);\x0a}\x0a\x0avec2\x20posTouv(vec2\x20pos)\x20{\x0a\x20\x20\x20\x20float\x20u\x20=\x20bounds.x\x20+\x20(bounds.y\x20-\x20bounds.x)\x20*\x20pos.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20bounds.z\x20+\x20(bounds.w\x20-\x20bounds.z)\x20*\x20pos.y;\x0a\x20\x20\x20\x20vec2\x20uv_pos\x20=\x20vec2(u,1.0\x20-\x20v);\x0a\x20\x20\x20\x20return\x20uv_pos;\x0a}\x0a\x0avec2\x20uvTopos(vec2\x20uv)\x20{\x0a\x20\x20\x20\x20float\x20x\x20=\x20(uv.x\x20-\x20bounds.x)\x20/\x20(bounds.y\x20-\x20bounds.x);\x0a\x20\x20\x20\x20float\x20y\x20=\x20(uv.y\x20-\x20bounds.z)\x20/\x20(bounds.w\x20-\x20bounds.z);\x0a\x20\x20\x20\x20vec2\x20pos\x20=\x20vec2(x,y);\x0a\x20\x20\x20\x20return\x20pos;\x0a}\x0aconst\x20float\x20PI\x20=\x203.14159265359;\x0avec2\x20mercatorToWGS84(vec2\x20xy)\x20{\x0a\x20\x20\x20\x20//\x20convert\x20lat\x20into\x20an\x20angle\x0a\x20\x20\x20\x20float\x20y\x20=\x20radians(180.0\x20-\x20xy.y\x20*\x20360.0);\x0a\x20\x20\x20\x20//\x20use\x20the\x20formula\x20to\x20convert\x20mercator\x20->\x20WGS84\x0a\x20\x20\x20\x20y\x20=\x20360.0\x20/\x20PI\x20\x20*\x20atan(exp(y))\x20-\x2090.0;\x0a\x20\x20\x20\x20//\x20normalize\x20back\x20into\x200..1\x20interval\x0a\x20\x20\x20\x20y\x20=\x20y\x20/\x20-180.0\x20+\x200.5;\x0a\x20\x20\x20\x20//\x20pass\x20lng\x20through,\x20as\x20it\x20doesn\x27t\x20change\x0a\x20\x20\x20\x20return\x20vec2(mod(xy.x\x20,\x201.0),\x20y);\x0a\x20\x20\x20\x20//return\x20vec2(xy.x\x20,\x20y);\x0a}\x0avec2\x20wgs84ToMercator(vec2\x20xy)\x20{\x0a\x20\x20\x20\x20//\x20convert\x20to\x20angle\x0a\x20\x20\x20\x20float\x20y\x20=\x20-180.0\x20*\x20xy.y\x20+\x2090.0;\x0a\x20\x20\x20\x20//\x20use\x20the\x20formule\x20to\x20convert\x0a\x20\x20\x20\x20y\x20=\x20(180.0\x20-\x20(180.0\x20/\x20PI\x20*\x20log(tan(PI\x20/\x204.0\x20+\x20y\x20*\x20PI\x20/\x20360.0))))\x20/\x20360.0;\x0a\x20\x20\x20\x20//\x20pass\x20x\x20through,\x20as\x20it\x20doesn\x27t\x20change\x0a\x20\x20\x20\x20return\x20vec2(xy.x,\x20y);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20通过存储\x20粒子\x20的纹理\x20获取顶点位置颜色\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture2D(u_particles,\x20v_tex_pos);\x0a\x20\x20\x20\x20//\x20计算粒子在UV数据纹理中的位置\x0a\x20\x20\x20\x20vec2\x20pos\x20=\x20vec2(\x0a\x20\x20\x20\x20\x20\x20\x20\x20color.r\x20/\x20255.0\x20+\x20color.b,\x0a\x20\x20\x20\x20\x20\x20\x20\x20color.g\x20/\x20255.0\x20+\x20color.a);\x20//\x20decode\x20particle\x20position\x20from\x20pixel\x20RGBA\x0a\x0a\x0a\x20\x20\x20\x20vec2\x20uv_pos\x20=\x20posTouv(pos);\x0a\x20\x20\x20\x20//\x20获取该粒子的UV数据\x0a\x20\x20\x20\x20vec2\x20velocity\x20=\x20mix(u_wind_min,\x20u_wind_max,\x20lookup_wind(mercatorToWGS84(uv_pos)));\x0a\x20\x20\x20\x20//\x20计算风速\x0a\x20\x20\x20\x20float\x20speed_t\x20=\x20length(velocity)\x20/\x20length(u_wind_max);\x0a\x20\x20\x20\x20//\x20计算移动位置\x0a\x0a\x20\x20\x20\x20//\x20take\x20EPSG:4236\x20distortion\x20into\x20account\x20for\x20calculating\x20where\x20the\x20particle\x20moved\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20float\x20distortion\x20=\x20cos(radians(pos.y\x20*\x20180.0\x20-\x2090.0));\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20vec2\x20offset\x20=\x20vec2(velocity.x\x20,\x20velocity.y)\x20*\x200.0001\x20*\x20u_speed_factor;\x0a\x20\x20\x20\x20//\x20update\x20particle\x20position,\x20wrapping\x20around\x20the\x20date\x20line\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20pos\x20=\x20fract(1.0\x20+\x20pos\x20+\x20offset);\x0a\x20\x20\x20\x20//\x20uv_pos\x20=\x20fract(1.0\x20+\x20uv_pos\x20+\x20offset);\x0a\x20\x20\x20\x20//\x20pos\x20=\x20wgs84ToMercator(uv_pos);\x0a\x0a\x20\x20\x20\x20//\x20a\x20random\x20seed\x20to\x20use\x20for\x20the\x20particle\x20drop\x0a\x20\x20\x20\x20vec2\x20seed\x20=\x20(pos\x20+\x20v_tex_pos)\x20*\x20u_rand_seed;\x0a\x0a\x20\x20\x20\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position,\x20to\x20avoid\x20degeneration\x0a\x0a\x20\x20\x20\x20float\x20drop_rate\x20=\x20u_drop_rate\x20+\x20speed_t\x20*\x20u_drop_rate_bump;\x0a\x20\x20\x20\x20float\x20drop\x20=\x20step(1.0\x20-\x20drop_rate,\x20rand(seed));\x0a\x0a\x20\x20\x20\x20vec2\x20random_pos\x20=\x20vec2(\x0a\x20\x20\x20\x20\x20\x20\x20\x20rand(seed\x20+\x201.3),\x0a\x20\x20\x20\x20\x20\x20\x20rand(seed\x20+\x202.1));\x0a\x0a\x20\x20\x20pos\x20=\x20mix(pos,\x20random_pos,\x20drop);\x0a\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20//\x20encode\x20the\x20new\x20particle\x20position\x20back\x20into\x20RGBA\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(\x0a\x20\x20\x20\x20\x20\x20\x20\x20fract(pos\x20*\x20255.0),\x0a\x20\x20\x20\x20\x20\x20\x20\x20floor(pos\x20*\x20255.0)\x20/\x20255.0);\x0a}\x0a','788PuOPqn','3711tSLaRQ','11591397wBpTFU','7300224OMJCqY'];_0x27b6=function(){return _0xcb98bb;};return _0x27b6();}