function _0x3e41(_0x5930ac,_0x14208d){const _0x5a053d=_0x5a05();return _0x3e41=function(_0x3e4117,_0x4d44f6){_0x3e4117=_0x3e4117-0x78;let _0x564597=_0x5a053d[_0x3e4117];return _0x564597;},_0x3e41(_0x5930ac,_0x14208d);}const _0x1f0fec=_0x3e41;(function(_0xea9724,_0x5736a3){const _0x122559=_0x3e41,_0x29e28c=_0xea9724();while(!![]){try{const _0x50b162=-parseInt(_0x122559(0x8f))/0x1+parseInt(_0x122559(0xa8))/0x2+parseInt(_0x122559(0x9e))/0x3*(-parseInt(_0x122559(0x9c))/0x4)+parseInt(_0x122559(0x7c))/0x5+parseInt(_0x122559(0x93))/0x6+parseInt(_0x122559(0x8b))/0x7+-parseInt(_0x122559(0xa0))/0x8;if(_0x50b162===_0x5736a3)break;else _0x29e28c['push'](_0x29e28c['shift']());}catch(_0x407e35){_0x29e28c['push'](_0x29e28c['shift']());}}}(_0x5a05,0x41adf));import{ERROR_THRESHOLD}from'./common.js';import _0x2e4108 from'../events/EventType.js';import _0x46bc97 from'../Tile.js';import _0x558876 from'../TileState.js';import _0x186694 from'./Triangulation.js';import{calculateSourceExtentResolution,canvasPool,render as _0x3b11b6}from'../reproj.js';function _0x5a05(){const _0x4a89de=['2843904mBVpmg','unlistenSources_','sourcesListenerKeys_','getImage','IDLE','wrappedTileCoord_','release','sourceTiles_','slice','147268NrYrVM','canWrapX','3QhxSta','push','5334480chunzv','sourceTileGrid_','renderEdges_','tile','offset','minY','triangulation_','state','195332cUHlSF','calculateSourceExtent','getTileCoordExtent','reproject_','forEach','LOADED','2296390MMOHgr','canvas_','ERROR','CHANGE','getState','LOADING','getZForResolution','EMPTY','getTileSize','sourceZ_','number','length','minX','changed','maxY','1625414nujpEo','targetTileGrid_','clipExtent_','getContext','290480yfscTU','getTriangles','load','getExtent'];_0x5a05=function(){return _0x4a89de;};return _0x5a05();}import{clamp}from'../math.js';import{getArea,getIntersection,getWidth,wrapAndSliceX}from'../extent.js';import{listen,unlistenByKey}from'../events.js';import{releaseCanvas}from'../dom.js';class ReprojTile extends _0x46bc97{constructor(_0x2c67c0,_0x31a613,_0x491303,_0x505f54,_0x4c9a4d,_0x276319,_0x4a3aba,_0x1fefa4,_0x2bf711,_0x36ea27,_0x43c069,_0x2574f3){const _0x53e931=_0x3e41;super(_0x4c9a4d,_0x558876[_0x53e931(0x97)],_0x2574f3),this[_0x53e931(0xa2)]=_0x43c069!==undefined?_0x43c069:![],this['pixelRatio_']=_0x4a3aba,this['gutter_']=_0x1fefa4,this[_0x53e931(0x7d)]=null,this['sourceTileGrid_']=_0x31a613,this['targetTileGrid_']=_0x505f54,this['wrappedTileCoord_']=_0x276319?_0x276319:_0x4c9a4d,this['sourceTiles_']=[],this[_0x53e931(0x95)]=null,this[_0x53e931(0x85)]=0x0,this[_0x53e931(0x8d)]=_0x2c67c0[_0x53e931(0x9d)]()?_0x2c67c0[_0x53e931(0x92)]():undefined;const _0x27b6ca=_0x505f54['getTileCoordExtent'](this[_0x53e931(0x98)]),_0x25f1c8=this[_0x53e931(0x8c)][_0x53e931(0x92)]();let _0x5aa632=this[_0x53e931(0xa1)][_0x53e931(0x92)]();const _0x1a8027=_0x25f1c8?getIntersection(_0x27b6ca,_0x25f1c8):_0x27b6ca;if(getArea(_0x1a8027)===0x0){this['state']=_0x558876[_0x53e931(0x83)];return;}const _0x131820=_0x2c67c0['getExtent']();_0x131820&&(!_0x5aa632?_0x5aa632=_0x131820:_0x5aa632=getIntersection(_0x5aa632,_0x131820));const _0x4dc464=_0x505f54['getResolution'](this[_0x53e931(0x98)][0x0]),_0x584bed=calculateSourceExtentResolution(_0x2c67c0,_0x491303,_0x1a8027,_0x4dc464);if(!isFinite(_0x584bed)||_0x584bed<=0x0){this['state']=_0x558876[_0x53e931(0x83)];return;}const _0x5047dc=_0x36ea27!==undefined?_0x36ea27:ERROR_THRESHOLD;this[_0x53e931(0xa6)]=new _0x186694(_0x2c67c0,_0x491303,_0x1a8027,_0x5aa632,_0x584bed*_0x5047dc,_0x4dc464);if(this[_0x53e931(0xa6)][_0x53e931(0x90)]()[_0x53e931(0x87)]===0x0){this['state']=_0x558876['EMPTY'];return;}this[_0x53e931(0x85)]=_0x31a613[_0x53e931(0x82)](_0x584bed);let _0x131e17=this[_0x53e931(0xa6)][_0x53e931(0xa9)]();_0x5aa632&&(_0x2c67c0[_0x53e931(0x9d)]()?(_0x131e17[0x1]=clamp(_0x131e17[0x1],_0x5aa632[0x1],_0x5aa632[0x3]),_0x131e17[0x3]=clamp(_0x131e17[0x3],_0x5aa632[0x1],_0x5aa632[0x3])):_0x131e17=getIntersection(_0x131e17,_0x5aa632));if(!getArea(_0x131e17))this[_0x53e931(0xa7)]=_0x558876[_0x53e931(0x83)];else{let _0xed83d5=0x0,_0x4f9fc6=0x0;_0x2c67c0['canWrapX']()&&(_0xed83d5=getWidth(_0x131820),_0x4f9fc6=Math['floor']((_0x131e17[0x0]-_0x131820[0x0])/_0xed83d5));const _0x431ab6=wrapAndSliceX(_0x131e17[_0x53e931(0x9b)](),_0x2c67c0,!![]);_0x431ab6['forEach'](_0x92898b=>{const _0x190840=_0x53e931,_0x41ef79=_0x31a613['getTileRangeForExtentAndZ'](_0x92898b,this[_0x190840(0x85)]);for(let _0x24cfdc=_0x41ef79[_0x190840(0x88)];_0x24cfdc<=_0x41ef79['maxX'];_0x24cfdc++){for(let _0x57b466=_0x41ef79[_0x190840(0xa5)];_0x57b466<=_0x41ef79[_0x190840(0x8a)];_0x57b466++){const _0x429d85=_0x2bf711(this[_0x190840(0x85)],_0x24cfdc,_0x57b466,_0x4a3aba);if(_0x429d85){const _0x462d98=_0x4f9fc6*_0xed83d5;this[_0x190840(0x9a)][_0x190840(0x9f)]({'tile':_0x429d85,'offset':_0x462d98});}}}++_0x4f9fc6;}),this['sourceTiles_'][_0x53e931(0x87)]===0x0&&(this[_0x53e931(0xa7)]=_0x558876[_0x53e931(0x83)]);}}['getImage'](){const _0x376c05=_0x3e41;return this[_0x376c05(0x7d)];}['reproject_'](){const _0x38a4f1=_0x3e41,_0x57218f=[];this[_0x38a4f1(0x9a)]['forEach'](_0x127b69=>{const _0x3d738d=_0x38a4f1,_0x1afd7c=_0x127b69[_0x3d738d(0xa3)];if(_0x1afd7c&&_0x1afd7c[_0x3d738d(0x80)]()==_0x558876[_0x3d738d(0x7b)]){const _0x1ebe2c=this['sourceTileGrid_'][_0x3d738d(0x78)](_0x1afd7c['tileCoord']);_0x1ebe2c[0x0]+=_0x127b69[_0x3d738d(0xa4)],_0x1ebe2c[0x2]+=_0x127b69[_0x3d738d(0xa4)];const _0x59e333=this[_0x3d738d(0x8d)]?.[_0x3d738d(0x9b)]();_0x59e333&&(_0x59e333[0x0]+=_0x127b69['offset'],_0x59e333[0x2]+=_0x127b69['offset']),_0x57218f[_0x3d738d(0x9f)]({'extent':_0x1ebe2c,'clipExtent':_0x59e333,'image':_0x1afd7c[_0x3d738d(0x96)]()});}}),this[_0x38a4f1(0x9a)][_0x38a4f1(0x87)]=0x0;if(_0x57218f['length']===0x0)this[_0x38a4f1(0xa7)]=_0x558876['ERROR'];else{const _0x74f2df=this['wrappedTileCoord_'][0x0],_0x4273e4=this[_0x38a4f1(0x8c)][_0x38a4f1(0x84)](_0x74f2df),_0x1e15cc=typeof _0x4273e4===_0x38a4f1(0x86)?_0x4273e4:_0x4273e4[0x0],_0x4c2892=typeof _0x4273e4===_0x38a4f1(0x86)?_0x4273e4:_0x4273e4[0x1],_0x4d0910=this[_0x38a4f1(0x8c)]['getResolution'](_0x74f2df),_0x459bd4=this[_0x38a4f1(0xa1)]['getResolution'](this[_0x38a4f1(0x85)]),_0xacbac0=this[_0x38a4f1(0x8c)][_0x38a4f1(0x78)](this[_0x38a4f1(0x98)]);this[_0x38a4f1(0x7d)]=_0x3b11b6(_0x1e15cc,_0x4c2892,this['pixelRatio_'],_0x459bd4,this[_0x38a4f1(0xa1)][_0x38a4f1(0x92)](),_0x4d0910,_0xacbac0,this['triangulation_'],_0x57218f,this['gutter_'],this[_0x38a4f1(0xa2)],this['interpolate']),this[_0x38a4f1(0xa7)]=_0x558876[_0x38a4f1(0x7b)];}this[_0x38a4f1(0x89)]();}[_0x1f0fec(0x91)](){const _0x4ea62c=_0x1f0fec;if(this[_0x4ea62c(0xa7)]==_0x558876['IDLE']){this[_0x4ea62c(0xa7)]=_0x558876[_0x4ea62c(0x81)],this[_0x4ea62c(0x89)]();let _0x310032=0x0;this[_0x4ea62c(0x95)]=[],this[_0x4ea62c(0x9a)]['forEach'](({tile:_0x41404e})=>{const _0x185c6b=_0x4ea62c,_0x551a9a=_0x41404e[_0x185c6b(0x80)]();if(_0x551a9a==_0x558876['IDLE']||_0x551a9a==_0x558876[_0x185c6b(0x81)]){_0x310032++;const _0x5674fe=listen(_0x41404e,_0x2e4108[_0x185c6b(0x7f)],_0xf41602=>{const _0x1d75ed=_0x185c6b,_0x4bfd1b=_0x41404e[_0x1d75ed(0x80)]();(_0x4bfd1b==_0x558876['LOADED']||_0x4bfd1b==_0x558876[_0x1d75ed(0x7e)]||_0x4bfd1b==_0x558876['EMPTY'])&&(unlistenByKey(_0x5674fe),_0x310032--,_0x310032===0x0&&(this[_0x1d75ed(0x94)](),this[_0x1d75ed(0x79)]()));});this[_0x185c6b(0x95)][_0x185c6b(0x9f)](_0x5674fe);}}),_0x310032===0x0?setTimeout(this[_0x4ea62c(0x79)]['bind'](this),0x0):this[_0x4ea62c(0x9a)][_0x4ea62c(0x7a)](function({tile:_0x5b9542},_0x1647ad,_0x2cacdb){const _0x48c580=_0x4ea62c,_0x186fdb=_0x5b9542[_0x48c580(0x80)]();_0x186fdb==_0x558876['IDLE']&&_0x5b9542[_0x48c580(0x91)]();});}}[_0x1f0fec(0x94)](){const _0x23dbb8=_0x1f0fec;this[_0x23dbb8(0x95)][_0x23dbb8(0x7a)](unlistenByKey),this[_0x23dbb8(0x95)]=null;}[_0x1f0fec(0x99)](){const _0x1740c5=_0x1f0fec;this[_0x1740c5(0x7d)]&&(releaseCanvas(this[_0x1740c5(0x7d)][_0x1740c5(0x8e)]('2d')),canvasPool['push'](this['canvas_']),this[_0x1740c5(0x7d)]=null),super[_0x1740c5(0x99)]();}}export default ReprojTile;