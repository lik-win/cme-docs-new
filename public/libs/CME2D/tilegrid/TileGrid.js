const _0x443559=_0xbc86;function _0x988b(){const _0x27960d=['tileSize','map','getZForResolution','minY','27546CjkVbm','resolutions','getOrigin','floor','length','103906aamoHH','getTileRangeForTileCoordAndZ','1908690wdOAuC','getTileCoordResolution','8122810QREwad','maxX','resolutions_','Either\x20`tileSize`\x20or\x20`tileSizes`\x20must\x20be\x20configured,\x20never\x20both','getTileCoordForXYAndResolution_','max','tmpExtent_','forEachTileCoord','extent','25kgPGCl','maxZoom','getFullTileRange','calculateTileRanges_','9fynCix','Either\x20`origin`\x20or\x20`origins`\x20must\x20be\x20configured,\x20never\x20both','origins','fullTileRanges_','getMinZoom','getMaxZoom','getTileCoordExtent','min','1285280BXOIPD','zoomFactor_','minZoom','sizes','getTileCoordCenter','tmpSize_','getTileRangeForExtentAndZ','extent_','Number\x20of\x20`tileSizes`\x20and\x20`resolutions`\x20must\x20be\x20equal','maxY','minX','forEachTileCoordParentTileRange','tileSize_','tileSizes_','origin','origin_','tileSizes','7628168nmXmZc','168IKACPr','origins_','getTileSize','558936XSpmOt','getTileCoordForXYAndZ_','getResolution'];_0x988b=function(){return _0x27960d;};return _0x988b();}(function(_0x28b960,_0x4bb0cc){const _0x190fe3=_0xbc86,_0x1aed7f=_0x28b960();while(!![]){try{const _0x4027e8=-parseInt(_0x190fe3(0x88))/0x1*(-parseInt(_0x190fe3(0x7b))/0x2)+-parseInt(_0x190fe3(0x76))/0x3*(parseInt(_0x190fe3(0xa6))/0x4)+-parseInt(_0x190fe3(0x94))/0x5+-parseInt(_0x190fe3(0xa9))/0x6+parseInt(_0x190fe3(0x7d))/0x7+-parseInt(_0x190fe3(0xa5))/0x8+-parseInt(_0x190fe3(0x8c))/0x9*(-parseInt(_0x190fe3(0x7f))/0xa);if(_0x4027e8===_0x4bb0cc)break;else _0x1aed7f['push'](_0x1aed7f['shift']());}catch(_0x24c34c){_0x1aed7f['push'](_0x1aed7f['shift']());}}}(_0x988b,0xa987f));import _0xa31251,{createOrUpdate as _0x53def8}from'../TileRange.js';import{DEFAULT_TILE_SIZE}from'./common.js';import{assert}from'../asserts.js';import{ceil,clamp,floor}from'../math.js';import{createOrUpdate,getTopLeft}from'../extent.js';import{createOrUpdate as _0x34b40a}from'../tilecoord.js';import{intersectsLinearRing}from'../geom/flat/intersectsextent.js';import{isSorted,linearFindNearest}from'../array.js';import{toSize}from'../size.js';function _0xbc86(_0x10e40d,_0x47b7a7){const _0x988b82=_0x988b();return _0xbc86=function(_0xbc8619,_0x10706f){_0xbc8619=_0xbc8619-0x70;let _0x3fab21=_0x988b82[_0xbc8619];return _0x3fab21;},_0xbc86(_0x10e40d,_0x47b7a7);}const tmpTileCoord=[0x0,0x0,0x0],DECIMALS=0x5;class TileGrid{constructor(_0x301424){const _0x3b9e48=_0xbc86;this['minZoom']=_0x301424[_0x3b9e48(0x96)]!==undefined?_0x301424[_0x3b9e48(0x96)]:0x0,this[_0x3b9e48(0x81)]=_0x301424[_0x3b9e48(0x77)],assert(isSorted(this['resolutions_'],(_0x29d85c,_0x500db6)=>_0x500db6-_0x29d85c,!![]),'`resolutions`\x20must\x20be\x20sorted\x20in\x20descending\x20order');let _0x654ada;if(!_0x301424[_0x3b9e48(0x8e)])for(let _0x534925=0x0,_0x172d2b=this[_0x3b9e48(0x81)][_0x3b9e48(0x7a)]-0x1;_0x534925<_0x172d2b;++_0x534925){if(!_0x654ada)_0x654ada=this[_0x3b9e48(0x81)][_0x534925]/this[_0x3b9e48(0x81)][_0x534925+0x1];else{if(this[_0x3b9e48(0x81)][_0x534925]/this['resolutions_'][_0x534925+0x1]!==_0x654ada){_0x654ada=undefined;break;}}}this['zoomFactor_']=_0x654ada,this[_0x3b9e48(0x89)]=this[_0x3b9e48(0x81)][_0x3b9e48(0x7a)]-0x1,this[_0x3b9e48(0xa3)]=_0x301424[_0x3b9e48(0xa2)]!==undefined?_0x301424['origin']:null,this[_0x3b9e48(0xa7)]=null;_0x301424[_0x3b9e48(0x8e)]!==undefined&&(this[_0x3b9e48(0xa7)]=_0x301424['origins'],assert(this[_0x3b9e48(0xa7)][_0x3b9e48(0x7a)]==this['resolutions_']['length'],'Number\x20of\x20`origins`\x20and\x20`resolutions`\x20must\x20be\x20equal'));const _0x185f36=_0x301424[_0x3b9e48(0x87)];_0x185f36!==undefined&&!this[_0x3b9e48(0xa3)]&&!this[_0x3b9e48(0xa7)]&&(this[_0x3b9e48(0xa3)]=getTopLeft(_0x185f36));assert(!this[_0x3b9e48(0xa3)]&&this[_0x3b9e48(0xa7)]||this[_0x3b9e48(0xa3)]&&!this['origins_'],_0x3b9e48(0x8d)),this['tileSizes_']=null;_0x301424[_0x3b9e48(0xa4)]!==undefined&&(this['tileSizes_']=_0x301424[_0x3b9e48(0xa4)],assert(this[_0x3b9e48(0xa1)][_0x3b9e48(0x7a)]==this['resolutions_']['length'],_0x3b9e48(0x9c)));this[_0x3b9e48(0xa0)]=_0x301424[_0x3b9e48(0x72)]!==undefined?_0x301424[_0x3b9e48(0x72)]:!this[_0x3b9e48(0xa1)]?DEFAULT_TILE_SIZE:null,assert(!this['tileSize_']&&this[_0x3b9e48(0xa1)]||this[_0x3b9e48(0xa0)]&&!this[_0x3b9e48(0xa1)],_0x3b9e48(0x82)),this[_0x3b9e48(0x9b)]=_0x185f36!==undefined?_0x185f36:null,this[_0x3b9e48(0x8f)]=null,this[_0x3b9e48(0x99)]=[0x0,0x0],this[_0x3b9e48(0x85)]=[0x0,0x0,0x0,0x0];if(_0x301424[_0x3b9e48(0x97)]!==undefined)this[_0x3b9e48(0x8f)]=_0x301424[_0x3b9e48(0x97)][_0x3b9e48(0x73)]((_0x2fc6e7,_0x184490)=>{const _0x617ada=_0x3b9e48,_0x19bc75=new _0xa31251(Math[_0x617ada(0x93)](0x0,_0x2fc6e7[0x0]),Math[_0x617ada(0x84)](_0x2fc6e7[0x0]-0x1,-0x1),Math['min'](0x0,_0x2fc6e7[0x1]),Math['max'](_0x2fc6e7[0x1]-0x1,-0x1));if(_0x185f36){const _0x18dd47=this[_0x617ada(0x9a)](_0x185f36,_0x184490);_0x19bc75[_0x617ada(0x9e)]=Math['max'](_0x18dd47[_0x617ada(0x9e)],_0x19bc75[_0x617ada(0x9e)]),_0x19bc75[_0x617ada(0x80)]=Math[_0x617ada(0x93)](_0x18dd47[_0x617ada(0x80)],_0x19bc75[_0x617ada(0x80)]),_0x19bc75[_0x617ada(0x75)]=Math[_0x617ada(0x84)](_0x18dd47[_0x617ada(0x75)],_0x19bc75[_0x617ada(0x75)]),_0x19bc75[_0x617ada(0x9d)]=Math[_0x617ada(0x93)](_0x18dd47[_0x617ada(0x9d)],_0x19bc75['maxY']);}return _0x19bc75;});else _0x185f36&&this[_0x3b9e48(0x8b)](_0x185f36);}[_0x443559(0x86)](_0x3f318d,_0x5d343f,_0x3f77ee){const _0x5c0ca1=_0x443559,_0x1aa0cd=this['getTileRangeForExtentAndZ'](_0x3f318d,_0x5d343f);for(let _0x2e3ad9=_0x1aa0cd[_0x5c0ca1(0x9e)],_0x2d694d=_0x1aa0cd[_0x5c0ca1(0x80)];_0x2e3ad9<=_0x2d694d;++_0x2e3ad9){for(let _0x10ddac=_0x1aa0cd[_0x5c0ca1(0x75)],_0x2cb063=_0x1aa0cd[_0x5c0ca1(0x9d)];_0x10ddac<=_0x2cb063;++_0x10ddac){_0x3f77ee([_0x5d343f,_0x2e3ad9,_0x10ddac]);}}}[_0x443559(0x9f)](_0x3c4795,_0x470a04,_0x26ac33,_0x78603c){const _0x59d9fc=_0x443559;let _0x28e243,_0x202e2a,_0x2ff4b9,_0x5da062=null,_0x2d7709=_0x3c4795[0x0]-0x1;this[_0x59d9fc(0x95)]===0x2?(_0x202e2a=_0x3c4795[0x1],_0x2ff4b9=_0x3c4795[0x2]):_0x5da062=this[_0x59d9fc(0x92)](_0x3c4795,_0x78603c);while(_0x2d7709>=this[_0x59d9fc(0x96)]){_0x202e2a!==undefined&&_0x2ff4b9!==undefined?(_0x202e2a=Math[_0x59d9fc(0x79)](_0x202e2a/0x2),_0x2ff4b9=Math[_0x59d9fc(0x79)](_0x2ff4b9/0x2),_0x28e243=_0x53def8(_0x202e2a,_0x202e2a,_0x2ff4b9,_0x2ff4b9,_0x26ac33)):_0x28e243=this['getTileRangeForExtentAndZ'](_0x5da062,_0x2d7709,_0x26ac33);if(_0x470a04(_0x2d7709,_0x28e243))return!![];--_0x2d7709;}return![];}['getExtent'](){const _0x40c28b=_0x443559;return this[_0x40c28b(0x9b)];}[_0x443559(0x91)](){const _0x33b781=_0x443559;return this[_0x33b781(0x89)];}[_0x443559(0x90)](){return this['minZoom'];}[_0x443559(0x78)](_0x5c266a){const _0x17f06f=_0x443559;if(this['origin_'])return this[_0x17f06f(0xa3)];return this[_0x17f06f(0xa7)][_0x5c266a];}[_0x443559(0x71)](_0x16b8f5){const _0x5e1f7c=_0x443559;return this[_0x5e1f7c(0x81)][_0x16b8f5];}['getResolutions'](){return this['resolutions_'];}['getTileCoordChildTileRange'](_0x2aed57,_0x237161,_0x125121){const _0x1f2c00=_0x443559;if(_0x2aed57[0x0]<this['maxZoom']){if(this[_0x1f2c00(0x95)]===0x2){const _0x4c7bc5=_0x2aed57[0x1]*0x2,_0x162195=_0x2aed57[0x2]*0x2;return _0x53def8(_0x4c7bc5,_0x4c7bc5+0x1,_0x162195,_0x162195+0x1,_0x237161);}const _0x183f21=this[_0x1f2c00(0x92)](_0x2aed57,_0x125121||this[_0x1f2c00(0x85)]);return this['getTileRangeForExtentAndZ'](_0x183f21,_0x2aed57[0x0]+0x1,_0x237161);}return null;}[_0x443559(0x7c)](_0x5e4c39,_0x1d6213,_0x5b7549){const _0xd652d8=_0x443559;if(_0x1d6213>this[_0xd652d8(0x89)]||_0x1d6213<this[_0xd652d8(0x96)])return null;const _0x2267c2=_0x5e4c39[0x0],_0x58b70d=_0x5e4c39[0x1],_0x2b7052=_0x5e4c39[0x2];if(_0x1d6213===_0x2267c2)return _0x53def8(_0x58b70d,_0x2b7052,_0x58b70d,_0x2b7052,_0x5b7549);if(this[_0xd652d8(0x95)]){const _0x199dcd=Math['pow'](this[_0xd652d8(0x95)],_0x1d6213-_0x2267c2),_0x68d83e=Math[_0xd652d8(0x79)](_0x58b70d*_0x199dcd),_0x5c7d3a=Math[_0xd652d8(0x79)](_0x2b7052*_0x199dcd);if(_0x1d6213<_0x2267c2)return _0x53def8(_0x68d83e,_0x68d83e,_0x5c7d3a,_0x5c7d3a,_0x5b7549);const _0x5d610c=Math[_0xd652d8(0x79)](_0x199dcd*(_0x58b70d+0x1))-0x1,_0x4c1f6e=Math[_0xd652d8(0x79)](_0x199dcd*(_0x2b7052+0x1))-0x1;return _0x53def8(_0x68d83e,_0x5d610c,_0x5c7d3a,_0x4c1f6e,_0x5b7549);}const _0x3313a5=this['getTileCoordExtent'](_0x5e4c39,this[_0xd652d8(0x85)]);return this[_0xd652d8(0x9a)](_0x3313a5,_0x1d6213,_0x5b7549);}[_0x443559(0x9a)](_0x4f25a5,_0x45e75f,_0x12f0d7){const _0x30de16=_0x443559;this[_0x30de16(0x70)](_0x4f25a5[0x0],_0x4f25a5[0x3],_0x45e75f,![],tmpTileCoord);const _0x1ca932=tmpTileCoord[0x1],_0x4b0ad6=tmpTileCoord[0x2];this[_0x30de16(0x70)](_0x4f25a5[0x2],_0x4f25a5[0x1],_0x45e75f,!![],tmpTileCoord);const _0x531c8a=tmpTileCoord[0x1],_0x2643df=tmpTileCoord[0x2];return _0x53def8(_0x1ca932,_0x531c8a,_0x4b0ad6,_0x2643df,_0x12f0d7);}[_0x443559(0x98)](_0xe6251f){const _0x1a611c=_0x443559,_0x363ea1=this[_0x1a611c(0x78)](_0xe6251f[0x0]),_0x2b1ed2=this[_0x1a611c(0x71)](_0xe6251f[0x0]),_0x40a549=toSize(this[_0x1a611c(0xa8)](_0xe6251f[0x0]),this['tmpSize_']);return[_0x363ea1[0x0]+(_0xe6251f[0x1]+0.5)*_0x40a549[0x0]*_0x2b1ed2,_0x363ea1[0x1]-(_0xe6251f[0x2]+0.5)*_0x40a549[0x1]*_0x2b1ed2];}[_0x443559(0x92)](_0x4e826b,_0x4bb725){const _0x47e7ef=_0x443559,_0x1ce927=this[_0x47e7ef(0x78)](_0x4e826b[0x0]),_0x2b5fd1=this['getResolution'](_0x4e826b[0x0]),_0x2bbb78=toSize(this['getTileSize'](_0x4e826b[0x0]),this['tmpSize_']),_0x4ecc94=_0x1ce927[0x0]+_0x4e826b[0x1]*_0x2bbb78[0x0]*_0x2b5fd1,_0x4c8cd2=_0x1ce927[0x1]-(_0x4e826b[0x2]+0x1)*_0x2bbb78[0x1]*_0x2b5fd1,_0x280a4f=_0x4ecc94+_0x2bbb78[0x0]*_0x2b5fd1,_0x34a313=_0x4c8cd2+_0x2bbb78[0x1]*_0x2b5fd1;return createOrUpdate(_0x4ecc94,_0x4c8cd2,_0x280a4f,_0x34a313,_0x4bb725);}['getTileCoordForCoordAndResolution'](_0x122efd,_0x3df245,_0x181dab){return this['getTileCoordForXYAndResolution_'](_0x122efd[0x0],_0x122efd[0x1],_0x3df245,![],_0x181dab);}[_0x443559(0x83)](_0x3be360,_0x53ad51,_0x32cfdf,_0x8dcd5,_0x2496ae){const _0x3e6e27=_0x443559,_0x3d7263=this[_0x3e6e27(0x74)](_0x32cfdf),_0x87d5e5=_0x32cfdf/this['getResolution'](_0x3d7263),_0x10a60f=this[_0x3e6e27(0x78)](_0x3d7263),_0x2f8dde=toSize(this[_0x3e6e27(0xa8)](_0x3d7263),this[_0x3e6e27(0x99)]);let _0x58ab55=_0x87d5e5*(_0x3be360-_0x10a60f[0x0])/_0x32cfdf/_0x2f8dde[0x0],_0x1c52c3=_0x87d5e5*(_0x10a60f[0x1]-_0x53ad51)/_0x32cfdf/_0x2f8dde[0x1];return _0x8dcd5?(_0x58ab55=ceil(_0x58ab55,DECIMALS)-0x1,_0x1c52c3=ceil(_0x1c52c3,DECIMALS)-0x1):(_0x58ab55=floor(_0x58ab55,DECIMALS),_0x1c52c3=floor(_0x1c52c3,DECIMALS)),_0x34b40a(_0x3d7263,_0x58ab55,_0x1c52c3,_0x2496ae);}[_0x443559(0x70)](_0x17cd71,_0x1aee75,_0x32c3d0,_0x312293,_0x167174){const _0x5aaa32=_0x443559,_0x23493f=this[_0x5aaa32(0x78)](_0x32c3d0),_0x41407d=this['getResolution'](_0x32c3d0),_0x51e993=toSize(this[_0x5aaa32(0xa8)](_0x32c3d0),this[_0x5aaa32(0x99)]);let _0x16f7f1=(_0x17cd71-_0x23493f[0x0])/_0x41407d/_0x51e993[0x0],_0x56ae4b=(_0x23493f[0x1]-_0x1aee75)/_0x41407d/_0x51e993[0x1];return _0x312293?(_0x16f7f1=ceil(_0x16f7f1,DECIMALS)-0x1,_0x56ae4b=ceil(_0x56ae4b,DECIMALS)-0x1):(_0x16f7f1=floor(_0x16f7f1,DECIMALS),_0x56ae4b=floor(_0x56ae4b,DECIMALS)),_0x34b40a(_0x32c3d0,_0x16f7f1,_0x56ae4b,_0x167174);}['getTileCoordForCoordAndZ'](_0x22677b,_0x2c1f1a,_0x1b436e){return this['getTileCoordForXYAndZ_'](_0x22677b[0x0],_0x22677b[0x1],_0x2c1f1a,![],_0x1b436e);}[_0x443559(0x7e)](_0x5c0a64){const _0x479ece=_0x443559;return this[_0x479ece(0x81)][_0x5c0a64[0x0]];}[_0x443559(0xa8)](_0x3ae053){const _0x2a01e0=_0x443559;if(this[_0x2a01e0(0xa0)])return this['tileSize_'];return this[_0x2a01e0(0xa1)][_0x3ae053];}[_0x443559(0x8a)](_0x5244b2){const _0x1c1e65=_0x443559;if(!this[_0x1c1e65(0x8f)])return this['extent_']?this[_0x1c1e65(0x9a)](this[_0x1c1e65(0x9b)],_0x5244b2):null;return this['fullTileRanges_'][_0x5244b2];}[_0x443559(0x74)](_0x1c88de,_0x3c93b1){const _0x366bff=_0x443559,_0x3e6b0e=linearFindNearest(this['resolutions_'],_0x1c88de,_0x3c93b1||0x0);return clamp(_0x3e6b0e,this[_0x366bff(0x96)],this[_0x366bff(0x89)]);}['tileCoordIntersectsViewport'](_0x2cc15a,_0x536b18){const _0x4710fd=_0x443559;return intersectsLinearRing(_0x536b18,0x0,_0x536b18[_0x4710fd(0x7a)],0x2,this['getTileCoordExtent'](_0x2cc15a));}[_0x443559(0x8b)](_0x2a3379){const _0x2a0fb1=_0x443559,_0x37865b=this[_0x2a0fb1(0x81)]['length'],_0x26387e=new Array(_0x37865b);for(let _0x2558f6=this[_0x2a0fb1(0x96)];_0x2558f6<_0x37865b;++_0x2558f6){_0x26387e[_0x2558f6]=this['getTileRangeForExtentAndZ'](_0x2a3379,_0x2558f6);}this[_0x2a0fb1(0x8f)]=_0x26387e;}}export default TileGrid;