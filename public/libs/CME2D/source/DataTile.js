const _0x15bc39=_0x4f1a;function _0x19d3(){const _0x4d4ca8=['state','TILELOADSTART','5vOfrOb','setTileSizes','getTile','setTileGridForProjection','tileSizes_','wrapX','tileCache','tileLoadingKeys_','gutter','projection','interpolate','LOADING','TILELOADERROR','23836CpaqXq','tileSize_','LOADED','tileGridForProjection_','tileGrid','getTileSize','max','get','bind','CHANGE','1503887iOtmAj','setLoader','map','anonymous','tileOptions','containsKey','1865961qscEGL','maxResolution','expireCache','crossOrigin','getTileGridForProjection','getProjection','TILELOADEND','getReprojTile_','attributionsCollapsible','tileCacheForProjection_','34256FPcwIk','tileSize','crossOrigin_','20moqwjI','getTileCacheForProjection','bandCount','maxZoom','30wNLXaV','ERROR','7WJGmtH','clear','getState','1313150FvWDOG','minZoom','329793zZSttq','2765034FhVlnP','assign','EPSG:3857','getTileGrid','getKey','dispatchEvent','key','addEventListener','handleTileChange_','getGutterForProjection','getTileCoordForTileUrlFunction','36iKxnCd','loader_'];_0x19d3=function(){return _0x4d4ca8;};return _0x19d3();}function _0x4f1a(_0x2a3143,_0x7c3de7){const _0x19d377=_0x19d3();return _0x4f1a=function(_0x4f1a54,_0x2a8e9f){_0x4f1a54=_0x4f1a54-0x107;let _0x10acd8=_0x19d377[_0x4f1a54];return _0x10acd8;},_0x4f1a(_0x2a3143,_0x7c3de7);}(function(_0x7e54c7,_0x5a0d24){const _0x170dff=_0x4f1a,_0x5d6251=_0x7e54c7();while(!![]){try{const _0x4674ee=parseInt(_0x170dff(0x121))/0x1*(parseInt(_0x170dff(0x142))/0x2)+parseInt(_0x170dff(0x149))/0x3*(parseInt(_0x170dff(0x13e))/0x4)+parseInt(_0x170dff(0x114))/0x5*(-parseInt(_0x170dff(0x14a))/0x6)+-parseInt(_0x170dff(0x144))/0x7*(parseInt(_0x170dff(0x13b))/0x8)+parseInt(_0x170dff(0x131))/0x9+parseInt(_0x170dff(0x147))/0xa+parseInt(_0x170dff(0x12b))/0xb*(-parseInt(_0x170dff(0x110))/0xc);if(_0x4674ee===_0x5a0d24)break;else _0x5d6251['push'](_0x5d6251['shift']());}catch(_0x542c16){_0x5d6251['push'](_0x5d6251['shift']());}}}(_0x19d3,0x5a787));import _0x1a6a90 from'../DataTile.js';import _0x1c88a4 from'../events/EventType.js';import _0x38c212 from'../reproj/DataTile.js';import _0x2e47e2 from'../TileCache.js';import _0x24b467 from'./TileEventType.js';import _0x5b1423,{TileSourceEvent}from'./Tile.js';import _0x5d84c0 from'../TileState.js';import{createXYZ,extentFromProjection,getForProjection as _0x26829d}from'../tilegrid.js';import{equivalent,get as _0x1b5378}from'../proj.js';import{getKeyZXY}from'../tilecoord.js';import{getUid}from'../util.js';import{toPromise}from'../functions.js';import{toSize}from'../size.js';class DataTileSource extends _0x5b1423{constructor(_0x1e5aa8){const _0x572e26=_0x4f1a,_0x58541f=_0x1e5aa8[_0x572e26(0x11d)]===undefined?_0x572e26(0x107):_0x1e5aa8['projection'];let _0x115211=_0x1e5aa8['tileGrid'];_0x115211===undefined&&_0x58541f&&(_0x115211=createXYZ({'extent':extentFromProjection(_0x58541f),'maxResolution':_0x1e5aa8[_0x572e26(0x132)],'maxZoom':_0x1e5aa8[_0x572e26(0x141)],'minZoom':_0x1e5aa8[_0x572e26(0x148)],'tileSize':_0x1e5aa8[_0x572e26(0x13c)]})),super({'cacheSize':0.1,'attributions':_0x1e5aa8['attributions'],'attributionsCollapsible':_0x1e5aa8[_0x572e26(0x139)],'projection':_0x58541f,'tileGrid':_0x115211,'state':_0x1e5aa8[_0x572e26(0x112)],'wrapX':_0x1e5aa8[_0x572e26(0x119)],'transition':_0x1e5aa8['transition'],'interpolate':_0x1e5aa8[_0x572e26(0x11e)],'key':_0x1e5aa8[_0x572e26(0x10b)]}),this['gutter_']=_0x1e5aa8[_0x572e26(0x11c)]!==undefined?_0x1e5aa8[_0x572e26(0x11c)]:0x0,this[_0x572e26(0x122)]=_0x1e5aa8['tileSize']?toSize(_0x1e5aa8['tileSize']):null,this[_0x572e26(0x118)]=null,this[_0x572e26(0x11b)]={},this[_0x572e26(0x111)]=_0x1e5aa8['loader'],this['handleTileChange_']=this['handleTileChange_'][_0x572e26(0x129)](this),this[_0x572e26(0x140)]=_0x1e5aa8['bandCount']===undefined?0x4:_0x1e5aa8[_0x572e26(0x140)],this['tileGridForProjection_']={},this[_0x572e26(0x13a)]={},this[_0x572e26(0x13d)]=_0x1e5aa8[_0x572e26(0x134)]||_0x572e26(0x12e);}[_0x15bc39(0x115)](_0x3db0d3){this['tileSizes_']=_0x3db0d3;}['getTileSize'](_0x43130b){const _0xd47cfa=_0x15bc39;if(this['tileSizes_'])return this[_0xd47cfa(0x118)][_0x43130b];if(this['tileSize_'])return this['tileSize_'];const _0x3801c0=this['getTileGrid']();return _0x3801c0?toSize(_0x3801c0[_0xd47cfa(0x126)](_0x43130b)):[0x100,0x100];}[_0x15bc39(0x10e)](_0x499054){const _0x1c1fca=_0x15bc39,_0x4cb4db=this[_0x1c1fca(0x136)]();if(!_0x4cb4db||equivalent(_0x4cb4db,_0x499054))return this['gutter_'];return 0x0;}[_0x15bc39(0x12c)](_0x275bba){const _0x1d71f0=_0x15bc39;this[_0x1d71f0(0x111)]=_0x275bba;}[_0x15bc39(0x138)](_0x4a89f5,_0x1e97bb,_0x32bf9e,_0x197502,_0x1c8fb9){const _0xcff1ea=_0x15bc39,_0x4d002a=this[_0xcff1ea(0x13f)](_0x197502),_0x2ac990=getKeyZXY(_0x4a89f5,_0x1e97bb,_0x32bf9e);if(_0x4d002a[_0xcff1ea(0x130)](_0x2ac990)){const _0x5ca056=_0x4d002a['get'](_0x2ac990);if(_0x5ca056&&_0x5ca056['key']==this[_0xcff1ea(0x109)]())return _0x5ca056;}const _0x4dcff6=this[_0xcff1ea(0x108)](),_0x12ed41=Math[_0xcff1ea(0x127)]['apply'](null,_0x4dcff6['getResolutions']()[_0xcff1ea(0x12d)]((_0x21acb4,_0x3e1600)=>{const _0x1a4cea=_0xcff1ea,_0x3d53e9=toSize(_0x4dcff6['getTileSize'](_0x3e1600)),_0x3b7112=this[_0x1a4cea(0x126)](_0x3e1600);return Math[_0x1a4cea(0x127)](_0x3b7112[0x0]/_0x3d53e9[0x0],_0x3b7112[0x1]/_0x3d53e9[0x1]);})),_0x12c99c=this[_0xcff1ea(0x135)](_0x1c8fb9),_0x171fd9=this['getTileGridForProjection'](_0x197502),_0x192e87=[_0x4a89f5,_0x1e97bb,_0x32bf9e],_0x3b72d1=this[_0xcff1ea(0x10f)](_0x192e87,_0x197502),_0x4eed19=Object[_0xcff1ea(0x14b)]({'sourceProj':_0x1c8fb9,'sourceTileGrid':_0x12c99c,'targetProj':_0x197502,'targetTileGrid':_0x171fd9,'tileCoord':_0x192e87,'wrappedTileCoord':_0x3b72d1,'pixelRatio':_0x12ed41,'gutter':this[_0xcff1ea(0x10e)](_0x1c8fb9),'getTileFunction':(_0x1550a5,_0x3938c3,_0x2b6f71,_0x5514ac)=>this[_0xcff1ea(0x116)](_0x1550a5,_0x3938c3,_0x2b6f71,_0x5514ac,_0x1c8fb9)},this[_0xcff1ea(0x12f)]),_0x3d16af=new _0x38c212(_0x4eed19);return _0x3d16af[_0xcff1ea(0x10b)]=this['getKey'](),_0x3d16af;}['getTile'](_0x3b7c8a,_0x15c8a6,_0x3b665c,_0x1553cb,_0x344eb3){const _0x28d587=_0x15bc39,_0x22cb77=this[_0x28d587(0x136)]();if(_0x22cb77&&_0x344eb3&&!equivalent(_0x22cb77,_0x344eb3))return this[_0x28d587(0x138)](_0x3b7c8a,_0x15c8a6,_0x3b665c,_0x344eb3,_0x22cb77);const _0x74fe0f=this[_0x28d587(0x126)](_0x3b7c8a),_0x1c2ec1=getKeyZXY(_0x3b7c8a,_0x15c8a6,_0x3b665c);if(this[_0x28d587(0x11a)][_0x28d587(0x130)](_0x1c2ec1))return this['tileCache'][_0x28d587(0x128)](_0x1c2ec1);const _0x12569c=this[_0x28d587(0x111)],_0x464ae2=new AbortController(),_0x21eec4={'signal':_0x464ae2['signal'],'crossOrigin':this[_0x28d587(0x13d)]},_0x57267c=this[_0x28d587(0x10f)]([_0x3b7c8a,_0x15c8a6,_0x3b665c]);if(!_0x57267c)return null;const _0x36741f=_0x57267c[0x0],_0x503a6a=_0x57267c[0x1],_0x4aded2=_0x57267c[0x2];function _0xe8bb37(){return toPromise(function(){return _0x12569c(_0x36741f,_0x503a6a,_0x4aded2,_0x21eec4);});}const _0x4521fe=Object[_0x28d587(0x14b)]({'tileCoord':[_0x3b7c8a,_0x15c8a6,_0x3b665c],'loader':_0xe8bb37,'size':_0x74fe0f,'controller':_0x464ae2},this[_0x28d587(0x12f)]),_0x5b4aa5=new _0x1a6a90(_0x4521fe);return _0x5b4aa5['key']=this[_0x28d587(0x109)](),_0x5b4aa5[_0x28d587(0x10c)](_0x1c88a4[_0x28d587(0x12a)],this[_0x28d587(0x10d)]),this[_0x28d587(0x11a)]['set'](_0x1c2ec1,_0x5b4aa5),_0x5b4aa5;}[_0x15bc39(0x10d)](_0x284d9d){const _0x1738b8=_0x15bc39,_0x39cce7=_0x284d9d['target'],_0xe19c57=getUid(_0x39cce7),_0x42fd31=_0x39cce7[_0x1738b8(0x146)]();let _0x5b6b33;if(_0x42fd31==_0x5d84c0[_0x1738b8(0x11f)])this[_0x1738b8(0x11b)][_0xe19c57]=!![],_0x5b6b33=_0x24b467[_0x1738b8(0x113)];else _0xe19c57 in this[_0x1738b8(0x11b)]&&(delete this[_0x1738b8(0x11b)][_0xe19c57],_0x5b6b33=_0x42fd31==_0x5d84c0[_0x1738b8(0x143)]?_0x24b467[_0x1738b8(0x120)]:_0x42fd31==_0x5d84c0[_0x1738b8(0x123)]?_0x24b467[_0x1738b8(0x137)]:undefined);_0x5b6b33&&this[_0x1738b8(0x10a)](new TileSourceEvent(_0x5b6b33,_0x39cce7));}[_0x15bc39(0x135)](_0xf7e303){const _0x55692=_0x15bc39,_0x1a5642=this['getProjection']();if(this[_0x55692(0x125)]&&(!_0x1a5642||equivalent(_0x1a5642,_0xf7e303)))return this[_0x55692(0x125)];const _0x565f46=getUid(_0xf7e303);return!(_0x565f46 in this[_0x55692(0x124)])&&(this[_0x55692(0x124)][_0x565f46]=_0x26829d(_0xf7e303)),this['tileGridForProjection_'][_0x565f46];}[_0x15bc39(0x117)](_0x57beea,_0x1d6e7a){const _0x57ed81=_0x15bc39,_0x3e5341=_0x1b5378(_0x57beea);if(_0x3e5341){const _0x131fed=getUid(_0x3e5341);!(_0x131fed in this[_0x57ed81(0x124)])&&(this['tileGridForProjection_'][_0x131fed]=_0x1d6e7a);}}['getTileCacheForProjection'](_0x36b24d){const _0x5e9ad7=_0x15bc39,_0x4f41eb=this[_0x5e9ad7(0x136)]();if(!_0x4f41eb||equivalent(_0x4f41eb,_0x36b24d))return this['tileCache'];const _0x308cd4=getUid(_0x36b24d);return!(_0x308cd4 in this[_0x5e9ad7(0x13a)])&&(this['tileCacheForProjection_'][_0x308cd4]=new _0x2e47e2(0.1)),this[_0x5e9ad7(0x13a)][_0x308cd4];}[_0x15bc39(0x133)](_0x2aa8ad,_0xd123e3){const _0x418ec7=_0x15bc39,_0x20f0ce=this[_0x418ec7(0x13f)](_0x2aa8ad);this[_0x418ec7(0x11a)][_0x418ec7(0x133)](this['tileCache']==_0x20f0ce?_0xd123e3:{});for(const _0x57b88d in this['tileCacheForProjection_']){const _0x6fdf47=this[_0x418ec7(0x13a)][_0x57b88d];_0x6fdf47[_0x418ec7(0x133)](_0x6fdf47==_0x20f0ce?_0xd123e3:{});}}[_0x15bc39(0x145)](){const _0x4fdebf=_0x15bc39;super[_0x4fdebf(0x145)]();for(const _0x42bde6 in this['tileCacheForProjection_']){this[_0x4fdebf(0x13a)][_0x42bde6][_0x4fdebf(0x145)]();}}}export default DataTileSource;