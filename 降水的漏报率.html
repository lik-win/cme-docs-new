<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title></title>
    <link rel="stylesheet" href="/demo.css" />
  </head>

  <body>
    <div id="Echart" style="width: 100%; height: 100%"></div>
    <script
      type="text/javascript"
      async=""
      src="https://fastly.jsdelivr.net/npm/echarts@5.5.1/dist/echarts.min.js"
      data-loaded="true"
    ></script>
    <script type="text/javascript">
      let chart = null
      const _request = (val) => {
        const params ={
            element: 'RAIN',
            childElement: 't_rain_12h_data',
            models: ['SCMOC', 'EC'],
            thresholds: ['0.1', '10', '25'],
            observationTime: '2024-12-03 08:00:00',
            scopeType: 'MISSRATE',
            stationType: '10290',
          };

      // const qs = Object.keys(params).map(n => `${n}=${params[n]}`).join('&');


      fetch(`/echartUrl/algorithm/scope`,{
        method: "POST",
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
        },
        body:JSON.stringify(params)}).then(res => res.json()).then(data => {
            console.log('fetch =>', data)
            initEchart(data.data)
          })


      //     fetch(`/echartUrl/algorithm/scope?${qs}`).then(res => res.json()).then(data => {
      //       console.log('fetch =>', data)
      //       initEchart(data.data)
      //     })

      }
      function initEchart({ data }) {
        let option = {
          legend: {},
          color: [
            '#fba400',
            '#335cce',
            '#1b9d3b',
            '#e25e30',
            '#b92727',
            '#359fdc',
            '#30c8c6',
            '#4b52ab',
            '#d13abd',
            '#7fa771',
            '#8993a5',
            '#c0826a',
            '#894cd4',
          ],
          tooltip: {
            trigger: 'axis',
            fontSize: 14,
          },
          xAxis: {
            type: 'category',
            data: data.xAxis,
            axisLabel: {
              margin: 10,
              textStyle: {
                fontSize: 14,
              },
            },
            axisLine: {
              lineStyle: {
                color: '#477AA5',
              },
            },
            axisTick: {
              show: false,
            },
            splitLine: {
              show: false,
            },
          },
          dataZoom: [ //给x轴设置滚动条
                {
                    start: 0, //默认为0
                    end: 100 - 1500 / 31, //默认为100
                    type: 'slider',
                    show: true,
                    xAxisIndex: [0],
                    handleSize: 10, //滑动条的 左右2个滑动条的大小
                    height: 13, //组件高度
                    left: 50, //左边的距离
                    right: 40, //右边的距离
                    bottom: 0, //右边的距离
                    handleColor: '#ddd', //h滑动图标的颜色
                    handleStyle: {
                        borderColor: "#cacaca",
                        borderWidth: "1",
                        shadowBlur: 2,
                        background: "#ddd",
                        shadowColor: "#ddd",
                    },
                    fillerColor: '#808080',
                    backgroundColor: '#ddd', //两边未选中的滑动条区域的颜色
                    showDataShadow: false, //是否显示数据阴影 默认auto
                    showDetail: false, //即拖拽时候是否显示详细数值信息 默认true
                    handleIcon: 'M-292,322.2c-3.2,0-6.4-0.6-9.3-1.9c-2.9-1.2-5.4-2.9-7.6-5.1s-3.9-4.8-5.1-7.6c-1.3-3-1.9-6.1-1.9-9.3c0-3.2,0.6-6.4,1.9-9.3c1.2-2.9,2.9-5.4,5.1-7.6s4.8-3.9,7.6-5.1c3-1.3,6.1-1.9,9.3-1.9c3.2,0,6.4,0.6,9.3,1.9c2.9,1.2,5.4,2.9,7.6,5.1s3.9,4.8,5.1,7.6c1.3,3,1.9,6.1,1.9,9.3c0,3.2-0.6,6.4-1.9,9.3c-1.2,2.9-2.9,5.4-5.1,7.6s-4.8,3.9-7.6,5.1C-285.6,321.5-288.8,322.2-292,322.2z',
                    filterMode: 'filter',
                },
                //下面这个属性是里面拖到
                {
                    type: 'inside',
                    show: true,
                    xAxisIndex: [0],
                    start: 0, //默认为1
                    end: 100 - 1500 / 31, //默认为100
                },
            ],
          yAxis: {
            type: 'value',
            splitNumber: 7,
            axisLine: { show: true },
            axisTick: { show: false },
            splitLine: {
              show: true,
              lineStyle: {
                type: 'dashed',
                color: '#000',
              },
            },
            axisLabel: {
              margin: 10,
              textStyle: {
                color: '#000',
              },
            },
          },
          series: [],
        }
       
        const dom = document.getElementById('Echart')
        chart = echarts.init(dom)
        let series = []
        data.series.map((item) => {
          series.push({
            type: 'bar',
            name: item.name,
            data: item.data,
            barGap: 0.1,
            label: {
              normal: {
                show: false,
                position: 'top',
                formatter: '{c}',
              },
            },
          })
        })
        option.series = series
        chart.setOption(option)
        chart.resize()
      }
      window.onload = function () {
        _request()
        window.addEventListener('resize', () => {
          chart.resize()
        })
      }
    </script>
  </body>
</html>
